{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "UI Definition Schema",
  "type": "object",
  "additionalProperties": false,
  "properties": {
    "deviceId": {
      "type": "string",
      "description": "Identifier of the target device that should render this UI definition."
    },
    "generatedAt": {
      "type": "string",
      "format": "date-time",
      "description": "Timestamp indicating when the UI was generated."
    },
    "context": {
      "type": "object",
      "description": "Arbitrary context metadata (thing references, device info, etc.).",
      "additionalProperties": true
    },
    "theme": {
      "type": "object",
      "properties": {
        "primaryColor": {
          "type": "string",
          "pattern": "^#([0-9a-fA-F]{3}|[0-9a-fA-F]{6})$",
          "description": "Hexadecimal color value representing the preferred primary accent color."
        }
      },
      "additionalProperties": false
    },
    "components": {
      "type": "array",
      "minItems": 1,
      "items": { "$ref": "#/definitions/component" }
    }
  },
  "required": ["components"],
  "definitions": {
    "component": {
      "oneOf": [
        { "$ref": "#/definitions/containerComponent" },
        { "$ref": "#/definitions/textComponent" },
        { "$ref": "#/definitions/buttonComponent" },
        { "$ref": "#/definitions/toggleComponent" },
        { "$ref": "#/definitions/inputComponent" },
        { "$ref": "#/definitions/transcriptComponent" },
        { "$ref": "#/definitions/promptsComponent" },
        { "$ref": "#/definitions/speakComponent" },
        { "$ref": "#/definitions/toolCall" }
      ]
    },
    "containerComponent": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "type": { "const": "container" },
        "title": { "type": "string" },
        "layout": { "type": "string" },
        "children": {
          "type": "array",
          "minItems": 1,
          "items": { "$ref": "#/definitions/component" }
        }
      },
      "required": ["type", "children"]
    },
    "textComponent": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "type": { "const": "text" },
        "text": { "type": "string" },
        "variant": { "type": "string" },
        "tone": { "type": "string" }
      },
      "required": ["type", "text"]
    },
    "buttonComponent": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "type": { "const": "button" },
        "label": { "type": "string" },
        "icon": { "type": "string" },
        "style": { "type": "string" },
        "action": {
          "description": "Action payload or identifier to execute when the button is pressed.",
          "oneOf": [
            { "type": "string" },
            { "type": "object", "additionalProperties": true }
          ]
        }
      },
      "required": ["type", "label"]
    },
    "toggleComponent": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "type": { "const": "toggle" },
        "label": { "type": "string" },
        "checked": { "type": "boolean" },
        "action": {
          "oneOf": [
            { "type": "string" },
            { "type": "object", "additionalProperties": true }
          ]
        }
      },
      "required": ["type", "label"]
    },
    "inputComponent": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "type": { "const": "input" },
        "label": { "type": "string" },
        "placeholder": { "type": "string" },
        "value": { "type": "string" },
        "inputType": { "type": "string" }
      },
      "required": ["type"]
    },
    "transcriptComponent": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "type": { "const": "transcript" },
        "placeholder": { "type": "string" },
        "value": { "type": "string" }
      },
      "required": ["type", "placeholder"]
    },
    "promptsComponent": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "type": { "const": "prompts" },
        "suggestions": {
          "type": "array",
          "minItems": 1,
          "items": { "type": "string", "minLength": 1 }
        }
      },
      "required": ["type", "suggestions"]
    },
    "speakComponent": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "type": { "const": "speak" },
        "text": { "type": "string" },
        "voice": { "type": "string" }
      },
      "required": ["type", "text"]
    },
    "toolCall": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "type": { "const": "toolCall" },
        "tool": { "type": "string" },
        "parameters": { "type": "object", "additionalProperties": true }
      },
      "required": ["type", "tool"]
    }
  }
}