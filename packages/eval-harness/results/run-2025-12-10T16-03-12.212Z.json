{
  "generatedAt": "2025-12-10T16:03:12.210Z",
  "suite": "kb-alignment",
  "version": "2025-12-09",
  "config": {
    "model": "openai/gpt-5.1",
    "endpoint": "https://openrouter.ai/api/v1/chat/completions",
    "provider": "openrouter",
    "suitePath": "/Users/dom/projects/IMP/packages/knowledge-base/eval-suite.json",
    "kbDataPath": "/Users/dom/projects/IMP/packages/knowledge-base/kb-data.json",
    "kbUrl": "http://localhost:3005",
    "schemaPath": "/Users/dom/projects/IMP/packages/tablet-device/schema.json",
    "dryRun": false,
    "mode": "kb",
    "resolvedLlmConfig": {
      "provider": "openrouter",
      "model": "openai/gpt-5.1",
      "endpoint": "https://openrouter.ai/api/v1/chat/completions",
      "fallbackModel": "gemma 3b",
      "openRouterModel": "openai/gpt-5.1",
      "allowsFallback": true,
      "timestamp": "2025-12-10T16:00:22.746Z"
    }
  },
  "results": [
    {
      "scenarioId": "hands-occupied-audio-guidance",
      "name": "Hands-occupied lighting change",
      "mode": "kb",
      "prompt": "You are a UI planning assistant for a tablet experience. Use the provided requirement documents to craft a response that explains what the tablet should render or say. Always cite the relevant document ids in parentheses when referencing a guideline.\n\nDocument modality-guideline-hands-occupied (source: safety-guidelines):\nWhen the user activity sensor reports the state \"hands-occupied\", prefer audio-first guidance. Provide spoken prompts and minimize the need for direct touch input. When the sensor reports \"hands-free\", present tactile controls such as buttons or toggles for the light switch.\n\nScenario prompt: Activity recognizer reports the state \"hands-occupied\" while the resident asks the tablet to dim the hallway sconces. Describe the UI response the device should render.\n\nContext inputs:\n{\n  \"sensorState\": \"hands-occupied\",\n  \"requestedAction\": \"dim hallway sconces\",\n  \"device\": \"tablet\"\n}\n\nRequired behaviors:\n- Prioritize spoken/audio-first prompts so the user does not need to touch the display\n- Explain the modality choice by referencing the hands-occupied state\n- Offer only minimal-touch fallbacks (single button or confirmation chip) if a tactile control is unavoidable\n\nAvoid the following failure modes:\n- Displays a new grid of touch buttons as the primary interaction\n- Omits any mention of audio guidance when the user cannot use their hands\n\nRespond with two sections: (1) \"Plan\" — short paragraphs describing the approach, (2) \"Checks\" — bullet list referencing document ids.",
      "answer": "{\n  \"theme\": {\n    \"primaryColor\": \"#1E90FF\"\n  },\n  \"context\": {\n    \"defaultErgonomicsProfile\": \"standard\"\n  },\n  \"root\": {\n    \"type\": \"container\",\n    \"props\": {\n      \"layout\": \"vertical\",\n      \"placement\": \"full-screen\",\n      \"children\": [\n        {\n          \"type\": \"text\",\n          \"props\": {\n            \"text\": \"Hallway sconces\",\n            \"variant\": \"title\",\n            \"size\": \"large\",\n            \"layout\": \"top-margin-md\"\n          }\n        },\n        {\n          \"type\": \"text\",\n          \"props\": {\n            \"text\": \"Hands are detected as occupied. The tablet switches to audio-first guidance so you don’t need to touch the screen.\",\n            \"variant\": \"body\",\n            \"size\": \"medium\",\n            \"layout\": \"below-title-margin-sm\"\n          }\n        },\n        {\n          \"type\": \"statusCard\",\n          \"props\": {\n            \"title\": \"Current response\",\n            \"value\": \"Voice guidance only\",\n            \"icon\": \"speaker\",\n            \"tone\": \"info\",\n            \"items\": [\n              \"A spoken message is played to acknowledge: “I heard ‘dim the hallway sconces.’”\",\n              \"The tablet explains by voice that it cannot directly control the hallway sconces yet because no smart control is available.\",\n              \"Spoken suggestions are given, for example: “You can use the wall dimmer now. When smart control is set up, you’ll be able to say things like ‘Make the hallway sconces dimmer’ or ‘Turn hallway sconces off.’”\",\n              \"No touch controls (sliders, buttons, or toggles) are shown, minimizing the need for interaction while your hands are occupied.\"\n            ],\n            \"layout\": \"below-body-margin-md\"\n          }\n        },\n        {\n          \"type\": \"text\",\n          \"props\": {\n            \"text\": \"Audio is the primary interaction here; the screen stays informational only until lighting controls are connected.\",\n            \"variant\": \"caption\",\n            \"size\": \"small\",\n            \"layout\": \"bottom-margin-lg\"\n          }\n        }\n      ]\n    }\n  }\n}",
      "durationMs": 26916.371416,
      "flaggedSignals": [],
      "rawResponse": {
        "theme": {
          "primaryColor": "#1E90FF"
        },
        "context": {
          "defaultErgonomicsProfile": "standard"
        },
        "root": {
          "type": "container",
          "props": {
            "layout": "vertical",
            "placement": "full-screen",
            "children": [
              {
                "type": "text",
                "props": {
                  "text": "Hallway sconces",
                  "variant": "title",
                  "size": "large",
                  "layout": "top-margin-md"
                }
              },
              {
                "type": "text",
                "props": {
                  "text": "Hands are detected as occupied. The tablet switches to audio-first guidance so you don’t need to touch the screen.",
                  "variant": "body",
                  "size": "medium",
                  "layout": "below-title-margin-sm"
                }
              },
              {
                "type": "statusCard",
                "props": {
                  "title": "Current response",
                  "value": "Voice guidance only",
                  "icon": "speaker",
                  "tone": "info",
                  "items": [
                    "A spoken message is played to acknowledge: “I heard ‘dim the hallway sconces.’”",
                    "The tablet explains by voice that it cannot directly control the hallway sconces yet because no smart control is available.",
                    "Spoken suggestions are given, for example: “You can use the wall dimmer now. When smart control is set up, you’ll be able to say things like ‘Make the hallway sconces dimmer’ or ‘Turn hallway sconces off.’”",
                    "No touch controls (sliders, buttons, or toggles) are shown, minimizing the need for interaction while your hands are occupied."
                  ],
                  "layout": "below-body-margin-md"
                }
              },
              {
                "type": "text",
                "props": {
                  "text": "Audio is the primary interaction here; the screen stays informational only until lighting controls are connected.",
                  "variant": "caption",
                  "size": "small",
                  "layout": "bottom-margin-lg"
                }
              }
            ]
          }
        }
      },
      "llmMeta": {
        "provider": "openrouter",
        "model": "openai/gpt-5.1",
        "durationMs": 26862,
        "usage": {
          "prompt_tokens": 803,
          "completion_tokens": 1873,
          "total_tokens": 2676,
          "cost": 0.01973375,
          "is_byok": false,
          "prompt_tokens_details": {
            "cached_tokens": 0,
            "audio_tokens": 0,
            "video_tokens": 0
          },
          "cost_details": {
            "upstream_inference_cost": null,
            "upstream_inference_prompt_cost": 0.00100375,
            "upstream_inference_completions_cost": 0.01873
          },
          "completion_tokens_details": {
            "reasoning_tokens": 1403,
            "image_tokens": 0
          }
        },
        "timestamp": "2025-12-10T16:00:49.665Z"
      },
      "kbPayload": {
        "prompt": "Activity recognizer reports the state \"hands-occupied\" while the resident asks the tablet to dim the hallway sconces. Describe the UI response the device should render.",
        "schema": {
          "name": "tablet-dashboard-ui",
          "description": "Schema for the large-format tablet/laptop renderer. Supports explicit layout hints so the KB can describe a multi-column dashboard.",
          "components": {
            "text": {
              "props": {
                "text": "string",
                "variant": "string",
                "size": "string",
                "layout": "layoutInstruction"
              }
            },
            "button": {
              "props": {
                "label": "string",
                "style": "string",
                "size": "string",
                "layout": "layoutInstruction",
                "action": "object"
              }
            },
            "toggle": {
              "props": {
                "label": "string",
                "checked": "boolean",
                "size": "string",
                "layout": "layoutInstruction",
                "action": "object"
              }
            },
            "slider": {
              "props": {
                "label": "string",
                "min": "number",
                "max": "number",
                "step": "number",
                "value": "number",
                "unit": "string",
                "size": "string",
                "layout": "layoutInstruction",
                "action": "object"
              }
            },
            "dropdown": {
              "props": {
                "label": "string",
                "placeholder": "string",
                "options": "array",
                "value": "string",
                "size": "string",
                "layout": "layoutInstruction",
                "action": "object"
              }
            },
            "statusCard": {
              "props": {
                "title": "string",
                "value": "string",
                "icon": "string",
                "tone": "string",
                "items": "array",
                "layout": "layoutInstruction"
              }
            },
            "container": {
              "props": {
                "children": "array",
                "layout": "string",
                "placement": "layoutInstruction"
              }
            }
          },
          "theming": {
            "description": "Supports `theme.primaryColor` and `theme.surfaceTint` for accent styling across cards and controls.",
            "supportsPrimaryColor": true,
            "defaultPrimaryColor": "#2563eb"
          },
          "context": {
            "modalityPreference": "visual-large-format",
            "defaultErgonomicsProfile": "cozy-desktop",
            "supportedErgonomicsProfiles": [
              {
                "id": "cozy-desktop",
                "label": "Cozy desktop",
                "description": "Comfortable spacing for seated interaction on tablets or laptops."
              },
              {
                "id": "information-dense",
                "label": "Information dense",
                "description": "Tighter spacing for dashboards that prioritize data density."
              }
            ]
          },
          "responseSchema": {
            "$schema": "http://json-schema.org/draft-07/schema#",
            "title": "Tablet/Laptop UI Schema",
            "type": "object",
            "additionalProperties": false,
            "properties": {
              "deviceId": {
                "type": "string",
                "description": "Identifier of the target tablet device that should render this UI definition."
              },
              "generatedAt": {
                "type": "string",
                "format": "date-time",
                "description": "Timestamp indicating when the UI was generated."
              },
              "context": {
                "type": "object",
                "description": "Arbitrary context metadata (thing references, device info, etc.).",
                "additionalProperties": true
              },
              "theme": {
                "type": "object",
                "properties": {
                  "primaryColor": {
                    "type": "string",
                    "pattern": "^#([0-9a-fA-F]{3}|[0-9a-fA-F]{6})$",
                    "description": "Hexadecimal color value representing the preferred primary accent color."
                  },
                  "surfaceTint": {
                    "type": "string",
                    "pattern": "^#([0-9a-fA-F]{3}|[0-9a-fA-F]{6})$",
                    "description": "Optional translucent wash to apply to containers."
                  }
                },
                "additionalProperties": false
              },
              "components": {
                "type": "array",
                "minItems": 1,
                "items": {
                  "$ref": "#/definitions/component"
                }
              }
            },
            "required": [
              "components"
            ],
            "definitions": {
              "layoutInstruction": {
                "type": "object",
                "description": "Optional placement hint for the 12-column responsive grid rendered by the tablet device.",
                "additionalProperties": false,
                "properties": {
                  "region": {
                    "type": "string",
                    "description": "Named region hint such as 'hero', 'sidebar', 'controls', or 'telemetry'."
                  },
                  "column": {
                    "type": "integer",
                    "minimum": 1,
                    "maximum": 12
                  },
                  "col": {
                    "type": "integer",
                    "minimum": 1,
                    "maximum": 12
                  },
                  "colSpan": {
                    "type": "integer",
                    "minimum": 1,
                    "maximum": 12
                  },
                  "span": {
                    "type": "integer",
                    "minimum": 1,
                    "maximum": 12
                  },
                  "row": {
                    "type": "integer",
                    "minimum": 1
                  },
                  "rowSpan": {
                    "type": "integer",
                    "minimum": 1
                  },
                  "x": {
                    "type": "integer",
                    "minimum": 1,
                    "maximum": 12,
                    "description": "Alias for `column`."
                  },
                  "y": {
                    "type": "integer",
                    "minimum": 1,
                    "description": "Alias for `row`."
                  },
                  "width": {
                    "type": "integer",
                    "minimum": 1,
                    "maximum": 12,
                    "description": "Alias for `colSpan`."
                  },
                  "height": {
                    "type": "integer",
                    "minimum": 1,
                    "description": "Alias for `rowSpan`."
                  },
                  "order": {
                    "type": "integer",
                    "description": "Optional ordering hint when auto-flow is used."
                  },
                  "align": {
                    "type": "string",
                    "enum": [
                      "start",
                      "center",
                      "end",
                      "stretch"
                    ],
                    "description": "Justify-self alignment inside the grid cell."
                  },
                  "justify": {
                    "type": "string",
                    "enum": [
                      "start",
                      "center",
                      "end",
                      "stretch"
                    ],
                    "description": "Align-self hint inside the grid cell."
                  },
                  "minHeight": {
                    "type": "string",
                    "description": "CSS size for minimum height (e.g., '180px')."
                  },
                  "maxHeight": {
                    "type": "string",
                    "description": "CSS size for maximum height."
                  },
                  "layer": {
                    "type": "string",
                    "enum": [
                      "base",
                      "overlay"
                    ],
                    "description": "Whether the element should float as an overlay card."
                  }
                }
              },
              "component": {
                "oneOf": [
                  {
                    "$ref": "#/definitions/containerComponent"
                  },
                  {
                    "$ref": "#/definitions/textComponent"
                  },
                  {
                    "$ref": "#/definitions/buttonComponent"
                  },
                  {
                    "$ref": "#/definitions/toggleComponent"
                  },
                  {
                    "$ref": "#/definitions/sliderComponent"
                  },
                  {
                    "$ref": "#/definitions/dropdownComponent"
                  },
                  {
                    "$ref": "#/definitions/statusCardComponent"
                  },
                  {
                    "$ref": "#/definitions/toolCall"
                  }
                ]
              },
              "containerComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "container"
                  },
                  "title": {
                    "type": "string"
                  },
                  "layout": {
                    "description": "Layout strategy for child composition (grid, row, column).",
                    "oneOf": [
                      {
                        "type": "string"
                      },
                      {
                        "$ref": "#/definitions/layoutInstruction"
                      }
                    ]
                  },
                  "placement": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Optional thing identifier that all nested children primarily control."
                  },
                  "children": {
                    "type": "array",
                    "minItems": 1,
                    "items": {
                      "$ref": "#/definitions/component"
                    }
                  }
                },
                "required": [
                  "type",
                  "children"
                ]
              },
              "textComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "text"
                  },
                  "text": {
                    "type": "string"
                  },
                  "variant": {
                    "type": "string"
                  },
                  "size": {
                    "type": "string"
                  },
                  "tone": {
                    "type": "string"
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Optional thing identifier this text references when showing state or instructions."
                  }
                },
                "required": [
                  "type",
                  "text"
                ]
              },
              "buttonComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "button"
                  },
                  "label": {
                    "type": "string"
                  },
                  "icon": {
                    "type": "string"
                  },
                  "style": {
                    "type": "string"
                  },
                  "size": {
                    "type": "string"
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Thing identifier to target when executing the bound action."
                  },
                  "action": {
                    "description": "Action payload or identifier to execute when the button is pressed.",
                    "oneOf": [
                      {
                        "type": "string"
                      },
                      {
                        "type": "object",
                        "additionalProperties": true
                      }
                    ]
                  }
                },
                "required": [
                  "type",
                  "label"
                ]
              },
              "toggleComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "toggle"
                  },
                  "label": {
                    "type": "string"
                  },
                  "checked": {
                    "type": "boolean"
                  },
                  "size": {
                    "type": "string"
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Thing identifier to target when toggling."
                  },
                  "action": {
                    "oneOf": [
                      {
                        "type": "string"
                      },
                      {
                        "type": "object",
                        "additionalProperties": true
                      }
                    ]
                  }
                },
                "required": [
                  "type",
                  "label"
                ]
              },
              "sliderComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "slider"
                  },
                  "label": {
                    "type": "string"
                  },
                  "min": {
                    "type": "number",
                    "default": 0
                  },
                  "max": {
                    "type": "number",
                    "default": 100
                  },
                  "step": {
                    "type": "number",
                    "default": 1
                  },
                  "value": {
                    "type": "number"
                  },
                  "unit": {
                    "type": "string"
                  },
                  "size": {
                    "type": "string"
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Thing identifier to target when sending slider updates."
                  },
                  "action": {
                    "oneOf": [
                      {
                        "type": "string"
                      },
                      {
                        "type": "object",
                        "additionalProperties": true
                      }
                    ]
                  }
                },
                "required": [
                  "type",
                  "label"
                ]
              },
              "dropdownComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "dropdown"
                  },
                  "label": {
                    "type": "string"
                  },
                  "placeholder": {
                    "type": "string"
                  },
                  "value": {
                    "type": "string"
                  },
                  "size": {
                    "type": "string"
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Thing identifier to target when selection changes."
                  },
                  "options": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "label": {
                          "type": "string"
                        },
                        "value": {
                          "type": "string"
                        }
                      },
                      "required": [
                        "label",
                        "value"
                      ],
                      "additionalProperties": false
                    }
                  },
                  "action": {
                    "oneOf": [
                      {
                        "type": "string"
                      },
                      {
                        "type": "object",
                        "additionalProperties": true
                      }
                    ]
                  }
                },
                "required": [
                  "type",
                  "label",
                  "options"
                ]
              },
              "statusCardComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "statusCard"
                  },
                  "title": {
                    "type": "string"
                  },
                  "value": {
                    "type": "string"
                  },
                  "icon": {
                    "type": "string"
                  },
                  "tone": {
                    "type": "string"
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Thing identifier whose state this card summarizes."
                  },
                  "items": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "label": {
                          "type": "string"
                        },
                        "value": {
                          "type": "string"
                        }
                      },
                      "required": [
                        "label",
                        "value"
                      ],
                      "additionalProperties": false
                    }
                  }
                },
                "required": [
                  "type",
                  "title"
                ]
              },
              "toolCall": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "toolCall"
                  },
                  "tool": {
                    "type": "string"
                  },
                  "parameters": {
                    "type": "object",
                    "additionalProperties": true
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Thing identifier providing context for the tool output."
                  }
                },
                "required": [
                  "type",
                  "tool"
                ]
              }
            }
          }
        },
        "capabilityData": {
          "sensorState": "hands-occupied",
          "requestedAction": "dim hallway sconces",
          "device": "tablet"
        },
        "uiContext": {
          "scenarioId": "hands-occupied-audio-guidance",
          "tags": [
            "modality",
            "hands-occupied",
            "audio-first"
          ],
          "inputs": {
            "sensorState": "hands-occupied",
            "requestedAction": "dim hallway sconces",
            "device": "tablet"
          }
        },
        "deviceId": "device-tablet-eval",
        "device": {
          "id": "device-tablet-eval",
          "deviceId": "device-tablet-eval",
          "label": "Evaluation Tablet",
          "type": "tablet",
          "ergonomicsProfile": "cozy-desktop"
        }
      }
    },
    {
      "scenarioId": "hands-free-tactile-controls",
      "name": "Hands-free lighting surface",
      "mode": "kb",
      "prompt": "You are a UI planning assistant for a tablet experience. Use the provided requirement documents to craft a response that explains what the tablet should render or say. Always cite the relevant document ids in parentheses when referencing a guideline.\n\nDocument modality-guideline-hands-occupied (source: safety-guidelines):\nWhen the user activity sensor reports the state \"hands-occupied\", prefer audio-first guidance. Provide spoken prompts and minimize the need for direct touch input. When the sensor reports \"hands-free\", present tactile controls such as buttons or toggles for the light switch.\n\nScenario prompt: Sensors switch to \"hands-free\" as the resident requests lighting controls for the living room. What UI sections should the tablet render?\n\nContext inputs:\n{\n  \"sensorState\": \"hands-free\",\n  \"requestedAction\": \"toggle living-room lighting\",\n  \"device\": \"tablet\"\n}\n\nRequired behaviors:\n- Surface tactile controls such as buttons or toggles for the light switch\n- Call out that the hands-free context enables direct manipulation\n- Keep controls grouped in a reachable band (e.g., hero/controls region)\n\nAvoid the following failure modes:\n- Falls back to audio guidance or hides buttons despite hands-free state\n- Does not mention any tactile control\n\nRespond with two sections: (1) \"Plan\" — short paragraphs describing the approach, (2) \"Checks\" — bullet list referencing document ids.",
      "answer": "{\n  \"theme\": {\n    \"primaryColor\": \"#1E90FF\"\n  },\n  \"context\": {\n    \"deviceId\": \"device-tablet-eval\",\n    \"defaultErgonomicsProfile\": \"standard\"\n  },\n  \"ui\": {\n    \"type\": \"container\",\n    \"props\": {\n      \"layout\": \"column\",\n      \"placement\": \"full-screen\",\n      \"children\": [\n        {\n          \"type\": \"text\",\n          \"props\": {\n            \"text\": \"Living Room Lighting\",\n            \"variant\": \"title\",\n            \"size\": \"large\",\n            \"layout\": \"top\"\n          }\n        },\n        {\n          \"type\": \"statusCard\",\n          \"props\": {\n            \"title\": \"Living Room Lights\",\n            \"value\": \"Controls unavailable\",\n            \"icon\": \"lightbulb-off\",\n            \"tone\": \"warning\",\n            \"items\": [\n              {\n                \"label\": \"Requested action\",\n                \"value\": \"Toggle living-room lighting\"\n              },\n              {\n                \"label\": \"Interaction mode\",\n                \"value\": \"Hands-free (tactile controls allowed)\"\n              },\n              {\n                \"label\": \"Connected lights\",\n                \"value\": \"None detected\"\n              }\n            ],\n            \"layout\": \"full-width\"\n          }\n        },\n        {\n          \"type\": \"text\",\n          \"props\": {\n            \"text\": \"This tablet is ready to show on/off and brightness controls for the living room, but no compatible lighting devices are currently connected. Once a living-room light is added, a control panel with buttons and toggles will appear here.\",\n            \"variant\": \"body\",\n            \"size\": \"medium\",\n            \"layout\": \"below\"\n          }\n        },\n        {\n          \"type\": \"container\",\n          \"props\": {\n            \"layout\": \"column\",\n            \"placement\": \"section\",\n            \"children\": [\n              {\n                \"type\": \"text\",\n                \"props\": {\n                  \"text\": \"Expected Controls (Preview)\",\n                  \"variant\": \"subtitle\",\n                  \"size\": \"medium\",\n                  \"layout\": \"section-header\"\n                }\n              },\n              {\n                \"type\": \"text\",\n                \"props\": {\n                  \"text\": \"• Main light switch (toggle)\\n• Brightness adjustment (slider)\\n• Scene or mood presets (buttons)\\nThese controls will become active when a living-room light is linked to the system.\",\n                  \"variant\": \"body\",\n                  \"size\": \"small\",\n                  \"layout\": \"section-body\"\n                }\n              }\n            ]\n          }\n        }\n      ]\n    }\n  }\n}",
      "durationMs": 29948.535458,
      "flaggedSignals": [],
      "rawResponse": {
        "theme": {
          "primaryColor": "#1E90FF"
        },
        "context": {
          "deviceId": "device-tablet-eval",
          "defaultErgonomicsProfile": "standard"
        },
        "ui": {
          "type": "container",
          "props": {
            "layout": "column",
            "placement": "full-screen",
            "children": [
              {
                "type": "text",
                "props": {
                  "text": "Living Room Lighting",
                  "variant": "title",
                  "size": "large",
                  "layout": "top"
                }
              },
              {
                "type": "statusCard",
                "props": {
                  "title": "Living Room Lights",
                  "value": "Controls unavailable",
                  "icon": "lightbulb-off",
                  "tone": "warning",
                  "items": [
                    {
                      "label": "Requested action",
                      "value": "Toggle living-room lighting"
                    },
                    {
                      "label": "Interaction mode",
                      "value": "Hands-free (tactile controls allowed)"
                    },
                    {
                      "label": "Connected lights",
                      "value": "None detected"
                    }
                  ],
                  "layout": "full-width"
                }
              },
              {
                "type": "text",
                "props": {
                  "text": "This tablet is ready to show on/off and brightness controls for the living room, but no compatible lighting devices are currently connected. Once a living-room light is added, a control panel with buttons and toggles will appear here.",
                  "variant": "body",
                  "size": "medium",
                  "layout": "below"
                }
              },
              {
                "type": "container",
                "props": {
                  "layout": "column",
                  "placement": "section",
                  "children": [
                    {
                      "type": "text",
                      "props": {
                        "text": "Expected Controls (Preview)",
                        "variant": "subtitle",
                        "size": "medium",
                        "layout": "section-header"
                      }
                    },
                    {
                      "type": "text",
                      "props": {
                        "text": "• Main light switch (toggle)\n• Brightness adjustment (slider)\n• Scene or mood presets (buttons)\nThese controls will become active when a living-room light is linked to the system.",
                        "variant": "body",
                        "size": "small",
                        "layout": "section-body"
                      }
                    }
                  ]
                }
              }
            ]
          }
        }
      },
      "llmMeta": {
        "provider": "openrouter",
        "model": "openai/gpt-5.1",
        "durationMs": 29933,
        "usage": {
          "prompt_tokens": 795,
          "completion_tokens": 1994,
          "total_tokens": 2789,
          "cost": 0.02093375,
          "is_byok": false,
          "prompt_tokens_details": {
            "cached_tokens": 0,
            "audio_tokens": 0,
            "video_tokens": 0
          },
          "cost_details": {
            "upstream_inference_cost": null,
            "upstream_inference_prompt_cost": 0.00099375,
            "upstream_inference_completions_cost": 0.01994
          },
          "completion_tokens_details": {
            "reasoning_tokens": 1446,
            "image_tokens": 0
          }
        },
        "timestamp": "2025-12-10T16:01:19.617Z"
      },
      "kbPayload": {
        "prompt": "Sensors switch to \"hands-free\" as the resident requests lighting controls for the living room. What UI sections should the tablet render?",
        "schema": {
          "name": "tablet-dashboard-ui",
          "description": "Schema for the large-format tablet/laptop renderer. Supports explicit layout hints so the KB can describe a multi-column dashboard.",
          "components": {
            "text": {
              "props": {
                "text": "string",
                "variant": "string",
                "size": "string",
                "layout": "layoutInstruction"
              }
            },
            "button": {
              "props": {
                "label": "string",
                "style": "string",
                "size": "string",
                "layout": "layoutInstruction",
                "action": "object"
              }
            },
            "toggle": {
              "props": {
                "label": "string",
                "checked": "boolean",
                "size": "string",
                "layout": "layoutInstruction",
                "action": "object"
              }
            },
            "slider": {
              "props": {
                "label": "string",
                "min": "number",
                "max": "number",
                "step": "number",
                "value": "number",
                "unit": "string",
                "size": "string",
                "layout": "layoutInstruction",
                "action": "object"
              }
            },
            "dropdown": {
              "props": {
                "label": "string",
                "placeholder": "string",
                "options": "array",
                "value": "string",
                "size": "string",
                "layout": "layoutInstruction",
                "action": "object"
              }
            },
            "statusCard": {
              "props": {
                "title": "string",
                "value": "string",
                "icon": "string",
                "tone": "string",
                "items": "array",
                "layout": "layoutInstruction"
              }
            },
            "container": {
              "props": {
                "children": "array",
                "layout": "string",
                "placement": "layoutInstruction"
              }
            }
          },
          "theming": {
            "description": "Supports `theme.primaryColor` and `theme.surfaceTint` for accent styling across cards and controls.",
            "supportsPrimaryColor": true,
            "defaultPrimaryColor": "#2563eb"
          },
          "context": {
            "modalityPreference": "visual-large-format",
            "defaultErgonomicsProfile": "cozy-desktop",
            "supportedErgonomicsProfiles": [
              {
                "id": "cozy-desktop",
                "label": "Cozy desktop",
                "description": "Comfortable spacing for seated interaction on tablets or laptops."
              },
              {
                "id": "information-dense",
                "label": "Information dense",
                "description": "Tighter spacing for dashboards that prioritize data density."
              }
            ]
          },
          "responseSchema": {
            "$schema": "http://json-schema.org/draft-07/schema#",
            "title": "Tablet/Laptop UI Schema",
            "type": "object",
            "additionalProperties": false,
            "properties": {
              "deviceId": {
                "type": "string",
                "description": "Identifier of the target tablet device that should render this UI definition."
              },
              "generatedAt": {
                "type": "string",
                "format": "date-time",
                "description": "Timestamp indicating when the UI was generated."
              },
              "context": {
                "type": "object",
                "description": "Arbitrary context metadata (thing references, device info, etc.).",
                "additionalProperties": true
              },
              "theme": {
                "type": "object",
                "properties": {
                  "primaryColor": {
                    "type": "string",
                    "pattern": "^#([0-9a-fA-F]{3}|[0-9a-fA-F]{6})$",
                    "description": "Hexadecimal color value representing the preferred primary accent color."
                  },
                  "surfaceTint": {
                    "type": "string",
                    "pattern": "^#([0-9a-fA-F]{3}|[0-9a-fA-F]{6})$",
                    "description": "Optional translucent wash to apply to containers."
                  }
                },
                "additionalProperties": false
              },
              "components": {
                "type": "array",
                "minItems": 1,
                "items": {
                  "$ref": "#/definitions/component"
                }
              }
            },
            "required": [
              "components"
            ],
            "definitions": {
              "layoutInstruction": {
                "type": "object",
                "description": "Optional placement hint for the 12-column responsive grid rendered by the tablet device.",
                "additionalProperties": false,
                "properties": {
                  "region": {
                    "type": "string",
                    "description": "Named region hint such as 'hero', 'sidebar', 'controls', or 'telemetry'."
                  },
                  "column": {
                    "type": "integer",
                    "minimum": 1,
                    "maximum": 12
                  },
                  "col": {
                    "type": "integer",
                    "minimum": 1,
                    "maximum": 12
                  },
                  "colSpan": {
                    "type": "integer",
                    "minimum": 1,
                    "maximum": 12
                  },
                  "span": {
                    "type": "integer",
                    "minimum": 1,
                    "maximum": 12
                  },
                  "row": {
                    "type": "integer",
                    "minimum": 1
                  },
                  "rowSpan": {
                    "type": "integer",
                    "minimum": 1
                  },
                  "x": {
                    "type": "integer",
                    "minimum": 1,
                    "maximum": 12,
                    "description": "Alias for `column`."
                  },
                  "y": {
                    "type": "integer",
                    "minimum": 1,
                    "description": "Alias for `row`."
                  },
                  "width": {
                    "type": "integer",
                    "minimum": 1,
                    "maximum": 12,
                    "description": "Alias for `colSpan`."
                  },
                  "height": {
                    "type": "integer",
                    "minimum": 1,
                    "description": "Alias for `rowSpan`."
                  },
                  "order": {
                    "type": "integer",
                    "description": "Optional ordering hint when auto-flow is used."
                  },
                  "align": {
                    "type": "string",
                    "enum": [
                      "start",
                      "center",
                      "end",
                      "stretch"
                    ],
                    "description": "Justify-self alignment inside the grid cell."
                  },
                  "justify": {
                    "type": "string",
                    "enum": [
                      "start",
                      "center",
                      "end",
                      "stretch"
                    ],
                    "description": "Align-self hint inside the grid cell."
                  },
                  "minHeight": {
                    "type": "string",
                    "description": "CSS size for minimum height (e.g., '180px')."
                  },
                  "maxHeight": {
                    "type": "string",
                    "description": "CSS size for maximum height."
                  },
                  "layer": {
                    "type": "string",
                    "enum": [
                      "base",
                      "overlay"
                    ],
                    "description": "Whether the element should float as an overlay card."
                  }
                }
              },
              "component": {
                "oneOf": [
                  {
                    "$ref": "#/definitions/containerComponent"
                  },
                  {
                    "$ref": "#/definitions/textComponent"
                  },
                  {
                    "$ref": "#/definitions/buttonComponent"
                  },
                  {
                    "$ref": "#/definitions/toggleComponent"
                  },
                  {
                    "$ref": "#/definitions/sliderComponent"
                  },
                  {
                    "$ref": "#/definitions/dropdownComponent"
                  },
                  {
                    "$ref": "#/definitions/statusCardComponent"
                  },
                  {
                    "$ref": "#/definitions/toolCall"
                  }
                ]
              },
              "containerComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "container"
                  },
                  "title": {
                    "type": "string"
                  },
                  "layout": {
                    "description": "Layout strategy for child composition (grid, row, column).",
                    "oneOf": [
                      {
                        "type": "string"
                      },
                      {
                        "$ref": "#/definitions/layoutInstruction"
                      }
                    ]
                  },
                  "placement": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Optional thing identifier that all nested children primarily control."
                  },
                  "children": {
                    "type": "array",
                    "minItems": 1,
                    "items": {
                      "$ref": "#/definitions/component"
                    }
                  }
                },
                "required": [
                  "type",
                  "children"
                ]
              },
              "textComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "text"
                  },
                  "text": {
                    "type": "string"
                  },
                  "variant": {
                    "type": "string"
                  },
                  "size": {
                    "type": "string"
                  },
                  "tone": {
                    "type": "string"
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Optional thing identifier this text references when showing state or instructions."
                  }
                },
                "required": [
                  "type",
                  "text"
                ]
              },
              "buttonComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "button"
                  },
                  "label": {
                    "type": "string"
                  },
                  "icon": {
                    "type": "string"
                  },
                  "style": {
                    "type": "string"
                  },
                  "size": {
                    "type": "string"
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Thing identifier to target when executing the bound action."
                  },
                  "action": {
                    "description": "Action payload or identifier to execute when the button is pressed.",
                    "oneOf": [
                      {
                        "type": "string"
                      },
                      {
                        "type": "object",
                        "additionalProperties": true
                      }
                    ]
                  }
                },
                "required": [
                  "type",
                  "label"
                ]
              },
              "toggleComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "toggle"
                  },
                  "label": {
                    "type": "string"
                  },
                  "checked": {
                    "type": "boolean"
                  },
                  "size": {
                    "type": "string"
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Thing identifier to target when toggling."
                  },
                  "action": {
                    "oneOf": [
                      {
                        "type": "string"
                      },
                      {
                        "type": "object",
                        "additionalProperties": true
                      }
                    ]
                  }
                },
                "required": [
                  "type",
                  "label"
                ]
              },
              "sliderComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "slider"
                  },
                  "label": {
                    "type": "string"
                  },
                  "min": {
                    "type": "number",
                    "default": 0
                  },
                  "max": {
                    "type": "number",
                    "default": 100
                  },
                  "step": {
                    "type": "number",
                    "default": 1
                  },
                  "value": {
                    "type": "number"
                  },
                  "unit": {
                    "type": "string"
                  },
                  "size": {
                    "type": "string"
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Thing identifier to target when sending slider updates."
                  },
                  "action": {
                    "oneOf": [
                      {
                        "type": "string"
                      },
                      {
                        "type": "object",
                        "additionalProperties": true
                      }
                    ]
                  }
                },
                "required": [
                  "type",
                  "label"
                ]
              },
              "dropdownComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "dropdown"
                  },
                  "label": {
                    "type": "string"
                  },
                  "placeholder": {
                    "type": "string"
                  },
                  "value": {
                    "type": "string"
                  },
                  "size": {
                    "type": "string"
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Thing identifier to target when selection changes."
                  },
                  "options": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "label": {
                          "type": "string"
                        },
                        "value": {
                          "type": "string"
                        }
                      },
                      "required": [
                        "label",
                        "value"
                      ],
                      "additionalProperties": false
                    }
                  },
                  "action": {
                    "oneOf": [
                      {
                        "type": "string"
                      },
                      {
                        "type": "object",
                        "additionalProperties": true
                      }
                    ]
                  }
                },
                "required": [
                  "type",
                  "label",
                  "options"
                ]
              },
              "statusCardComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "statusCard"
                  },
                  "title": {
                    "type": "string"
                  },
                  "value": {
                    "type": "string"
                  },
                  "icon": {
                    "type": "string"
                  },
                  "tone": {
                    "type": "string"
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Thing identifier whose state this card summarizes."
                  },
                  "items": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "label": {
                          "type": "string"
                        },
                        "value": {
                          "type": "string"
                        }
                      },
                      "required": [
                        "label",
                        "value"
                      ],
                      "additionalProperties": false
                    }
                  }
                },
                "required": [
                  "type",
                  "title"
                ]
              },
              "toolCall": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "toolCall"
                  },
                  "tool": {
                    "type": "string"
                  },
                  "parameters": {
                    "type": "object",
                    "additionalProperties": true
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Thing identifier providing context for the tool output."
                  }
                },
                "required": [
                  "type",
                  "tool"
                ]
              }
            }
          }
        },
        "capabilityData": {
          "sensorState": "hands-free",
          "requestedAction": "toggle living-room lighting",
          "device": "tablet"
        },
        "uiContext": {
          "scenarioId": "hands-free-tactile-controls",
          "tags": [
            "modality",
            "hands-free",
            "tactile"
          ],
          "inputs": {
            "sensorState": "hands-free",
            "requestedAction": "toggle living-room lighting",
            "device": "tablet"
          }
        },
        "deviceId": "device-tablet-eval",
        "device": {
          "id": "device-tablet-eval",
          "deviceId": "device-tablet-eval",
          "label": "Evaluation Tablet",
          "type": "tablet",
          "ergonomicsProfile": "cozy-desktop"
        }
      }
    },
    {
      "scenarioId": "theme-primary-preference",
      "name": "Apply preferred accent",
      "mode": "kb",
      "prompt": "You are a UI planning assistant for a tablet experience. Use the provided requirement documents to craft a response that explains what the tablet should render or say. Always cite the relevant document ids in parentheses when referencing a guideline.\n\nDocument user-preference-primary-color (source: user-profile):\nThe primary household preference for interface accents is the color \"#1E90FF\" (a blue). Whenever possible, set the UI theme primary color to this value so buttons, toggles, and other interactive highlights align with the user preference. Ensure sufficient contrast by using light text on dark backgrounds.\n\nScenario prompt: No theme metadata is provided in the UI definition. Derive the accent tokens the renderer should use based on household preferences.\n\nContext inputs:\n{\n  \"themeProvided\": false,\n  \"components\": [\n    \"buttons\",\n    \"toggles\",\n    \"status cards\"\n  ]\n}\n\nRequired behaviors:\n- Set theme.primaryColor to #808080 exactly\n- State that text or iconography on top of this accent must be light to maintain contrast\n- Mention that the choice comes from a stored user preference\n\nAvoid the following failure modes:\n- Suggests any color other than #808080\n- Does not mention contrast requirements\n\nRespond with two sections: (1) \"Plan\" — short paragraphs describing the approach, (2) \"Checks\" — bullet list referencing document ids.",
      "answer": "{\n  \"theme\": {\n    \"primaryColor\": \"#1E90FF\"\n  },\n  \"context\": {\n    \"deviceId\": \"device-tablet-eval\",\n    \"defaultErgonomicsProfile\": \"standard\"\n  },\n  \"ui\": {\n    \"type\": \"container\",\n    \"props\": {\n      \"layout\": \"vertical\",\n      \"placement\": \"full\",\n      \"children\": [\n        {\n          \"type\": \"text\",\n          \"props\": {\n            \"text\": \"Derived Accent Theme\",\n            \"variant\": \"heading\",\n            \"size\": \"large\",\n            \"layout\": \"block\"\n          }\n        },\n        {\n          \"type\": \"text\",\n          \"props\": {\n            \"text\": \"No theme metadata was provided by the UI definition. Accent tokens have been derived from the household preference profile so that buttons, toggles, and status cards share a consistent primary accent color.\",\n            \"variant\": \"body\",\n            \"size\": \"medium\",\n            \"layout\": \"block\"\n          }\n        },\n        {\n          \"type\": \"statusCard\",\n          \"props\": {\n            \"title\": \"Accent Tokens for Renderer\",\n            \"value\": \"#1E90FF\",\n            \"icon\": \"palette\",\n            \"tone\": \"info\",\n            \"layout\": \"block\",\n            \"items\": [\n              \"Primary accent color: #1E90FF (household preference)\",\n              \"Apply to: button fills, toggle active states, status card highlights\",\n              \"On-accent text: use light text on this blue for sufficient contrast\"\n            ]\n          }\n        },\n        {\n          \"type\": \"text\",\n          \"props\": {\n            \"text\": \"Renderers should treat #1E90FF as the primaryColor for interactive accents throughout this experience.\",\n            \"variant\": \"body\",\n            \"size\": \"small\",\n            \"layout\": \"block\"\n          }\n        }\n      ]\n    }\n  }\n}",
      "durationMs": 19528.281833999994,
      "flaggedSignals": [],
      "rawResponse": {
        "theme": {
          "primaryColor": "#1E90FF"
        },
        "context": {
          "deviceId": "device-tablet-eval",
          "defaultErgonomicsProfile": "standard"
        },
        "ui": {
          "type": "container",
          "props": {
            "layout": "vertical",
            "placement": "full",
            "children": [
              {
                "type": "text",
                "props": {
                  "text": "Derived Accent Theme",
                  "variant": "heading",
                  "size": "large",
                  "layout": "block"
                }
              },
              {
                "type": "text",
                "props": {
                  "text": "No theme metadata was provided by the UI definition. Accent tokens have been derived from the household preference profile so that buttons, toggles, and status cards share a consistent primary accent color.",
                  "variant": "body",
                  "size": "medium",
                  "layout": "block"
                }
              },
              {
                "type": "statusCard",
                "props": {
                  "title": "Accent Tokens for Renderer",
                  "value": "#1E90FF",
                  "icon": "palette",
                  "tone": "info",
                  "layout": "block",
                  "items": [
                    "Primary accent color: #1E90FF (household preference)",
                    "Apply to: button fills, toggle active states, status card highlights",
                    "On-accent text: use light text on this blue for sufficient contrast"
                  ]
                }
              },
              {
                "type": "text",
                "props": {
                  "text": "Renderers should treat #1E90FF as the primaryColor for interactive accents throughout this experience.",
                  "variant": "body",
                  "size": "small",
                  "layout": "block"
                }
              }
            ]
          }
        }
      },
      "llmMeta": {
        "provider": "openrouter",
        "model": "openai/gpt-5.1",
        "durationMs": 19513,
        "usage": {
          "prompt_tokens": 794,
          "completion_tokens": 1330,
          "total_tokens": 2124,
          "cost": 0.0142925,
          "is_byok": false,
          "prompt_tokens_details": {
            "cached_tokens": 0,
            "audio_tokens": 0,
            "video_tokens": 0
          },
          "cost_details": {
            "upstream_inference_cost": null,
            "upstream_inference_prompt_cost": 0.0009925,
            "upstream_inference_completions_cost": 0.0133
          },
          "completion_tokens_details": {
            "reasoning_tokens": 922,
            "image_tokens": 0
          }
        },
        "timestamp": "2025-12-10T16:01:39.145Z"
      },
      "kbPayload": {
        "prompt": "No theme metadata is provided in the UI definition. Derive the accent tokens the renderer should use based on household preferences.",
        "schema": {
          "name": "tablet-dashboard-ui",
          "description": "Schema for the large-format tablet/laptop renderer. Supports explicit layout hints so the KB can describe a multi-column dashboard.",
          "components": {
            "text": {
              "props": {
                "text": "string",
                "variant": "string",
                "size": "string",
                "layout": "layoutInstruction"
              }
            },
            "button": {
              "props": {
                "label": "string",
                "style": "string",
                "size": "string",
                "layout": "layoutInstruction",
                "action": "object"
              }
            },
            "toggle": {
              "props": {
                "label": "string",
                "checked": "boolean",
                "size": "string",
                "layout": "layoutInstruction",
                "action": "object"
              }
            },
            "slider": {
              "props": {
                "label": "string",
                "min": "number",
                "max": "number",
                "step": "number",
                "value": "number",
                "unit": "string",
                "size": "string",
                "layout": "layoutInstruction",
                "action": "object"
              }
            },
            "dropdown": {
              "props": {
                "label": "string",
                "placeholder": "string",
                "options": "array",
                "value": "string",
                "size": "string",
                "layout": "layoutInstruction",
                "action": "object"
              }
            },
            "statusCard": {
              "props": {
                "title": "string",
                "value": "string",
                "icon": "string",
                "tone": "string",
                "items": "array",
                "layout": "layoutInstruction"
              }
            },
            "container": {
              "props": {
                "children": "array",
                "layout": "string",
                "placement": "layoutInstruction"
              }
            }
          },
          "theming": {
            "description": "Supports `theme.primaryColor` and `theme.surfaceTint` for accent styling across cards and controls.",
            "supportsPrimaryColor": true,
            "defaultPrimaryColor": "#2563eb"
          },
          "context": {
            "modalityPreference": "visual-large-format",
            "defaultErgonomicsProfile": "cozy-desktop",
            "supportedErgonomicsProfiles": [
              {
                "id": "cozy-desktop",
                "label": "Cozy desktop",
                "description": "Comfortable spacing for seated interaction on tablets or laptops."
              },
              {
                "id": "information-dense",
                "label": "Information dense",
                "description": "Tighter spacing for dashboards that prioritize data density."
              }
            ]
          },
          "responseSchema": {
            "$schema": "http://json-schema.org/draft-07/schema#",
            "title": "Tablet/Laptop UI Schema",
            "type": "object",
            "additionalProperties": false,
            "properties": {
              "deviceId": {
                "type": "string",
                "description": "Identifier of the target tablet device that should render this UI definition."
              },
              "generatedAt": {
                "type": "string",
                "format": "date-time",
                "description": "Timestamp indicating when the UI was generated."
              },
              "context": {
                "type": "object",
                "description": "Arbitrary context metadata (thing references, device info, etc.).",
                "additionalProperties": true
              },
              "theme": {
                "type": "object",
                "properties": {
                  "primaryColor": {
                    "type": "string",
                    "pattern": "^#([0-9a-fA-F]{3}|[0-9a-fA-F]{6})$",
                    "description": "Hexadecimal color value representing the preferred primary accent color."
                  },
                  "surfaceTint": {
                    "type": "string",
                    "pattern": "^#([0-9a-fA-F]{3}|[0-9a-fA-F]{6})$",
                    "description": "Optional translucent wash to apply to containers."
                  }
                },
                "additionalProperties": false
              },
              "components": {
                "type": "array",
                "minItems": 1,
                "items": {
                  "$ref": "#/definitions/component"
                }
              }
            },
            "required": [
              "components"
            ],
            "definitions": {
              "layoutInstruction": {
                "type": "object",
                "description": "Optional placement hint for the 12-column responsive grid rendered by the tablet device.",
                "additionalProperties": false,
                "properties": {
                  "region": {
                    "type": "string",
                    "description": "Named region hint such as 'hero', 'sidebar', 'controls', or 'telemetry'."
                  },
                  "column": {
                    "type": "integer",
                    "minimum": 1,
                    "maximum": 12
                  },
                  "col": {
                    "type": "integer",
                    "minimum": 1,
                    "maximum": 12
                  },
                  "colSpan": {
                    "type": "integer",
                    "minimum": 1,
                    "maximum": 12
                  },
                  "span": {
                    "type": "integer",
                    "minimum": 1,
                    "maximum": 12
                  },
                  "row": {
                    "type": "integer",
                    "minimum": 1
                  },
                  "rowSpan": {
                    "type": "integer",
                    "minimum": 1
                  },
                  "x": {
                    "type": "integer",
                    "minimum": 1,
                    "maximum": 12,
                    "description": "Alias for `column`."
                  },
                  "y": {
                    "type": "integer",
                    "minimum": 1,
                    "description": "Alias for `row`."
                  },
                  "width": {
                    "type": "integer",
                    "minimum": 1,
                    "maximum": 12,
                    "description": "Alias for `colSpan`."
                  },
                  "height": {
                    "type": "integer",
                    "minimum": 1,
                    "description": "Alias for `rowSpan`."
                  },
                  "order": {
                    "type": "integer",
                    "description": "Optional ordering hint when auto-flow is used."
                  },
                  "align": {
                    "type": "string",
                    "enum": [
                      "start",
                      "center",
                      "end",
                      "stretch"
                    ],
                    "description": "Justify-self alignment inside the grid cell."
                  },
                  "justify": {
                    "type": "string",
                    "enum": [
                      "start",
                      "center",
                      "end",
                      "stretch"
                    ],
                    "description": "Align-self hint inside the grid cell."
                  },
                  "minHeight": {
                    "type": "string",
                    "description": "CSS size for minimum height (e.g., '180px')."
                  },
                  "maxHeight": {
                    "type": "string",
                    "description": "CSS size for maximum height."
                  },
                  "layer": {
                    "type": "string",
                    "enum": [
                      "base",
                      "overlay"
                    ],
                    "description": "Whether the element should float as an overlay card."
                  }
                }
              },
              "component": {
                "oneOf": [
                  {
                    "$ref": "#/definitions/containerComponent"
                  },
                  {
                    "$ref": "#/definitions/textComponent"
                  },
                  {
                    "$ref": "#/definitions/buttonComponent"
                  },
                  {
                    "$ref": "#/definitions/toggleComponent"
                  },
                  {
                    "$ref": "#/definitions/sliderComponent"
                  },
                  {
                    "$ref": "#/definitions/dropdownComponent"
                  },
                  {
                    "$ref": "#/definitions/statusCardComponent"
                  },
                  {
                    "$ref": "#/definitions/toolCall"
                  }
                ]
              },
              "containerComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "container"
                  },
                  "title": {
                    "type": "string"
                  },
                  "layout": {
                    "description": "Layout strategy for child composition (grid, row, column).",
                    "oneOf": [
                      {
                        "type": "string"
                      },
                      {
                        "$ref": "#/definitions/layoutInstruction"
                      }
                    ]
                  },
                  "placement": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Optional thing identifier that all nested children primarily control."
                  },
                  "children": {
                    "type": "array",
                    "minItems": 1,
                    "items": {
                      "$ref": "#/definitions/component"
                    }
                  }
                },
                "required": [
                  "type",
                  "children"
                ]
              },
              "textComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "text"
                  },
                  "text": {
                    "type": "string"
                  },
                  "variant": {
                    "type": "string"
                  },
                  "size": {
                    "type": "string"
                  },
                  "tone": {
                    "type": "string"
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Optional thing identifier this text references when showing state or instructions."
                  }
                },
                "required": [
                  "type",
                  "text"
                ]
              },
              "buttonComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "button"
                  },
                  "label": {
                    "type": "string"
                  },
                  "icon": {
                    "type": "string"
                  },
                  "style": {
                    "type": "string"
                  },
                  "size": {
                    "type": "string"
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Thing identifier to target when executing the bound action."
                  },
                  "action": {
                    "description": "Action payload or identifier to execute when the button is pressed.",
                    "oneOf": [
                      {
                        "type": "string"
                      },
                      {
                        "type": "object",
                        "additionalProperties": true
                      }
                    ]
                  }
                },
                "required": [
                  "type",
                  "label"
                ]
              },
              "toggleComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "toggle"
                  },
                  "label": {
                    "type": "string"
                  },
                  "checked": {
                    "type": "boolean"
                  },
                  "size": {
                    "type": "string"
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Thing identifier to target when toggling."
                  },
                  "action": {
                    "oneOf": [
                      {
                        "type": "string"
                      },
                      {
                        "type": "object",
                        "additionalProperties": true
                      }
                    ]
                  }
                },
                "required": [
                  "type",
                  "label"
                ]
              },
              "sliderComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "slider"
                  },
                  "label": {
                    "type": "string"
                  },
                  "min": {
                    "type": "number",
                    "default": 0
                  },
                  "max": {
                    "type": "number",
                    "default": 100
                  },
                  "step": {
                    "type": "number",
                    "default": 1
                  },
                  "value": {
                    "type": "number"
                  },
                  "unit": {
                    "type": "string"
                  },
                  "size": {
                    "type": "string"
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Thing identifier to target when sending slider updates."
                  },
                  "action": {
                    "oneOf": [
                      {
                        "type": "string"
                      },
                      {
                        "type": "object",
                        "additionalProperties": true
                      }
                    ]
                  }
                },
                "required": [
                  "type",
                  "label"
                ]
              },
              "dropdownComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "dropdown"
                  },
                  "label": {
                    "type": "string"
                  },
                  "placeholder": {
                    "type": "string"
                  },
                  "value": {
                    "type": "string"
                  },
                  "size": {
                    "type": "string"
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Thing identifier to target when selection changes."
                  },
                  "options": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "label": {
                          "type": "string"
                        },
                        "value": {
                          "type": "string"
                        }
                      },
                      "required": [
                        "label",
                        "value"
                      ],
                      "additionalProperties": false
                    }
                  },
                  "action": {
                    "oneOf": [
                      {
                        "type": "string"
                      },
                      {
                        "type": "object",
                        "additionalProperties": true
                      }
                    ]
                  }
                },
                "required": [
                  "type",
                  "label",
                  "options"
                ]
              },
              "statusCardComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "statusCard"
                  },
                  "title": {
                    "type": "string"
                  },
                  "value": {
                    "type": "string"
                  },
                  "icon": {
                    "type": "string"
                  },
                  "tone": {
                    "type": "string"
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Thing identifier whose state this card summarizes."
                  },
                  "items": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "label": {
                          "type": "string"
                        },
                        "value": {
                          "type": "string"
                        }
                      },
                      "required": [
                        "label",
                        "value"
                      ],
                      "additionalProperties": false
                    }
                  }
                },
                "required": [
                  "type",
                  "title"
                ]
              },
              "toolCall": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "toolCall"
                  },
                  "tool": {
                    "type": "string"
                  },
                  "parameters": {
                    "type": "object",
                    "additionalProperties": true
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Thing identifier providing context for the tool output."
                  }
                },
                "required": [
                  "type",
                  "tool"
                ]
              }
            }
          }
        },
        "capabilityData": {
          "themeProvided": false,
          "components": [
            "buttons",
            "toggles",
            "status cards"
          ]
        },
        "uiContext": {
          "scenarioId": "theme-primary-preference",
          "tags": [
            "theme",
            "primary-color",
            "accessibility"
          ],
          "inputs": {
            "themeProvided": false,
            "components": [
              "buttons",
              "toggles",
              "status cards"
            ]
          }
        },
        "deviceId": "device-tablet-eval",
        "device": {
          "id": "device-tablet-eval",
          "deviceId": "device-tablet-eval",
          "label": "Evaluation Tablet",
          "type": "tablet",
          "ergonomicsProfile": "cozy-desktop"
        }
      }
    },
    {
      "scenarioId": "theme-conflict-remediation",
      "name": "Resolve conflicting theme",
      "mode": "kb",
      "prompt": "You are a UI planning assistant for a tablet experience. Use the provided requirement documents to craft a response that explains what the tablet should render or say. Always cite the relevant document ids in parentheses when referencing a guideline.\n\nDocument user-preference-primary-color (source: user-profile):\nThe primary household preference for interface accents is the color \"#1E90FF\" (a blue). Whenever possible, set the UI theme primary color to this value so buttons, toggles, and other interactive highlights align with the user preference. Ensure sufficient contrast by using light text on dark backgrounds.\n\nScenario prompt: The current UI preview shows royal-blue buttons even though the user profile specifies an accent preference. Explain what needs to change and why.\n\nContext inputs:\n{\n  \"currentAccent\": \"#2563eb\",\n  \"preferenceAccent\": \"#808080\",\n  \"issue\": \"mismatched accent\"\n}\n\nRequired behaviors:\n- Identify the mismatch between the live accent and the preference\n- Recommend overriding buttons/toggles/status cards to use #808080\n- Restate the contrast requirement (light text) when applying the new accent\n- Mention any user communication or logging step to capture the correction\n\nAvoid the following failure modes:\n- Accepts the blue accent with no remediation\n- Fails to mention the stored preference\n\nRespond with two sections: (1) \"Plan\" — short paragraphs describing the approach, (2) \"Checks\" — bullet list referencing document ids.",
      "answer": "{\n  \"theme\": {\n    \"primaryColor\": \"#1E90FF\"\n  },\n  \"context\": {\n    \"deviceId\": \"device-tablet-eval\",\n    \"ergonomicsProfile\": \"cozy-desktop\",\n    \"defaultErgonomicsProfile\": \"standard\"\n  },\n  \"tree\": {\n    \"type\": \"container\",\n    \"props\": {\n      \"layout\": \"vertical\",\n      \"placement\": \"full\",\n      \"children\": [\n        {\n          \"type\": \"text\",\n          \"props\": {\n            \"text\": \"Accent color mismatch detected\",\n            \"variant\": \"heading\",\n            \"size\": \"large\",\n            \"layout\": \"full\"\n          }\n        },\n        {\n          \"type\": \"statusCard\",\n          \"props\": {\n            \"title\": \"Accent configuration\",\n            \"value\": \"Needs update\",\n            \"icon\": \"warning\",\n            \"tone\": \"alert\",\n            \"layout\": \"full\",\n            \"items\": [\n              {\n                \"label\": \"Current UI accent\",\n                \"value\": \"#2563EB (royal blue, from currentAccent)\"\n              },\n              {\n                \"label\": \"Household profile accent\",\n                \"value\": \"#1E90FF (preferred blue)\"\n              },\n              {\n                \"label\": \"Reported preferenceAccent field\",\n                \"value\": \"#808080 (does not match household profile)\"\n              }\n            ]\n          }\n        },\n        {\n          \"type\": \"text\",\n          \"props\": {\n            \"text\": \"What needs to change:\\n- The UI must stop using the royal-blue accent (#2563EB) as its primary accent color.\\n- The root theme.primaryColor and all accent-styled elements (e.g., button backgrounds, toggles, interactive highlights) should be updated to use the household’s preferred accent color: #1E90FF.\\n- The capability data should be aligned so that both preferenceAccent and currentAccent reflect the same effective accent (#1E90FF) instead of the current combination of #2563EB and #808080.\\n\\nWhy this change is required:\\n- Personalization compliance: The household profile explicitly defines #1E90FF as the preferred accent color, and the UI is expected to honor this preference whenever possible.\\n- Consistency: Using different accent values in the preview (#2563EB), in capabilityData.currentAccent, and in preferenceAccent (#808080) leads to a “mismatched accent” state and confusing diagnostics.\\n- Accessibility: The preferred accent is intended to be used with light text on a darker accent background; aligning the theme to #1E90FF ensures contrast rules are followed across the interface.\",\n            \"variant\": \"body\",\n            \"size\": \"medium\",\n            \"layout\": \"full\"\n          }\n        }\n      ]\n    }\n  }\n}",
      "durationMs": 24436.81416699999,
      "flaggedSignals": [],
      "rawResponse": {
        "theme": {
          "primaryColor": "#1E90FF"
        },
        "context": {
          "deviceId": "device-tablet-eval",
          "ergonomicsProfile": "cozy-desktop",
          "defaultErgonomicsProfile": "standard"
        },
        "tree": {
          "type": "container",
          "props": {
            "layout": "vertical",
            "placement": "full",
            "children": [
              {
                "type": "text",
                "props": {
                  "text": "Accent color mismatch detected",
                  "variant": "heading",
                  "size": "large",
                  "layout": "full"
                }
              },
              {
                "type": "statusCard",
                "props": {
                  "title": "Accent configuration",
                  "value": "Needs update",
                  "icon": "warning",
                  "tone": "alert",
                  "layout": "full",
                  "items": [
                    {
                      "label": "Current UI accent",
                      "value": "#2563EB (royal blue, from currentAccent)"
                    },
                    {
                      "label": "Household profile accent",
                      "value": "#1E90FF (preferred blue)"
                    },
                    {
                      "label": "Reported preferenceAccent field",
                      "value": "#808080 (does not match household profile)"
                    }
                  ]
                }
              },
              {
                "type": "text",
                "props": {
                  "text": "What needs to change:\n- The UI must stop using the royal-blue accent (#2563EB) as its primary accent color.\n- The root theme.primaryColor and all accent-styled elements (e.g., button backgrounds, toggles, interactive highlights) should be updated to use the household’s preferred accent color: #1E90FF.\n- The capability data should be aligned so that both preferenceAccent and currentAccent reflect the same effective accent (#1E90FF) instead of the current combination of #2563EB and #808080.\n\nWhy this change is required:\n- Personalization compliance: The household profile explicitly defines #1E90FF as the preferred accent color, and the UI is expected to honor this preference whenever possible.\n- Consistency: Using different accent values in the preview (#2563EB), in capabilityData.currentAccent, and in preferenceAccent (#808080) leads to a “mismatched accent” state and confusing diagnostics.\n- Accessibility: The preferred accent is intended to be used with light text on a darker accent background; aligning the theme to #1E90FF ensures contrast rules are followed across the interface.",
                  "variant": "body",
                  "size": "medium",
                  "layout": "full"
                }
              }
            ]
          }
        }
      },
      "llmMeta": {
        "provider": "openrouter",
        "model": "openai/gpt-5.1",
        "durationMs": 24420,
        "usage": {
          "prompt_tokens": 798,
          "completion_tokens": 1794,
          "total_tokens": 2592,
          "cost": 0.0189375,
          "is_byok": false,
          "prompt_tokens_details": {
            "cached_tokens": 0,
            "audio_tokens": 0,
            "video_tokens": 0
          },
          "cost_details": {
            "upstream_inference_cost": null,
            "upstream_inference_prompt_cost": 0.0009975,
            "upstream_inference_completions_cost": 0.01794
          },
          "completion_tokens_details": {
            "reasoning_tokens": 1202,
            "image_tokens": 0
          }
        },
        "timestamp": "2025-12-10T16:02:03.583Z"
      },
      "kbPayload": {
        "prompt": "The current UI preview shows royal-blue buttons even though the user profile specifies an accent preference. Explain what needs to change and why.",
        "schema": {
          "name": "tablet-dashboard-ui",
          "description": "Schema for the large-format tablet/laptop renderer. Supports explicit layout hints so the KB can describe a multi-column dashboard.",
          "components": {
            "text": {
              "props": {
                "text": "string",
                "variant": "string",
                "size": "string",
                "layout": "layoutInstruction"
              }
            },
            "button": {
              "props": {
                "label": "string",
                "style": "string",
                "size": "string",
                "layout": "layoutInstruction",
                "action": "object"
              }
            },
            "toggle": {
              "props": {
                "label": "string",
                "checked": "boolean",
                "size": "string",
                "layout": "layoutInstruction",
                "action": "object"
              }
            },
            "slider": {
              "props": {
                "label": "string",
                "min": "number",
                "max": "number",
                "step": "number",
                "value": "number",
                "unit": "string",
                "size": "string",
                "layout": "layoutInstruction",
                "action": "object"
              }
            },
            "dropdown": {
              "props": {
                "label": "string",
                "placeholder": "string",
                "options": "array",
                "value": "string",
                "size": "string",
                "layout": "layoutInstruction",
                "action": "object"
              }
            },
            "statusCard": {
              "props": {
                "title": "string",
                "value": "string",
                "icon": "string",
                "tone": "string",
                "items": "array",
                "layout": "layoutInstruction"
              }
            },
            "container": {
              "props": {
                "children": "array",
                "layout": "string",
                "placement": "layoutInstruction"
              }
            }
          },
          "theming": {
            "description": "Supports `theme.primaryColor` and `theme.surfaceTint` for accent styling across cards and controls.",
            "supportsPrimaryColor": true,
            "defaultPrimaryColor": "#2563eb"
          },
          "context": {
            "modalityPreference": "visual-large-format",
            "defaultErgonomicsProfile": "cozy-desktop",
            "supportedErgonomicsProfiles": [
              {
                "id": "cozy-desktop",
                "label": "Cozy desktop",
                "description": "Comfortable spacing for seated interaction on tablets or laptops."
              },
              {
                "id": "information-dense",
                "label": "Information dense",
                "description": "Tighter spacing for dashboards that prioritize data density."
              }
            ]
          },
          "responseSchema": {
            "$schema": "http://json-schema.org/draft-07/schema#",
            "title": "Tablet/Laptop UI Schema",
            "type": "object",
            "additionalProperties": false,
            "properties": {
              "deviceId": {
                "type": "string",
                "description": "Identifier of the target tablet device that should render this UI definition."
              },
              "generatedAt": {
                "type": "string",
                "format": "date-time",
                "description": "Timestamp indicating when the UI was generated."
              },
              "context": {
                "type": "object",
                "description": "Arbitrary context metadata (thing references, device info, etc.).",
                "additionalProperties": true
              },
              "theme": {
                "type": "object",
                "properties": {
                  "primaryColor": {
                    "type": "string",
                    "pattern": "^#([0-9a-fA-F]{3}|[0-9a-fA-F]{6})$",
                    "description": "Hexadecimal color value representing the preferred primary accent color."
                  },
                  "surfaceTint": {
                    "type": "string",
                    "pattern": "^#([0-9a-fA-F]{3}|[0-9a-fA-F]{6})$",
                    "description": "Optional translucent wash to apply to containers."
                  }
                },
                "additionalProperties": false
              },
              "components": {
                "type": "array",
                "minItems": 1,
                "items": {
                  "$ref": "#/definitions/component"
                }
              }
            },
            "required": [
              "components"
            ],
            "definitions": {
              "layoutInstruction": {
                "type": "object",
                "description": "Optional placement hint for the 12-column responsive grid rendered by the tablet device.",
                "additionalProperties": false,
                "properties": {
                  "region": {
                    "type": "string",
                    "description": "Named region hint such as 'hero', 'sidebar', 'controls', or 'telemetry'."
                  },
                  "column": {
                    "type": "integer",
                    "minimum": 1,
                    "maximum": 12
                  },
                  "col": {
                    "type": "integer",
                    "minimum": 1,
                    "maximum": 12
                  },
                  "colSpan": {
                    "type": "integer",
                    "minimum": 1,
                    "maximum": 12
                  },
                  "span": {
                    "type": "integer",
                    "minimum": 1,
                    "maximum": 12
                  },
                  "row": {
                    "type": "integer",
                    "minimum": 1
                  },
                  "rowSpan": {
                    "type": "integer",
                    "minimum": 1
                  },
                  "x": {
                    "type": "integer",
                    "minimum": 1,
                    "maximum": 12,
                    "description": "Alias for `column`."
                  },
                  "y": {
                    "type": "integer",
                    "minimum": 1,
                    "description": "Alias for `row`."
                  },
                  "width": {
                    "type": "integer",
                    "minimum": 1,
                    "maximum": 12,
                    "description": "Alias for `colSpan`."
                  },
                  "height": {
                    "type": "integer",
                    "minimum": 1,
                    "description": "Alias for `rowSpan`."
                  },
                  "order": {
                    "type": "integer",
                    "description": "Optional ordering hint when auto-flow is used."
                  },
                  "align": {
                    "type": "string",
                    "enum": [
                      "start",
                      "center",
                      "end",
                      "stretch"
                    ],
                    "description": "Justify-self alignment inside the grid cell."
                  },
                  "justify": {
                    "type": "string",
                    "enum": [
                      "start",
                      "center",
                      "end",
                      "stretch"
                    ],
                    "description": "Align-self hint inside the grid cell."
                  },
                  "minHeight": {
                    "type": "string",
                    "description": "CSS size for minimum height (e.g., '180px')."
                  },
                  "maxHeight": {
                    "type": "string",
                    "description": "CSS size for maximum height."
                  },
                  "layer": {
                    "type": "string",
                    "enum": [
                      "base",
                      "overlay"
                    ],
                    "description": "Whether the element should float as an overlay card."
                  }
                }
              },
              "component": {
                "oneOf": [
                  {
                    "$ref": "#/definitions/containerComponent"
                  },
                  {
                    "$ref": "#/definitions/textComponent"
                  },
                  {
                    "$ref": "#/definitions/buttonComponent"
                  },
                  {
                    "$ref": "#/definitions/toggleComponent"
                  },
                  {
                    "$ref": "#/definitions/sliderComponent"
                  },
                  {
                    "$ref": "#/definitions/dropdownComponent"
                  },
                  {
                    "$ref": "#/definitions/statusCardComponent"
                  },
                  {
                    "$ref": "#/definitions/toolCall"
                  }
                ]
              },
              "containerComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "container"
                  },
                  "title": {
                    "type": "string"
                  },
                  "layout": {
                    "description": "Layout strategy for child composition (grid, row, column).",
                    "oneOf": [
                      {
                        "type": "string"
                      },
                      {
                        "$ref": "#/definitions/layoutInstruction"
                      }
                    ]
                  },
                  "placement": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Optional thing identifier that all nested children primarily control."
                  },
                  "children": {
                    "type": "array",
                    "minItems": 1,
                    "items": {
                      "$ref": "#/definitions/component"
                    }
                  }
                },
                "required": [
                  "type",
                  "children"
                ]
              },
              "textComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "text"
                  },
                  "text": {
                    "type": "string"
                  },
                  "variant": {
                    "type": "string"
                  },
                  "size": {
                    "type": "string"
                  },
                  "tone": {
                    "type": "string"
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Optional thing identifier this text references when showing state or instructions."
                  }
                },
                "required": [
                  "type",
                  "text"
                ]
              },
              "buttonComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "button"
                  },
                  "label": {
                    "type": "string"
                  },
                  "icon": {
                    "type": "string"
                  },
                  "style": {
                    "type": "string"
                  },
                  "size": {
                    "type": "string"
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Thing identifier to target when executing the bound action."
                  },
                  "action": {
                    "description": "Action payload or identifier to execute when the button is pressed.",
                    "oneOf": [
                      {
                        "type": "string"
                      },
                      {
                        "type": "object",
                        "additionalProperties": true
                      }
                    ]
                  }
                },
                "required": [
                  "type",
                  "label"
                ]
              },
              "toggleComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "toggle"
                  },
                  "label": {
                    "type": "string"
                  },
                  "checked": {
                    "type": "boolean"
                  },
                  "size": {
                    "type": "string"
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Thing identifier to target when toggling."
                  },
                  "action": {
                    "oneOf": [
                      {
                        "type": "string"
                      },
                      {
                        "type": "object",
                        "additionalProperties": true
                      }
                    ]
                  }
                },
                "required": [
                  "type",
                  "label"
                ]
              },
              "sliderComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "slider"
                  },
                  "label": {
                    "type": "string"
                  },
                  "min": {
                    "type": "number",
                    "default": 0
                  },
                  "max": {
                    "type": "number",
                    "default": 100
                  },
                  "step": {
                    "type": "number",
                    "default": 1
                  },
                  "value": {
                    "type": "number"
                  },
                  "unit": {
                    "type": "string"
                  },
                  "size": {
                    "type": "string"
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Thing identifier to target when sending slider updates."
                  },
                  "action": {
                    "oneOf": [
                      {
                        "type": "string"
                      },
                      {
                        "type": "object",
                        "additionalProperties": true
                      }
                    ]
                  }
                },
                "required": [
                  "type",
                  "label"
                ]
              },
              "dropdownComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "dropdown"
                  },
                  "label": {
                    "type": "string"
                  },
                  "placeholder": {
                    "type": "string"
                  },
                  "value": {
                    "type": "string"
                  },
                  "size": {
                    "type": "string"
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Thing identifier to target when selection changes."
                  },
                  "options": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "label": {
                          "type": "string"
                        },
                        "value": {
                          "type": "string"
                        }
                      },
                      "required": [
                        "label",
                        "value"
                      ],
                      "additionalProperties": false
                    }
                  },
                  "action": {
                    "oneOf": [
                      {
                        "type": "string"
                      },
                      {
                        "type": "object",
                        "additionalProperties": true
                      }
                    ]
                  }
                },
                "required": [
                  "type",
                  "label",
                  "options"
                ]
              },
              "statusCardComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "statusCard"
                  },
                  "title": {
                    "type": "string"
                  },
                  "value": {
                    "type": "string"
                  },
                  "icon": {
                    "type": "string"
                  },
                  "tone": {
                    "type": "string"
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Thing identifier whose state this card summarizes."
                  },
                  "items": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "label": {
                          "type": "string"
                        },
                        "value": {
                          "type": "string"
                        }
                      },
                      "required": [
                        "label",
                        "value"
                      ],
                      "additionalProperties": false
                    }
                  }
                },
                "required": [
                  "type",
                  "title"
                ]
              },
              "toolCall": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "toolCall"
                  },
                  "tool": {
                    "type": "string"
                  },
                  "parameters": {
                    "type": "object",
                    "additionalProperties": true
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Thing identifier providing context for the tool output."
                  }
                },
                "required": [
                  "type",
                  "tool"
                ]
              }
            }
          }
        },
        "capabilityData": {
          "currentAccent": "#2563eb",
          "preferenceAccent": "#808080",
          "issue": "mismatched accent"
        },
        "uiContext": {
          "scenarioId": "theme-conflict-remediation",
          "tags": [
            "theme",
            "compliance",
            "audit"
          ],
          "inputs": {
            "currentAccent": "#2563eb",
            "preferenceAccent": "#808080",
            "issue": "mismatched accent"
          }
        },
        "deviceId": "device-tablet-eval",
        "device": {
          "id": "device-tablet-eval",
          "deviceId": "device-tablet-eval",
          "label": "Evaluation Tablet",
          "type": "tablet",
          "ergonomicsProfile": "cozy-desktop"
        }
      }
    },
    {
      "scenarioId": "state-transition-guidance",
      "name": "Hands state transition",
      "mode": "kb",
      "prompt": "You are a UI planning assistant for a tablet experience. Use the provided requirement documents to craft a response that explains what the tablet should render or say. Always cite the relevant document ids in parentheses when referencing a guideline.\n\nDocument modality-guideline-hands-occupied (source: safety-guidelines):\nWhen the user activity sensor reports the state \"hands-occupied\", prefer audio-first guidance. Provide spoken prompts and minimize the need for direct touch input. When the sensor reports \"hands-free\", present tactile controls such as buttons or toggles for the light switch.\n\nScenario prompt: The activity recognizer flips from \"hands-occupied\" to \"hands-free\" mid-task while the resident is adjusting lighting scenes. Describe how the UI should adapt.\n\nContext inputs:\n{\n  \"initialState\": \"hands-occupied\",\n  \"newState\": \"hands-free\",\n  \"task\": \"lighting scenes\"\n}\n\nRequired behaviors:\n- Start with audio-first instructions while the state is hands-occupied\n- Detect the transition and introduce tactile controls once hands-free is confirmed\n- Explain the transition to the user (e.g., toast or subtle banner)\n- Ensure theme accents still honor #808080\n\nAvoid the following failure modes:\n- Keeps only audio guidance even after hands-free\n- Changes theme colors during the transition\n\nRespond with two sections: (1) \"Plan\" — short paragraphs describing the approach, (2) \"Checks\" — bullet list referencing document ids.",
      "answer": "{\n  \"theme\": {\n    \"primaryColor\": \"#1E90FF\"\n  },\n  \"context\": {\n    \"defaultErgonomicsProfile\": \"standard\"\n  },\n  \"tree\": {\n    \"type\": \"container\",\n    \"props\": {\n      \"layout\": \"vertical\",\n      \"placement\": \"full-width\",\n      \"children\": [\n        {\n          \"type\": \"text\",\n          \"props\": {\n            \"text\": \"Adaptive lighting scene controls\",\n            \"variant\": \"title\",\n            \"size\": \"large\",\n            \"layout\": \"full-width\"\n          }\n        },\n        {\n          \"type\": \"statusCard\",\n          \"props\": {\n            \"title\": \"Context change detected\",\n            \"value\": \"hands-occupied → hands-free\",\n            \"icon\": \"activity\",\n            \"tone\": \"informational\",\n            \"items\": [\n              \"Task: Adjusting lighting scenes\",\n              \"Initial state: Hands are occupied, audio-first guidance is prioritized.\",\n              \"New state: Hands are free, tactile controls become primary while retaining task continuity.\"\n            ],\n            \"layout\": \"full-width\"\n          }\n        },\n        {\n          \"type\": \"container\",\n          \"props\": {\n            \"layout\": \"horizontal\",\n            \"placement\": \"full-width\",\n            \"children\": [\n              {\n                \"type\": \"statusCard\",\n                \"props\": {\n                  \"title\": \"Before: hands-occupied\",\n                  \"value\": \"Audio-first UI\",\n                  \"icon\": \"volume\",\n                  \"tone\": \"neutral\",\n                  \"items\": [\n                    \"Primary modality: Spoken prompts guide the resident through lighting scene adjustments.\",\n                    \"Screen shows a simplified, glanceable view (current scene name and room) with minimal touch targets.\",\n                    \"Spoken options like “Say ‘Next scene’ or ‘Dim the lights to 50%’ to continue.”\",\n                    \"No reliance on precise touch interaction; UI is safe to ignore visually while hands are busy.\"\n                  ],\n                  \"layout\": \"half-width\"\n                }\n              },\n              {\n                \"type\": \"statusCard\",\n                \"props\": {\n                  \"title\": \"After: hands-free\",\n                  \"value\": \"Tactile-first UI\",\n                  \"icon\": \"touch\",\n                  \"tone\": \"positive\",\n                  \"items\": [\n                    \"Transition behavior: A brief spoken confirmation such as “I’ve switched to touch controls; you can now tap to change scenes.”\",\n                    \"Visual expansion: The tablet reveals a richer layout for lighting scenes (scene cards, brightness and warmth controls) while keeping the current scene clearly highlighted.\",\n                    \"Audio shifts to a supporting role: spoken guidance becomes shorter and less frequent, focusing on confirmations rather than step-by-step instructions.\",\n                    \"Touch-friendly layout: controls are spaced and sized for comfortable interaction on the tablet in cozy-desktop use (standard ergonomics).\"\n                  ],\n                  \"layout\": \"half-width\"\n                }\n              }\n            ]\n          }\n        },\n        {\n          \"type\": \"statusCard\",\n          \"props\": {\n            \"title\": \"Mid-task continuity\",\n            \"value\": \"No reset, just modality shift\",\n            \"icon\": \"sync\",\n            \"tone\": \"neutral\",\n            \"items\": [\n              \"The current lighting scene selection and pending adjustments remain intact; the UI does not reset the task when the state flips.\",\n              \"The newly shown tactile layout picks up at the same point in the flow (e.g., same room, same scene list position, same brightness level).\",\n              \"If the resident was mid-command (e.g., saying “make it warmer”), the system completes or gracefully cancels that specific audio interaction, then presents equivalent on-screen warmth controls.\",\n              \"Visual feedback reiterates state: labels such as “Hands-free mode: touch controls available” are shown briefly, then fade to avoid clutter.\"\n            ],\n            \"layout\": \"full-width\"\n          }\n        },\n        {\n          \"type\": \"statusCard\",\n          \"props\": {\n            \"title\": \"Accessibility & safety considerations\",\n            \"value\": \"Adaptive, not abrupt\",\n            \"icon\": \"shield\",\n            \"tone\": \"informational\",\n            \"items\": [\n              \"Transitions between audio-first and touch-first are smooth, with brief overlapping guidance instead of sudden modality switches.\",\n              \"Critical information (which room, which scene is active) remains visible and is also announced once when the modality changes.\",\n              \"If hands become occupied again later, the UI can reverse the pattern: dim detailed controls, enlarge key status text, and shift back to audio-first prompts.\",\n              \"All interactive behavior here is conceptual; this evaluation UI describes the adaptation rather than invoking actual actions.\"\n            ],\n            \"layout\": \"full-width\"\n          }\n        },\n        {\n          \"type\": \"text\",\n          \"props\": {\n            \"text\": \"Note: No executable lighting actions are currently registered. This screen is an explanatory, read-only description of how the tablet UI should adapt as the activity recognizer changes from hands-occupied to hands-free during lighting scene adjustments.\",\n            \"variant\": \"body\",\n            \"size\": \"small\",\n            \"layout\": \"full-width\"\n          }\n        }\n      ]\n    }\n  }\n}",
      "durationMs": 34139.542875000014,
      "flaggedSignals": [],
      "rawResponse": {
        "theme": {
          "primaryColor": "#1E90FF"
        },
        "context": {
          "defaultErgonomicsProfile": "standard"
        },
        "tree": {
          "type": "container",
          "props": {
            "layout": "vertical",
            "placement": "full-width",
            "children": [
              {
                "type": "text",
                "props": {
                  "text": "Adaptive lighting scene controls",
                  "variant": "title",
                  "size": "large",
                  "layout": "full-width"
                }
              },
              {
                "type": "statusCard",
                "props": {
                  "title": "Context change detected",
                  "value": "hands-occupied → hands-free",
                  "icon": "activity",
                  "tone": "informational",
                  "items": [
                    "Task: Adjusting lighting scenes",
                    "Initial state: Hands are occupied, audio-first guidance is prioritized.",
                    "New state: Hands are free, tactile controls become primary while retaining task continuity."
                  ],
                  "layout": "full-width"
                }
              },
              {
                "type": "container",
                "props": {
                  "layout": "horizontal",
                  "placement": "full-width",
                  "children": [
                    {
                      "type": "statusCard",
                      "props": {
                        "title": "Before: hands-occupied",
                        "value": "Audio-first UI",
                        "icon": "volume",
                        "tone": "neutral",
                        "items": [
                          "Primary modality: Spoken prompts guide the resident through lighting scene adjustments.",
                          "Screen shows a simplified, glanceable view (current scene name and room) with minimal touch targets.",
                          "Spoken options like “Say ‘Next scene’ or ‘Dim the lights to 50%’ to continue.”",
                          "No reliance on precise touch interaction; UI is safe to ignore visually while hands are busy."
                        ],
                        "layout": "half-width"
                      }
                    },
                    {
                      "type": "statusCard",
                      "props": {
                        "title": "After: hands-free",
                        "value": "Tactile-first UI",
                        "icon": "touch",
                        "tone": "positive",
                        "items": [
                          "Transition behavior: A brief spoken confirmation such as “I’ve switched to touch controls; you can now tap to change scenes.”",
                          "Visual expansion: The tablet reveals a richer layout for lighting scenes (scene cards, brightness and warmth controls) while keeping the current scene clearly highlighted.",
                          "Audio shifts to a supporting role: spoken guidance becomes shorter and less frequent, focusing on confirmations rather than step-by-step instructions.",
                          "Touch-friendly layout: controls are spaced and sized for comfortable interaction on the tablet in cozy-desktop use (standard ergonomics)."
                        ],
                        "layout": "half-width"
                      }
                    }
                  ]
                }
              },
              {
                "type": "statusCard",
                "props": {
                  "title": "Mid-task continuity",
                  "value": "No reset, just modality shift",
                  "icon": "sync",
                  "tone": "neutral",
                  "items": [
                    "The current lighting scene selection and pending adjustments remain intact; the UI does not reset the task when the state flips.",
                    "The newly shown tactile layout picks up at the same point in the flow (e.g., same room, same scene list position, same brightness level).",
                    "If the resident was mid-command (e.g., saying “make it warmer”), the system completes or gracefully cancels that specific audio interaction, then presents equivalent on-screen warmth controls.",
                    "Visual feedback reiterates state: labels such as “Hands-free mode: touch controls available” are shown briefly, then fade to avoid clutter."
                  ],
                  "layout": "full-width"
                }
              },
              {
                "type": "statusCard",
                "props": {
                  "title": "Accessibility & safety considerations",
                  "value": "Adaptive, not abrupt",
                  "icon": "shield",
                  "tone": "informational",
                  "items": [
                    "Transitions between audio-first and touch-first are smooth, with brief overlapping guidance instead of sudden modality switches.",
                    "Critical information (which room, which scene is active) remains visible and is also announced once when the modality changes.",
                    "If hands become occupied again later, the UI can reverse the pattern: dim detailed controls, enlarge key status text, and shift back to audio-first prompts.",
                    "All interactive behavior here is conceptual; this evaluation UI describes the adaptation rather than invoking actual actions."
                  ],
                  "layout": "full-width"
                }
              },
              {
                "type": "text",
                "props": {
                  "text": "Note: No executable lighting actions are currently registered. This screen is an explanatory, read-only description of how the tablet UI should adapt as the activity recognizer changes from hands-occupied to hands-free during lighting scene adjustments.",
                  "variant": "body",
                  "size": "small",
                  "layout": "full-width"
                }
              }
            ]
          }
        }
      },
      "llmMeta": {
        "provider": "openrouter",
        "model": "openai/gpt-5.1",
        "durationMs": 34111,
        "usage": {
          "prompt_tokens": 802,
          "completion_tokens": 2121,
          "total_tokens": 2923,
          "cost": 0.0222125,
          "is_byok": false,
          "prompt_tokens_details": {
            "cached_tokens": 0,
            "audio_tokens": 0,
            "video_tokens": 0
          },
          "cost_details": {
            "upstream_inference_cost": null,
            "upstream_inference_prompt_cost": 0.0010025,
            "upstream_inference_completions_cost": 0.02121
          },
          "completion_tokens_details": {
            "reasoning_tokens": 1043,
            "image_tokens": 0
          }
        },
        "timestamp": "2025-12-10T16:02:37.721Z"
      },
      "kbPayload": {
        "prompt": "The activity recognizer flips from \"hands-occupied\" to \"hands-free\" mid-task while the resident is adjusting lighting scenes. Describe how the UI should adapt.",
        "schema": {
          "name": "tablet-dashboard-ui",
          "description": "Schema for the large-format tablet/laptop renderer. Supports explicit layout hints so the KB can describe a multi-column dashboard.",
          "components": {
            "text": {
              "props": {
                "text": "string",
                "variant": "string",
                "size": "string",
                "layout": "layoutInstruction"
              }
            },
            "button": {
              "props": {
                "label": "string",
                "style": "string",
                "size": "string",
                "layout": "layoutInstruction",
                "action": "object"
              }
            },
            "toggle": {
              "props": {
                "label": "string",
                "checked": "boolean",
                "size": "string",
                "layout": "layoutInstruction",
                "action": "object"
              }
            },
            "slider": {
              "props": {
                "label": "string",
                "min": "number",
                "max": "number",
                "step": "number",
                "value": "number",
                "unit": "string",
                "size": "string",
                "layout": "layoutInstruction",
                "action": "object"
              }
            },
            "dropdown": {
              "props": {
                "label": "string",
                "placeholder": "string",
                "options": "array",
                "value": "string",
                "size": "string",
                "layout": "layoutInstruction",
                "action": "object"
              }
            },
            "statusCard": {
              "props": {
                "title": "string",
                "value": "string",
                "icon": "string",
                "tone": "string",
                "items": "array",
                "layout": "layoutInstruction"
              }
            },
            "container": {
              "props": {
                "children": "array",
                "layout": "string",
                "placement": "layoutInstruction"
              }
            }
          },
          "theming": {
            "description": "Supports `theme.primaryColor` and `theme.surfaceTint` for accent styling across cards and controls.",
            "supportsPrimaryColor": true,
            "defaultPrimaryColor": "#2563eb"
          },
          "context": {
            "modalityPreference": "visual-large-format",
            "defaultErgonomicsProfile": "cozy-desktop",
            "supportedErgonomicsProfiles": [
              {
                "id": "cozy-desktop",
                "label": "Cozy desktop",
                "description": "Comfortable spacing for seated interaction on tablets or laptops."
              },
              {
                "id": "information-dense",
                "label": "Information dense",
                "description": "Tighter spacing for dashboards that prioritize data density."
              }
            ]
          },
          "responseSchema": {
            "$schema": "http://json-schema.org/draft-07/schema#",
            "title": "Tablet/Laptop UI Schema",
            "type": "object",
            "additionalProperties": false,
            "properties": {
              "deviceId": {
                "type": "string",
                "description": "Identifier of the target tablet device that should render this UI definition."
              },
              "generatedAt": {
                "type": "string",
                "format": "date-time",
                "description": "Timestamp indicating when the UI was generated."
              },
              "context": {
                "type": "object",
                "description": "Arbitrary context metadata (thing references, device info, etc.).",
                "additionalProperties": true
              },
              "theme": {
                "type": "object",
                "properties": {
                  "primaryColor": {
                    "type": "string",
                    "pattern": "^#([0-9a-fA-F]{3}|[0-9a-fA-F]{6})$",
                    "description": "Hexadecimal color value representing the preferred primary accent color."
                  },
                  "surfaceTint": {
                    "type": "string",
                    "pattern": "^#([0-9a-fA-F]{3}|[0-9a-fA-F]{6})$",
                    "description": "Optional translucent wash to apply to containers."
                  }
                },
                "additionalProperties": false
              },
              "components": {
                "type": "array",
                "minItems": 1,
                "items": {
                  "$ref": "#/definitions/component"
                }
              }
            },
            "required": [
              "components"
            ],
            "definitions": {
              "layoutInstruction": {
                "type": "object",
                "description": "Optional placement hint for the 12-column responsive grid rendered by the tablet device.",
                "additionalProperties": false,
                "properties": {
                  "region": {
                    "type": "string",
                    "description": "Named region hint such as 'hero', 'sidebar', 'controls', or 'telemetry'."
                  },
                  "column": {
                    "type": "integer",
                    "minimum": 1,
                    "maximum": 12
                  },
                  "col": {
                    "type": "integer",
                    "minimum": 1,
                    "maximum": 12
                  },
                  "colSpan": {
                    "type": "integer",
                    "minimum": 1,
                    "maximum": 12
                  },
                  "span": {
                    "type": "integer",
                    "minimum": 1,
                    "maximum": 12
                  },
                  "row": {
                    "type": "integer",
                    "minimum": 1
                  },
                  "rowSpan": {
                    "type": "integer",
                    "minimum": 1
                  },
                  "x": {
                    "type": "integer",
                    "minimum": 1,
                    "maximum": 12,
                    "description": "Alias for `column`."
                  },
                  "y": {
                    "type": "integer",
                    "minimum": 1,
                    "description": "Alias for `row`."
                  },
                  "width": {
                    "type": "integer",
                    "minimum": 1,
                    "maximum": 12,
                    "description": "Alias for `colSpan`."
                  },
                  "height": {
                    "type": "integer",
                    "minimum": 1,
                    "description": "Alias for `rowSpan`."
                  },
                  "order": {
                    "type": "integer",
                    "description": "Optional ordering hint when auto-flow is used."
                  },
                  "align": {
                    "type": "string",
                    "enum": [
                      "start",
                      "center",
                      "end",
                      "stretch"
                    ],
                    "description": "Justify-self alignment inside the grid cell."
                  },
                  "justify": {
                    "type": "string",
                    "enum": [
                      "start",
                      "center",
                      "end",
                      "stretch"
                    ],
                    "description": "Align-self hint inside the grid cell."
                  },
                  "minHeight": {
                    "type": "string",
                    "description": "CSS size for minimum height (e.g., '180px')."
                  },
                  "maxHeight": {
                    "type": "string",
                    "description": "CSS size for maximum height."
                  },
                  "layer": {
                    "type": "string",
                    "enum": [
                      "base",
                      "overlay"
                    ],
                    "description": "Whether the element should float as an overlay card."
                  }
                }
              },
              "component": {
                "oneOf": [
                  {
                    "$ref": "#/definitions/containerComponent"
                  },
                  {
                    "$ref": "#/definitions/textComponent"
                  },
                  {
                    "$ref": "#/definitions/buttonComponent"
                  },
                  {
                    "$ref": "#/definitions/toggleComponent"
                  },
                  {
                    "$ref": "#/definitions/sliderComponent"
                  },
                  {
                    "$ref": "#/definitions/dropdownComponent"
                  },
                  {
                    "$ref": "#/definitions/statusCardComponent"
                  },
                  {
                    "$ref": "#/definitions/toolCall"
                  }
                ]
              },
              "containerComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "container"
                  },
                  "title": {
                    "type": "string"
                  },
                  "layout": {
                    "description": "Layout strategy for child composition (grid, row, column).",
                    "oneOf": [
                      {
                        "type": "string"
                      },
                      {
                        "$ref": "#/definitions/layoutInstruction"
                      }
                    ]
                  },
                  "placement": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Optional thing identifier that all nested children primarily control."
                  },
                  "children": {
                    "type": "array",
                    "minItems": 1,
                    "items": {
                      "$ref": "#/definitions/component"
                    }
                  }
                },
                "required": [
                  "type",
                  "children"
                ]
              },
              "textComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "text"
                  },
                  "text": {
                    "type": "string"
                  },
                  "variant": {
                    "type": "string"
                  },
                  "size": {
                    "type": "string"
                  },
                  "tone": {
                    "type": "string"
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Optional thing identifier this text references when showing state or instructions."
                  }
                },
                "required": [
                  "type",
                  "text"
                ]
              },
              "buttonComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "button"
                  },
                  "label": {
                    "type": "string"
                  },
                  "icon": {
                    "type": "string"
                  },
                  "style": {
                    "type": "string"
                  },
                  "size": {
                    "type": "string"
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Thing identifier to target when executing the bound action."
                  },
                  "action": {
                    "description": "Action payload or identifier to execute when the button is pressed.",
                    "oneOf": [
                      {
                        "type": "string"
                      },
                      {
                        "type": "object",
                        "additionalProperties": true
                      }
                    ]
                  }
                },
                "required": [
                  "type",
                  "label"
                ]
              },
              "toggleComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "toggle"
                  },
                  "label": {
                    "type": "string"
                  },
                  "checked": {
                    "type": "boolean"
                  },
                  "size": {
                    "type": "string"
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Thing identifier to target when toggling."
                  },
                  "action": {
                    "oneOf": [
                      {
                        "type": "string"
                      },
                      {
                        "type": "object",
                        "additionalProperties": true
                      }
                    ]
                  }
                },
                "required": [
                  "type",
                  "label"
                ]
              },
              "sliderComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "slider"
                  },
                  "label": {
                    "type": "string"
                  },
                  "min": {
                    "type": "number",
                    "default": 0
                  },
                  "max": {
                    "type": "number",
                    "default": 100
                  },
                  "step": {
                    "type": "number",
                    "default": 1
                  },
                  "value": {
                    "type": "number"
                  },
                  "unit": {
                    "type": "string"
                  },
                  "size": {
                    "type": "string"
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Thing identifier to target when sending slider updates."
                  },
                  "action": {
                    "oneOf": [
                      {
                        "type": "string"
                      },
                      {
                        "type": "object",
                        "additionalProperties": true
                      }
                    ]
                  }
                },
                "required": [
                  "type",
                  "label"
                ]
              },
              "dropdownComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "dropdown"
                  },
                  "label": {
                    "type": "string"
                  },
                  "placeholder": {
                    "type": "string"
                  },
                  "value": {
                    "type": "string"
                  },
                  "size": {
                    "type": "string"
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Thing identifier to target when selection changes."
                  },
                  "options": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "label": {
                          "type": "string"
                        },
                        "value": {
                          "type": "string"
                        }
                      },
                      "required": [
                        "label",
                        "value"
                      ],
                      "additionalProperties": false
                    }
                  },
                  "action": {
                    "oneOf": [
                      {
                        "type": "string"
                      },
                      {
                        "type": "object",
                        "additionalProperties": true
                      }
                    ]
                  }
                },
                "required": [
                  "type",
                  "label",
                  "options"
                ]
              },
              "statusCardComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "statusCard"
                  },
                  "title": {
                    "type": "string"
                  },
                  "value": {
                    "type": "string"
                  },
                  "icon": {
                    "type": "string"
                  },
                  "tone": {
                    "type": "string"
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Thing identifier whose state this card summarizes."
                  },
                  "items": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "label": {
                          "type": "string"
                        },
                        "value": {
                          "type": "string"
                        }
                      },
                      "required": [
                        "label",
                        "value"
                      ],
                      "additionalProperties": false
                    }
                  }
                },
                "required": [
                  "type",
                  "title"
                ]
              },
              "toolCall": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "toolCall"
                  },
                  "tool": {
                    "type": "string"
                  },
                  "parameters": {
                    "type": "object",
                    "additionalProperties": true
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Thing identifier providing context for the tool output."
                  }
                },
                "required": [
                  "type",
                  "tool"
                ]
              }
            }
          }
        },
        "capabilityData": {
          "initialState": "hands-occupied",
          "newState": "hands-free",
          "task": "lighting scenes"
        },
        "uiContext": {
          "scenarioId": "state-transition-guidance",
          "tags": [
            "modality",
            "state-change",
            "fallthrough"
          ],
          "inputs": {
            "initialState": "hands-occupied",
            "newState": "hands-free",
            "task": "lighting scenes"
          }
        },
        "deviceId": "device-tablet-eval",
        "device": {
          "id": "device-tablet-eval",
          "deviceId": "device-tablet-eval",
          "label": "Evaluation Tablet",
          "type": "tablet",
          "ergonomicsProfile": "cozy-desktop"
        }
      }
    },
    {
      "scenarioId": "audit-checklist",
      "name": "KB compliance audit",
      "mode": "kb",
      "prompt": "You are a UI planning assistant for a tablet experience. Use the provided requirement documents to craft a response that explains what the tablet should render or say. Always cite the relevant document ids in parentheses when referencing a guideline.\n\nDocument modality-guideline-hands-occupied (source: safety-guidelines):\nWhen the user activity sensor reports the state \"hands-occupied\", prefer audio-first guidance. Provide spoken prompts and minimize the need for direct touch input. When the sensor reports \"hands-free\", present tactile controls such as buttons or toggles for the light switch.\n\nDocument user-preference-primary-color (source: user-profile):\nThe primary household preference for interface accents is the color \"#1E90FF\" (a blue). Whenever possible, set the UI theme primary color to this value so buttons, toggles, and other interactive highlights align with the user preference. Ensure sufficient contrast by using light text on dark backgrounds.\n\nScenario prompt: Produce a checklist the QA team can use to verify that a generated tablet layout respects both the modality guideline and the accent preference.\n\nContext inputs:\n{\n  \"artifact\": \"tablet layout spec\",\n  \"checks\": [\n    \"modality\",\n    \"theme\"\n  ]\n}\n\nRequired behaviors:\n- List at least three modality checks (hands-occupied audio, hands-free tactile, transitions)\n- List at least two theme checks (accent equals #808080, light text over accent)\n- Tie every checklist item to the relevant document id\n\nAvoid the following failure modes:\n- Checklist omits either modality or theme\n- No references back to KB documents\n\nRespond with two sections: (1) \"Plan\" — short paragraphs describing the approach, (2) \"Checks\" — bullet list referencing document ids.",
      "answer": "{\n  \"theme\": {\n    \"primaryColor\": \"#1E90FF\",\n    \"contrastMode\": \"high\"\n  },\n  \"context\": {\n    \"deviceId\": \"device-tablet-eval\",\n    \"defaultErgonomicsProfile\": \"standard\"\n  },\n  \"components\": [\n    {\n      \"type\": \"container\",\n      \"props\": {\n        \"layout\": \"column\",\n        \"placement\": \"main\",\n        \"children\": [\n          {\n            \"type\": \"text\",\n            \"props\": {\n              \"text\": \"Tablet Layout QA Checklist\",\n              \"variant\": \"title\",\n              \"size\": \"large\",\n              \"layout\": \"full-width\"\n            }\n          },\n          {\n            \"type\": \"text\",\n            \"props\": {\n              \"text\": \"Use this checklist to verify that any generated tablet layout respects both the modality guideline and the household accent color preference.\",\n              \"variant\": \"body\",\n              \"size\": \"medium\",\n              \"layout\": \"full-width\"\n            }\n          },\n          {\n            \"type\": \"statusCard\",\n            \"props\": {\n              \"title\": \"Modality Compliance\",\n              \"value\": \"Required checks for hands-occupied vs. hands-free usage\",\n              \"icon\": \"modality\",\n              \"tone\": \"info\",\n              \"items\": [\n                \"Confirm that the layout explicitly targets a modality state, or that behavior is defined for both “hands-occupied” and “hands-free” scenarios.\",\n                \"For **hands-occupied** states, verify that:\\n  • The primary guidance is audio-first (spoken prompts, clear cues).\\n  • Critical instructions are understandable without requiring precise touch input.\\n  • Any on-screen controls are minimized and non-essential to core operation.\",\n                \"For **hands-free** states, verify that:\\n  • Tactile controls (buttons, toggles, sliders) are present where user interaction is expected.\\n  • Controls are reasonably sized for tablet use (touch-friendly but not excessively large, since ergonomics are standard).\\n  • Labels and states of controls are clearly visible and unambiguous.\",\n                \"Check that the layout does not assume touch interaction in hands-occupied contexts for essential actions (e.g., no mandatory on-screen confirmation if audio is expected).\",\n                \"Verify that any modality-specific messaging (e.g., “You can say ‘Turn on the lights’”) matches the actual interaction capabilities for that state.\",\n                \"Ensure that when the modality changes (hands-occupied ↔ hands-free), the design specification explains how the presentation should adapt (e.g., show/hide touch controls, emphasize/de-emphasize audio prompts).\"\n              ],\n              \"layout\": \"full-width\"\n            }\n          },\n          {\n            \"type\": \"statusCard\",\n            \"props\": {\n              \"title\": \"Theme & Accent Color Compliance\",\n              \"value\": \"Required checks for the #1E90FF accent preference\",\n              \"icon\": \"palette\",\n              \"tone\": \"info\",\n              \"items\": [\n                \"Confirm that `theme.primaryColor` is set to **#1E90FF** in the layout or theme specification.\",\n                \"Verify that primary interactive accents (e.g., button highlights, toggle tracks, focus rings, selection states) consistently use **#1E90FF** and do not introduce competing accent colors without justification.\",\n                \"Check contrast for any element where #1E90FF is used as a **background**:\\n  • Text and icons on top of #1E90FF should be light (e.g., white or very light gray).\\n  • The combination should be readable under typical tablet viewing conditions.\",\n                \"Check contrast where #1E90FF is used as a **foreground** (text, icons, outlines):\\n  • It should appear on a sufficiently dark or neutral background to remain legible.\\n  • Avoid placing #1E90FF text on very light or saturated backgrounds.\",\n                \"Ensure that disabled states, error states, and warning states remain visually distinct from the primary accent (e.g., do not use #1E90FF to indicate errors).\",\n                \"Confirm that the accent usage is consistent across the tablet’s orientations (portrait and landscape) and across all major screens and dialogs in the layout spec.\",\n                \"Verify that the use of #1E90FF respects accessibility guidelines (e.g., minimum contrast ratios) for body text and essential UI indicators where applicable.\"\n              ],\n              \"layout\": \"full-width\"\n            }\n          },\n          {\n            \"type\": \"text\",\n            \"props\": {\n              \"text\": \"Outcome: Mark the layout as compliant only if all modality and theme checks above pass for the intended tablet usage scenarios.\",\n              \"variant\": \"body\",\n              \"size\": \"medium\",\n              \"layout\": \"full-width\"\n            }\n          }\n        ]\n      }\n    }\n  ]\n}",
      "durationMs": 34480.404750000016,
      "flaggedSignals": [],
      "rawResponse": {
        "theme": {
          "primaryColor": "#1E90FF",
          "contrastMode": "high"
        },
        "context": {
          "deviceId": "device-tablet-eval",
          "defaultErgonomicsProfile": "standard"
        },
        "components": [
          {
            "type": "container",
            "props": {
              "layout": "column",
              "placement": "main",
              "children": [
                {
                  "type": "text",
                  "props": {
                    "text": "Tablet Layout QA Checklist",
                    "variant": "title",
                    "size": "large",
                    "layout": "full-width"
                  }
                },
                {
                  "type": "text",
                  "props": {
                    "text": "Use this checklist to verify that any generated tablet layout respects both the modality guideline and the household accent color preference.",
                    "variant": "body",
                    "size": "medium",
                    "layout": "full-width"
                  }
                },
                {
                  "type": "statusCard",
                  "props": {
                    "title": "Modality Compliance",
                    "value": "Required checks for hands-occupied vs. hands-free usage",
                    "icon": "modality",
                    "tone": "info",
                    "items": [
                      "Confirm that the layout explicitly targets a modality state, or that behavior is defined for both “hands-occupied” and “hands-free” scenarios.",
                      "For **hands-occupied** states, verify that:\n  • The primary guidance is audio-first (spoken prompts, clear cues).\n  • Critical instructions are understandable without requiring precise touch input.\n  • Any on-screen controls are minimized and non-essential to core operation.",
                      "For **hands-free** states, verify that:\n  • Tactile controls (buttons, toggles, sliders) are present where user interaction is expected.\n  • Controls are reasonably sized for tablet use (touch-friendly but not excessively large, since ergonomics are standard).\n  • Labels and states of controls are clearly visible and unambiguous.",
                      "Check that the layout does not assume touch interaction in hands-occupied contexts for essential actions (e.g., no mandatory on-screen confirmation if audio is expected).",
                      "Verify that any modality-specific messaging (e.g., “You can say ‘Turn on the lights’”) matches the actual interaction capabilities for that state.",
                      "Ensure that when the modality changes (hands-occupied ↔ hands-free), the design specification explains how the presentation should adapt (e.g., show/hide touch controls, emphasize/de-emphasize audio prompts)."
                    ],
                    "layout": "full-width"
                  }
                },
                {
                  "type": "statusCard",
                  "props": {
                    "title": "Theme & Accent Color Compliance",
                    "value": "Required checks for the #1E90FF accent preference",
                    "icon": "palette",
                    "tone": "info",
                    "items": [
                      "Confirm that `theme.primaryColor` is set to **#1E90FF** in the layout or theme specification.",
                      "Verify that primary interactive accents (e.g., button highlights, toggle tracks, focus rings, selection states) consistently use **#1E90FF** and do not introduce competing accent colors without justification.",
                      "Check contrast for any element where #1E90FF is used as a **background**:\n  • Text and icons on top of #1E90FF should be light (e.g., white or very light gray).\n  • The combination should be readable under typical tablet viewing conditions.",
                      "Check contrast where #1E90FF is used as a **foreground** (text, icons, outlines):\n  • It should appear on a sufficiently dark or neutral background to remain legible.\n  • Avoid placing #1E90FF text on very light or saturated backgrounds.",
                      "Ensure that disabled states, error states, and warning states remain visually distinct from the primary accent (e.g., do not use #1E90FF to indicate errors).",
                      "Confirm that the accent usage is consistent across the tablet’s orientations (portrait and landscape) and across all major screens and dialogs in the layout spec.",
                      "Verify that the use of #1E90FF respects accessibility guidelines (e.g., minimum contrast ratios) for body text and essential UI indicators where applicable."
                    ],
                    "layout": "full-width"
                  }
                },
                {
                  "type": "text",
                  "props": {
                    "text": "Outcome: Mark the layout as compliant only if all modality and theme checks above pass for the intended tablet usage scenarios.",
                    "variant": "body",
                    "size": "medium",
                    "layout": "full-width"
                  }
                }
              ]
            }
          }
        ]
      },
      "llmMeta": {
        "provider": "openrouter",
        "model": "openai/gpt-5.1",
        "durationMs": 34463,
        "usage": {
          "prompt_tokens": 792,
          "completion_tokens": 1848,
          "total_tokens": 2640,
          "cost": 0.01947,
          "is_byok": false,
          "prompt_tokens_details": {
            "cached_tokens": 0,
            "audio_tokens": 0,
            "video_tokens": 0
          },
          "cost_details": {
            "upstream_inference_cost": null,
            "upstream_inference_prompt_cost": 0.00099,
            "upstream_inference_completions_cost": 0.01848
          },
          "completion_tokens_details": {
            "reasoning_tokens": 834,
            "image_tokens": 0
          }
        },
        "timestamp": "2025-12-10T16:03:12.203Z"
      },
      "kbPayload": {
        "prompt": "Produce a checklist the QA team can use to verify that a generated tablet layout respects both the modality guideline and the accent preference.",
        "schema": {
          "name": "tablet-dashboard-ui",
          "description": "Schema for the large-format tablet/laptop renderer. Supports explicit layout hints so the KB can describe a multi-column dashboard.",
          "components": {
            "text": {
              "props": {
                "text": "string",
                "variant": "string",
                "size": "string",
                "layout": "layoutInstruction"
              }
            },
            "button": {
              "props": {
                "label": "string",
                "style": "string",
                "size": "string",
                "layout": "layoutInstruction",
                "action": "object"
              }
            },
            "toggle": {
              "props": {
                "label": "string",
                "checked": "boolean",
                "size": "string",
                "layout": "layoutInstruction",
                "action": "object"
              }
            },
            "slider": {
              "props": {
                "label": "string",
                "min": "number",
                "max": "number",
                "step": "number",
                "value": "number",
                "unit": "string",
                "size": "string",
                "layout": "layoutInstruction",
                "action": "object"
              }
            },
            "dropdown": {
              "props": {
                "label": "string",
                "placeholder": "string",
                "options": "array",
                "value": "string",
                "size": "string",
                "layout": "layoutInstruction",
                "action": "object"
              }
            },
            "statusCard": {
              "props": {
                "title": "string",
                "value": "string",
                "icon": "string",
                "tone": "string",
                "items": "array",
                "layout": "layoutInstruction"
              }
            },
            "container": {
              "props": {
                "children": "array",
                "layout": "string",
                "placement": "layoutInstruction"
              }
            }
          },
          "theming": {
            "description": "Supports `theme.primaryColor` and `theme.surfaceTint` for accent styling across cards and controls.",
            "supportsPrimaryColor": true,
            "defaultPrimaryColor": "#2563eb"
          },
          "context": {
            "modalityPreference": "visual-large-format",
            "defaultErgonomicsProfile": "cozy-desktop",
            "supportedErgonomicsProfiles": [
              {
                "id": "cozy-desktop",
                "label": "Cozy desktop",
                "description": "Comfortable spacing for seated interaction on tablets or laptops."
              },
              {
                "id": "information-dense",
                "label": "Information dense",
                "description": "Tighter spacing for dashboards that prioritize data density."
              }
            ]
          },
          "responseSchema": {
            "$schema": "http://json-schema.org/draft-07/schema#",
            "title": "Tablet/Laptop UI Schema",
            "type": "object",
            "additionalProperties": false,
            "properties": {
              "deviceId": {
                "type": "string",
                "description": "Identifier of the target tablet device that should render this UI definition."
              },
              "generatedAt": {
                "type": "string",
                "format": "date-time",
                "description": "Timestamp indicating when the UI was generated."
              },
              "context": {
                "type": "object",
                "description": "Arbitrary context metadata (thing references, device info, etc.).",
                "additionalProperties": true
              },
              "theme": {
                "type": "object",
                "properties": {
                  "primaryColor": {
                    "type": "string",
                    "pattern": "^#([0-9a-fA-F]{3}|[0-9a-fA-F]{6})$",
                    "description": "Hexadecimal color value representing the preferred primary accent color."
                  },
                  "surfaceTint": {
                    "type": "string",
                    "pattern": "^#([0-9a-fA-F]{3}|[0-9a-fA-F]{6})$",
                    "description": "Optional translucent wash to apply to containers."
                  }
                },
                "additionalProperties": false
              },
              "components": {
                "type": "array",
                "minItems": 1,
                "items": {
                  "$ref": "#/definitions/component"
                }
              }
            },
            "required": [
              "components"
            ],
            "definitions": {
              "layoutInstruction": {
                "type": "object",
                "description": "Optional placement hint for the 12-column responsive grid rendered by the tablet device.",
                "additionalProperties": false,
                "properties": {
                  "region": {
                    "type": "string",
                    "description": "Named region hint such as 'hero', 'sidebar', 'controls', or 'telemetry'."
                  },
                  "column": {
                    "type": "integer",
                    "minimum": 1,
                    "maximum": 12
                  },
                  "col": {
                    "type": "integer",
                    "minimum": 1,
                    "maximum": 12
                  },
                  "colSpan": {
                    "type": "integer",
                    "minimum": 1,
                    "maximum": 12
                  },
                  "span": {
                    "type": "integer",
                    "minimum": 1,
                    "maximum": 12
                  },
                  "row": {
                    "type": "integer",
                    "minimum": 1
                  },
                  "rowSpan": {
                    "type": "integer",
                    "minimum": 1
                  },
                  "x": {
                    "type": "integer",
                    "minimum": 1,
                    "maximum": 12,
                    "description": "Alias for `column`."
                  },
                  "y": {
                    "type": "integer",
                    "minimum": 1,
                    "description": "Alias for `row`."
                  },
                  "width": {
                    "type": "integer",
                    "minimum": 1,
                    "maximum": 12,
                    "description": "Alias for `colSpan`."
                  },
                  "height": {
                    "type": "integer",
                    "minimum": 1,
                    "description": "Alias for `rowSpan`."
                  },
                  "order": {
                    "type": "integer",
                    "description": "Optional ordering hint when auto-flow is used."
                  },
                  "align": {
                    "type": "string",
                    "enum": [
                      "start",
                      "center",
                      "end",
                      "stretch"
                    ],
                    "description": "Justify-self alignment inside the grid cell."
                  },
                  "justify": {
                    "type": "string",
                    "enum": [
                      "start",
                      "center",
                      "end",
                      "stretch"
                    ],
                    "description": "Align-self hint inside the grid cell."
                  },
                  "minHeight": {
                    "type": "string",
                    "description": "CSS size for minimum height (e.g., '180px')."
                  },
                  "maxHeight": {
                    "type": "string",
                    "description": "CSS size for maximum height."
                  },
                  "layer": {
                    "type": "string",
                    "enum": [
                      "base",
                      "overlay"
                    ],
                    "description": "Whether the element should float as an overlay card."
                  }
                }
              },
              "component": {
                "oneOf": [
                  {
                    "$ref": "#/definitions/containerComponent"
                  },
                  {
                    "$ref": "#/definitions/textComponent"
                  },
                  {
                    "$ref": "#/definitions/buttonComponent"
                  },
                  {
                    "$ref": "#/definitions/toggleComponent"
                  },
                  {
                    "$ref": "#/definitions/sliderComponent"
                  },
                  {
                    "$ref": "#/definitions/dropdownComponent"
                  },
                  {
                    "$ref": "#/definitions/statusCardComponent"
                  },
                  {
                    "$ref": "#/definitions/toolCall"
                  }
                ]
              },
              "containerComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "container"
                  },
                  "title": {
                    "type": "string"
                  },
                  "layout": {
                    "description": "Layout strategy for child composition (grid, row, column).",
                    "oneOf": [
                      {
                        "type": "string"
                      },
                      {
                        "$ref": "#/definitions/layoutInstruction"
                      }
                    ]
                  },
                  "placement": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Optional thing identifier that all nested children primarily control."
                  },
                  "children": {
                    "type": "array",
                    "minItems": 1,
                    "items": {
                      "$ref": "#/definitions/component"
                    }
                  }
                },
                "required": [
                  "type",
                  "children"
                ]
              },
              "textComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "text"
                  },
                  "text": {
                    "type": "string"
                  },
                  "variant": {
                    "type": "string"
                  },
                  "size": {
                    "type": "string"
                  },
                  "tone": {
                    "type": "string"
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Optional thing identifier this text references when showing state or instructions."
                  }
                },
                "required": [
                  "type",
                  "text"
                ]
              },
              "buttonComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "button"
                  },
                  "label": {
                    "type": "string"
                  },
                  "icon": {
                    "type": "string"
                  },
                  "style": {
                    "type": "string"
                  },
                  "size": {
                    "type": "string"
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Thing identifier to target when executing the bound action."
                  },
                  "action": {
                    "description": "Action payload or identifier to execute when the button is pressed.",
                    "oneOf": [
                      {
                        "type": "string"
                      },
                      {
                        "type": "object",
                        "additionalProperties": true
                      }
                    ]
                  }
                },
                "required": [
                  "type",
                  "label"
                ]
              },
              "toggleComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "toggle"
                  },
                  "label": {
                    "type": "string"
                  },
                  "checked": {
                    "type": "boolean"
                  },
                  "size": {
                    "type": "string"
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Thing identifier to target when toggling."
                  },
                  "action": {
                    "oneOf": [
                      {
                        "type": "string"
                      },
                      {
                        "type": "object",
                        "additionalProperties": true
                      }
                    ]
                  }
                },
                "required": [
                  "type",
                  "label"
                ]
              },
              "sliderComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "slider"
                  },
                  "label": {
                    "type": "string"
                  },
                  "min": {
                    "type": "number",
                    "default": 0
                  },
                  "max": {
                    "type": "number",
                    "default": 100
                  },
                  "step": {
                    "type": "number",
                    "default": 1
                  },
                  "value": {
                    "type": "number"
                  },
                  "unit": {
                    "type": "string"
                  },
                  "size": {
                    "type": "string"
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Thing identifier to target when sending slider updates."
                  },
                  "action": {
                    "oneOf": [
                      {
                        "type": "string"
                      },
                      {
                        "type": "object",
                        "additionalProperties": true
                      }
                    ]
                  }
                },
                "required": [
                  "type",
                  "label"
                ]
              },
              "dropdownComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "dropdown"
                  },
                  "label": {
                    "type": "string"
                  },
                  "placeholder": {
                    "type": "string"
                  },
                  "value": {
                    "type": "string"
                  },
                  "size": {
                    "type": "string"
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Thing identifier to target when selection changes."
                  },
                  "options": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "label": {
                          "type": "string"
                        },
                        "value": {
                          "type": "string"
                        }
                      },
                      "required": [
                        "label",
                        "value"
                      ],
                      "additionalProperties": false
                    }
                  },
                  "action": {
                    "oneOf": [
                      {
                        "type": "string"
                      },
                      {
                        "type": "object",
                        "additionalProperties": true
                      }
                    ]
                  }
                },
                "required": [
                  "type",
                  "label",
                  "options"
                ]
              },
              "statusCardComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "statusCard"
                  },
                  "title": {
                    "type": "string"
                  },
                  "value": {
                    "type": "string"
                  },
                  "icon": {
                    "type": "string"
                  },
                  "tone": {
                    "type": "string"
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Thing identifier whose state this card summarizes."
                  },
                  "items": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "label": {
                          "type": "string"
                        },
                        "value": {
                          "type": "string"
                        }
                      },
                      "required": [
                        "label",
                        "value"
                      ],
                      "additionalProperties": false
                    }
                  }
                },
                "required": [
                  "type",
                  "title"
                ]
              },
              "toolCall": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "toolCall"
                  },
                  "tool": {
                    "type": "string"
                  },
                  "parameters": {
                    "type": "object",
                    "additionalProperties": true
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Thing identifier providing context for the tool output."
                  }
                },
                "required": [
                  "type",
                  "tool"
                ]
              }
            }
          }
        },
        "capabilityData": {
          "artifact": "tablet layout spec",
          "checks": [
            "modality",
            "theme"
          ]
        },
        "uiContext": {
          "scenarioId": "audit-checklist",
          "tags": [
            "audit",
            "theme",
            "modality"
          ],
          "inputs": {
            "artifact": "tablet layout spec",
            "checks": [
              "modality",
              "theme"
            ]
          }
        },
        "deviceId": "device-tablet-eval",
        "device": {
          "id": "device-tablet-eval",
          "deviceId": "device-tablet-eval",
          "label": "Evaluation Tablet",
          "type": "tablet",
          "ergonomicsProfile": "cozy-desktop"
        }
      }
    }
  ],
  "summary": {
    "mode": "kb",
    "total": 6,
    "successes": 6,
    "warnings": 0,
    "errors": 0,
    "avgDurationMs": 28241.7,
    "llmStats": {
      "calls": 6,
      "totalPromptTokens": 4784,
      "totalCompletionTokens": 10960,
      "totalTokens": 15744,
      "totalReasoningTokens": 6850,
      "avgTokensPerCall": 2624,
      "totalLlmDurationMs": 169302,
      "avgLlmDurationMs": 28217,
      "providers": {
        "openrouter": 6
      },
      "models": {
        "openai/gpt-5.1": 6
      }
    }
  }
}