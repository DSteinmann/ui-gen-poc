{
  "generatedAt": "2025-12-10T10:15:12.440Z",
  "suite": "kb-alignment",
  "version": "2025-12-09",
  "config": {
    "model": "x-ai/grok-code-fast-1",
    "endpoint": "https://openrouter.ai/api/v1/chat/completions",
    "provider": "openrouter",
    "suitePath": "/Users/dom/projects/IMP/packages/knowledge-base/eval-suite.json",
    "kbDataPath": "/Users/dom/projects/IMP/packages/knowledge-base/kb-data.json",
    "kbUrl": "http://localhost:3005",
    "schemaPath": "/Users/dom/projects/IMP/packages/tablet-device/schema.json",
    "dryRun": false,
    "mode": "kb",
    "resolvedLlmConfig": {
      "provider": "openrouter",
      "model": "x-ai/grok-code-fast-1",
      "endpoint": "https://openrouter.ai/api/v1/chat/completions",
      "fallbackModel": "gemma 3b",
      "openRouterModel": "x-ai/grok-code-fast-1",
      "allowsFallback": true,
      "timestamp": "2025-12-10T10:13:49.503Z"
    }
  },
  "results": [
    {
      "scenarioId": "hands-occupied-audio-guidance",
      "name": "Hands-occupied lighting change",
      "mode": "kb",
      "prompt": "You are a UI planning assistant for a tablet experience. Use the provided requirement documents to craft a response that explains what the tablet should render or say. Always cite the relevant document ids in parentheses when referencing a guideline.\n\nDocument modality-guideline-hands-occupied (source: safety-guidelines):\nWhen the user activity sensor reports the state \"hands-occupied\", prefer audio-first guidance. Provide spoken prompts and minimize the need for direct touch input. When the sensor reports \"hands-free\", present tactile controls such as buttons or toggles for the light switch.\n\nScenario prompt: Activity recognizer reports the state \"hands-occupied\" while the resident asks the tablet to dim the hallway sconces. Describe the UI response the device should render.\n\nContext inputs:\n{\n  \"sensorState\": \"hands-occupied\",\n  \"requestedAction\": \"dim hallway sconces\",\n  \"device\": \"tablet\"\n}\n\nRequired behaviors:\n- Prioritize spoken/audio-first prompts so the user does not need to touch the display\n- Explain the modality choice by referencing the hands-occupied state\n- Offer only minimal-touch fallbacks (single button or confirmation chip) if a tactile control is unavoidable\n\nAvoid the following failure modes:\n- Displays a new grid of touch buttons as the primary interaction\n- Omits any mention of audio guidance when the user cannot use their hands\n\nRespond with two sections: (1) \"Plan\" — short paragraphs describing the approach, (2) \"Checks\" — bullet list referencing document ids.",
      "answer": "{\n  \"deviceId\": \"device-tablet-eval\",\n  \"generatedAt\": \"2023-10-05T12:00:00Z\",\n  \"context\": {\n    \"sensorState\": \"hands-occupied\",\n    \"requestedAction\": \"dim hallway sconces\"\n  },\n  \"theme\": {\n    \"primaryColor\": \"#1E90FF\"\n  },\n  \"components\": [\n    {\n      \"type\": \"container\",\n      \"layout\": \"column\",\n      \"children\": [\n        {\n          \"type\": \"text\",\n          \"text\": \"Hallway sconces dimming initiated.\",\n          \"variant\": \"body\",\n          \"size\": \"medium\"\n        },\n        {\n          \"type\": \"toolCall\",\n          \"tool\": \"speak\",\n          \"parameters\": {\n            \"text\": \"Your hallway sconces are being dimmed. Please wait for confirmation.\"\n          }\n        }\n      ]\n    }\n  ]\n}",
      "durationMs": 12220.445208000001,
      "flaggedSignals": [],
      "rawResponse": {
        "deviceId": "device-tablet-eval",
        "generatedAt": "2023-10-05T12:00:00Z",
        "context": {
          "sensorState": "hands-occupied",
          "requestedAction": "dim hallway sconces"
        },
        "theme": {
          "primaryColor": "#1E90FF"
        },
        "components": [
          {
            "type": "container",
            "layout": "column",
            "children": [
              {
                "type": "text",
                "text": "Hallway sconces dimming initiated.",
                "variant": "body",
                "size": "medium"
              },
              {
                "type": "toolCall",
                "tool": "speak",
                "parameters": {
                  "text": "Your hallway sconces are being dimmed. Please wait for confirmation."
                }
              }
            ]
          }
        ]
      },
      "llmMeta": {
        "provider": "openrouter",
        "model": "x-ai/grok-code-fast-1",
        "durationMs": 12182,
        "usage": {
          "prompt_tokens": 2400,
          "completion_tokens": 917,
          "total_tokens": 3317,
          "cost": 0.00182094,
          "is_byok": false,
          "prompt_tokens_details": {
            "cached_tokens": 192,
            "audio_tokens": 0,
            "video_tokens": 0
          },
          "cost_details": {
            "upstream_inference_cost": null,
            "upstream_inference_prompt_cost": 0.00044544,
            "upstream_inference_completions_cost": 0.0013755
          },
          "completion_tokens_details": {
            "reasoning_tokens": 724,
            "image_tokens": 0
          }
        }
      },
      "kbPayload": {
        "prompt": "Activity recognizer reports the state \"hands-occupied\" while the resident asks the tablet to dim the hallway sconces. Describe the UI response the device should render.",
        "schema": {
          "name": "tablet-dashboard-ui",
          "description": "Schema for the large-format tablet/laptop renderer. Supports explicit layout hints so the KB can describe a multi-column dashboard.",
          "components": {
            "text": {
              "props": {
                "text": "string",
                "variant": "string",
                "size": "string",
                "layout": "layoutInstruction"
              }
            },
            "button": {
              "props": {
                "label": "string",
                "style": "string",
                "size": "string",
                "layout": "layoutInstruction",
                "action": "object"
              }
            },
            "toggle": {
              "props": {
                "label": "string",
                "checked": "boolean",
                "size": "string",
                "layout": "layoutInstruction",
                "action": "object"
              }
            },
            "slider": {
              "props": {
                "label": "string",
                "min": "number",
                "max": "number",
                "step": "number",
                "value": "number",
                "unit": "string",
                "size": "string",
                "layout": "layoutInstruction",
                "action": "object"
              }
            },
            "dropdown": {
              "props": {
                "label": "string",
                "placeholder": "string",
                "options": "array",
                "value": "string",
                "size": "string",
                "layout": "layoutInstruction",
                "action": "object"
              }
            },
            "statusCard": {
              "props": {
                "title": "string",
                "value": "string",
                "icon": "string",
                "tone": "string",
                "items": "array",
                "layout": "layoutInstruction"
              }
            },
            "container": {
              "props": {
                "children": "array",
                "layout": "string",
                "placement": "layoutInstruction"
              }
            }
          },
          "theming": {
            "description": "Supports `theme.primaryColor` and `theme.surfaceTint` for accent styling across cards and controls.",
            "supportsPrimaryColor": true,
            "defaultPrimaryColor": "#2563eb"
          },
          "context": {
            "modalityPreference": "visual-large-format",
            "defaultErgonomicsProfile": "cozy-desktop",
            "supportedErgonomicsProfiles": [
              {
                "id": "cozy-desktop",
                "label": "Cozy desktop",
                "description": "Comfortable spacing for seated interaction on tablets or laptops."
              },
              {
                "id": "information-dense",
                "label": "Information dense",
                "description": "Tighter spacing for dashboards that prioritize data density."
              }
            ]
          },
          "responseSchema": {
            "$schema": "http://json-schema.org/draft-07/schema#",
            "title": "Tablet/Laptop UI Schema",
            "type": "object",
            "additionalProperties": false,
            "properties": {
              "deviceId": {
                "type": "string",
                "description": "Identifier of the target tablet device that should render this UI definition."
              },
              "generatedAt": {
                "type": "string",
                "format": "date-time",
                "description": "Timestamp indicating when the UI was generated."
              },
              "context": {
                "type": "object",
                "description": "Arbitrary context metadata (thing references, device info, etc.).",
                "additionalProperties": true
              },
              "theme": {
                "type": "object",
                "properties": {
                  "primaryColor": {
                    "type": "string",
                    "pattern": "^#([0-9a-fA-F]{3}|[0-9a-fA-F]{6})$",
                    "description": "Hexadecimal color value representing the preferred primary accent color."
                  },
                  "surfaceTint": {
                    "type": "string",
                    "pattern": "^#([0-9a-fA-F]{3}|[0-9a-fA-F]{6})$",
                    "description": "Optional translucent wash to apply to containers."
                  }
                },
                "additionalProperties": false
              },
              "components": {
                "type": "array",
                "minItems": 1,
                "items": {
                  "$ref": "#/definitions/component"
                }
              }
            },
            "required": [
              "components"
            ],
            "definitions": {
              "layoutInstruction": {
                "type": "object",
                "description": "Optional placement hint for the 12-column responsive grid rendered by the tablet device. Accepts keys such as region, column/row coordinates, spans, and alignment hints.",
                "additionalProperties": true
              },
              "component": {
                "oneOf": [
                  {
                    "$ref": "#/definitions/containerComponent"
                  },
                  {
                    "$ref": "#/definitions/textComponent"
                  },
                  {
                    "$ref": "#/definitions/buttonComponent"
                  },
                  {
                    "$ref": "#/definitions/toggleComponent"
                  },
                  {
                    "$ref": "#/definitions/sliderComponent"
                  },
                  {
                    "$ref": "#/definitions/dropdownComponent"
                  },
                  {
                    "$ref": "#/definitions/statusCardComponent"
                  },
                  {
                    "$ref": "#/definitions/toolCall"
                  }
                ]
              },
              "containerComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "container"
                  },
                  "title": {
                    "type": "string"
                  },
                  "layout": {
                    "description": "Layout strategy for child composition (grid, row, column).",
                    "oneOf": [
                      {
                        "type": "string"
                      },
                      {
                        "$ref": "#/definitions/layoutInstruction"
                      }
                    ]
                  },
                  "placement": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Optional thing identifier that all nested children primarily control."
                  },
                  "children": {
                    "type": "array",
                    "minItems": 1,
                    "items": {
                      "$ref": "#/definitions/component"
                    }
                  }
                },
                "required": [
                  "type",
                  "children"
                ]
              },
              "textComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "text"
                  },
                  "text": {
                    "type": "string"
                  },
                  "variant": {
                    "type": "string"
                  },
                  "size": {
                    "type": "string"
                  },
                  "tone": {
                    "type": "string"
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Optional thing identifier this text references when showing state or instructions."
                  }
                },
                "required": [
                  "type",
                  "text"
                ]
              },
              "buttonComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "button"
                  },
                  "label": {
                    "type": "string"
                  },
                  "icon": {
                    "type": "string"
                  },
                  "style": {
                    "type": "string"
                  },
                  "size": {
                    "type": "string"
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Thing identifier to target when executing the bound action."
                  },
                  "action": {
                    "description": "Action payload or identifier to execute when the button is pressed.",
                    "oneOf": [
                      {
                        "type": "string"
                      },
                      {
                        "type": "object",
                        "additionalProperties": true
                      }
                    ]
                  }
                },
                "required": [
                  "type",
                  "label"
                ]
              },
              "toggleComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "toggle"
                  },
                  "label": {
                    "type": "string"
                  },
                  "checked": {
                    "type": "boolean"
                  },
                  "size": {
                    "type": "string"
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Thing identifier to target when toggling."
                  },
                  "action": {
                    "oneOf": [
                      {
                        "type": "string"
                      },
                      {
                        "type": "object",
                        "additionalProperties": true
                      }
                    ]
                  }
                },
                "required": [
                  "type",
                  "label"
                ]
              },
              "sliderComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "slider"
                  },
                  "label": {
                    "type": "string"
                  },
                  "min": {
                    "type": "number",
                    "default": 0
                  },
                  "max": {
                    "type": "number",
                    "default": 100
                  },
                  "step": {
                    "type": "number",
                    "default": 1
                  },
                  "value": {
                    "type": "number"
                  },
                  "unit": {
                    "type": "string"
                  },
                  "size": {
                    "type": "string"
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Thing identifier to target when sending slider updates."
                  },
                  "action": {
                    "oneOf": [
                      {
                        "type": "string"
                      },
                      {
                        "type": "object",
                        "additionalProperties": true
                      }
                    ]
                  }
                },
                "required": [
                  "type",
                  "label"
                ]
              },
              "dropdownComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "dropdown"
                  },
                  "label": {
                    "type": "string"
                  },
                  "placeholder": {
                    "type": "string"
                  },
                  "value": {
                    "type": "string"
                  },
                  "size": {
                    "type": "string"
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Thing identifier to target when selection changes."
                  },
                  "options": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "label": {
                          "type": "string"
                        },
                        "value": {
                          "type": "string"
                        }
                      },
                      "required": [
                        "label",
                        "value"
                      ],
                      "additionalProperties": false
                    }
                  },
                  "action": {
                    "oneOf": [
                      {
                        "type": "string"
                      },
                      {
                        "type": "object",
                        "additionalProperties": true
                      }
                    ]
                  }
                },
                "required": [
                  "type",
                  "label",
                  "options"
                ]
              },
              "statusCardComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "statusCard"
                  },
                  "title": {
                    "type": "string"
                  },
                  "value": {
                    "type": "string"
                  },
                  "icon": {
                    "type": "string"
                  },
                  "tone": {
                    "type": "string"
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Thing identifier whose state this card summarizes."
                  },
                  "items": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "label": {
                          "type": "string"
                        },
                        "value": {
                          "type": "string"
                        }
                      },
                      "required": [
                        "label",
                        "value"
                      ],
                      "additionalProperties": false
                    }
                  }
                },
                "required": [
                  "type",
                  "title"
                ]
              },
              "toolCall": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "toolCall"
                  },
                  "tool": {
                    "type": "string"
                  },
                  "parameters": {
                    "type": "object",
                    "additionalProperties": true
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Thing identifier providing context for the tool output."
                  }
                },
                "required": [
                  "type",
                  "tool"
                ]
              }
            }
          }
        },
        "capabilityData": {
          "sensorState": "hands-occupied",
          "requestedAction": "dim hallway sconces",
          "device": "tablet"
        },
        "uiContext": {
          "scenarioId": "hands-occupied-audio-guidance",
          "tags": [
            "modality",
            "hands-occupied",
            "audio-first"
          ],
          "inputs": {
            "sensorState": "hands-occupied",
            "requestedAction": "dim hallway sconces",
            "device": "tablet"
          }
        },
        "deviceId": "device-tablet-eval",
        "device": {
          "id": "device-tablet-eval",
          "deviceId": "device-tablet-eval",
          "label": "Evaluation Tablet",
          "type": "tablet",
          "ergonomicsProfile": "cozy-desktop"
        }
      }
    },
    {
      "scenarioId": "hands-free-tactile-controls",
      "name": "Hands-free lighting surface",
      "mode": "kb",
      "prompt": "You are a UI planning assistant for a tablet experience. Use the provided requirement documents to craft a response that explains what the tablet should render or say. Always cite the relevant document ids in parentheses when referencing a guideline.\n\nDocument modality-guideline-hands-occupied (source: safety-guidelines):\nWhen the user activity sensor reports the state \"hands-occupied\", prefer audio-first guidance. Provide spoken prompts and minimize the need for direct touch input. When the sensor reports \"hands-free\", present tactile controls such as buttons or toggles for the light switch.\n\nScenario prompt: Sensors switch to \"hands-free\" as the resident requests lighting controls for the living room. What UI sections should the tablet render?\n\nContext inputs:\n{\n  \"sensorState\": \"hands-free\",\n  \"requestedAction\": \"toggle living-room lighting\",\n  \"device\": \"tablet\"\n}\n\nRequired behaviors:\n- Surface tactile controls such as buttons or toggles for the light switch\n- Call out that the hands-free context enables direct manipulation\n- Keep controls grouped in a reachable band (e.g., hero/controls region)\n\nAvoid the following failure modes:\n- Falls back to audio guidance or hides buttons despite hands-free state\n- Does not mention any tactile control\n\nRespond with two sections: (1) \"Plan\" — short paragraphs describing the approach, (2) \"Checks\" — bullet list referencing document ids.",
      "answer": "{\n  \"deviceId\": \"device-tablet-eval\",\n  \"generatedAt\": \"2023-10-01T12:00:00Z\",\n  \"context\": {\n    \"sensorState\": \"hands-free\",\n    \"requestedAction\": \"toggle living-room lighting\",\n    \"device\": \"tablet\"\n  },\n  \"theme\": {\n    \"primaryColor\": \"#1E90FF\"\n  },\n  \"components\": [\n    {\n      \"type\": \"text\",\n      \"text\": \"Living Room Lighting Controls\",\n      \"variant\": \"headline\",\n      \"size\": \"large\"\n    },\n    {\n      \"type\": \"toggle\",\n      \"label\": \"Living Room Light\",\n      \"checked\": false,\n      \"size\": \"large\"\n    }\n  ]\n}",
      "durationMs": 8787.034208000001,
      "flaggedSignals": [],
      "rawResponse": {
        "deviceId": "device-tablet-eval",
        "generatedAt": "2023-10-01T12:00:00Z",
        "context": {
          "sensorState": "hands-free",
          "requestedAction": "toggle living-room lighting",
          "device": "tablet"
        },
        "theme": {
          "primaryColor": "#1E90FF"
        },
        "components": [
          {
            "type": "text",
            "text": "Living Room Lighting Controls",
            "variant": "headline",
            "size": "large"
          },
          {
            "type": "toggle",
            "label": "Living Room Light",
            "checked": false,
            "size": "large"
          }
        ]
      },
      "llmMeta": {
        "provider": "openrouter",
        "model": "x-ai/grok-code-fast-1",
        "durationMs": 8773,
        "usage": {
          "prompt_tokens": 2394,
          "completion_tokens": 730,
          "total_tokens": 3124,
          "cost": 0.00153924,
          "is_byok": false,
          "prompt_tokens_details": {
            "cached_tokens": 192,
            "audio_tokens": 0,
            "video_tokens": 0
          },
          "cost_details": {
            "upstream_inference_cost": null,
            "upstream_inference_prompt_cost": 0.00044424,
            "upstream_inference_completions_cost": 0.001095
          },
          "completion_tokens_details": {
            "reasoning_tokens": 570,
            "image_tokens": 0
          }
        }
      },
      "kbPayload": {
        "prompt": "Sensors switch to \"hands-free\" as the resident requests lighting controls for the living room. What UI sections should the tablet render?",
        "schema": {
          "name": "tablet-dashboard-ui",
          "description": "Schema for the large-format tablet/laptop renderer. Supports explicit layout hints so the KB can describe a multi-column dashboard.",
          "components": {
            "text": {
              "props": {
                "text": "string",
                "variant": "string",
                "size": "string",
                "layout": "layoutInstruction"
              }
            },
            "button": {
              "props": {
                "label": "string",
                "style": "string",
                "size": "string",
                "layout": "layoutInstruction",
                "action": "object"
              }
            },
            "toggle": {
              "props": {
                "label": "string",
                "checked": "boolean",
                "size": "string",
                "layout": "layoutInstruction",
                "action": "object"
              }
            },
            "slider": {
              "props": {
                "label": "string",
                "min": "number",
                "max": "number",
                "step": "number",
                "value": "number",
                "unit": "string",
                "size": "string",
                "layout": "layoutInstruction",
                "action": "object"
              }
            },
            "dropdown": {
              "props": {
                "label": "string",
                "placeholder": "string",
                "options": "array",
                "value": "string",
                "size": "string",
                "layout": "layoutInstruction",
                "action": "object"
              }
            },
            "statusCard": {
              "props": {
                "title": "string",
                "value": "string",
                "icon": "string",
                "tone": "string",
                "items": "array",
                "layout": "layoutInstruction"
              }
            },
            "container": {
              "props": {
                "children": "array",
                "layout": "string",
                "placement": "layoutInstruction"
              }
            }
          },
          "theming": {
            "description": "Supports `theme.primaryColor` and `theme.surfaceTint` for accent styling across cards and controls.",
            "supportsPrimaryColor": true,
            "defaultPrimaryColor": "#2563eb"
          },
          "context": {
            "modalityPreference": "visual-large-format",
            "defaultErgonomicsProfile": "cozy-desktop",
            "supportedErgonomicsProfiles": [
              {
                "id": "cozy-desktop",
                "label": "Cozy desktop",
                "description": "Comfortable spacing for seated interaction on tablets or laptops."
              },
              {
                "id": "information-dense",
                "label": "Information dense",
                "description": "Tighter spacing for dashboards that prioritize data density."
              }
            ]
          },
          "responseSchema": {
            "$schema": "http://json-schema.org/draft-07/schema#",
            "title": "Tablet/Laptop UI Schema",
            "type": "object",
            "additionalProperties": false,
            "properties": {
              "deviceId": {
                "type": "string",
                "description": "Identifier of the target tablet device that should render this UI definition."
              },
              "generatedAt": {
                "type": "string",
                "format": "date-time",
                "description": "Timestamp indicating when the UI was generated."
              },
              "context": {
                "type": "object",
                "description": "Arbitrary context metadata (thing references, device info, etc.).",
                "additionalProperties": true
              },
              "theme": {
                "type": "object",
                "properties": {
                  "primaryColor": {
                    "type": "string",
                    "pattern": "^#([0-9a-fA-F]{3}|[0-9a-fA-F]{6})$",
                    "description": "Hexadecimal color value representing the preferred primary accent color."
                  },
                  "surfaceTint": {
                    "type": "string",
                    "pattern": "^#([0-9a-fA-F]{3}|[0-9a-fA-F]{6})$",
                    "description": "Optional translucent wash to apply to containers."
                  }
                },
                "additionalProperties": false
              },
              "components": {
                "type": "array",
                "minItems": 1,
                "items": {
                  "$ref": "#/definitions/component"
                }
              }
            },
            "required": [
              "components"
            ],
            "definitions": {
              "layoutInstruction": {
                "type": "object",
                "description": "Optional placement hint for the 12-column responsive grid rendered by the tablet device. Accepts keys such as region, column/row coordinates, spans, and alignment hints.",
                "additionalProperties": true
              },
              "component": {
                "oneOf": [
                  {
                    "$ref": "#/definitions/containerComponent"
                  },
                  {
                    "$ref": "#/definitions/textComponent"
                  },
                  {
                    "$ref": "#/definitions/buttonComponent"
                  },
                  {
                    "$ref": "#/definitions/toggleComponent"
                  },
                  {
                    "$ref": "#/definitions/sliderComponent"
                  },
                  {
                    "$ref": "#/definitions/dropdownComponent"
                  },
                  {
                    "$ref": "#/definitions/statusCardComponent"
                  },
                  {
                    "$ref": "#/definitions/toolCall"
                  }
                ]
              },
              "containerComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "container"
                  },
                  "title": {
                    "type": "string"
                  },
                  "layout": {
                    "description": "Layout strategy for child composition (grid, row, column).",
                    "oneOf": [
                      {
                        "type": "string"
                      },
                      {
                        "$ref": "#/definitions/layoutInstruction"
                      }
                    ]
                  },
                  "placement": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Optional thing identifier that all nested children primarily control."
                  },
                  "children": {
                    "type": "array",
                    "minItems": 1,
                    "items": {
                      "$ref": "#/definitions/component"
                    }
                  }
                },
                "required": [
                  "type",
                  "children"
                ]
              },
              "textComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "text"
                  },
                  "text": {
                    "type": "string"
                  },
                  "variant": {
                    "type": "string"
                  },
                  "size": {
                    "type": "string"
                  },
                  "tone": {
                    "type": "string"
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Optional thing identifier this text references when showing state or instructions."
                  }
                },
                "required": [
                  "type",
                  "text"
                ]
              },
              "buttonComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "button"
                  },
                  "label": {
                    "type": "string"
                  },
                  "icon": {
                    "type": "string"
                  },
                  "style": {
                    "type": "string"
                  },
                  "size": {
                    "type": "string"
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Thing identifier to target when executing the bound action."
                  },
                  "action": {
                    "description": "Action payload or identifier to execute when the button is pressed.",
                    "oneOf": [
                      {
                        "type": "string"
                      },
                      {
                        "type": "object",
                        "additionalProperties": true
                      }
                    ]
                  }
                },
                "required": [
                  "type",
                  "label"
                ]
              },
              "toggleComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "toggle"
                  },
                  "label": {
                    "type": "string"
                  },
                  "checked": {
                    "type": "boolean"
                  },
                  "size": {
                    "type": "string"
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Thing identifier to target when toggling."
                  },
                  "action": {
                    "oneOf": [
                      {
                        "type": "string"
                      },
                      {
                        "type": "object",
                        "additionalProperties": true
                      }
                    ]
                  }
                },
                "required": [
                  "type",
                  "label"
                ]
              },
              "sliderComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "slider"
                  },
                  "label": {
                    "type": "string"
                  },
                  "min": {
                    "type": "number",
                    "default": 0
                  },
                  "max": {
                    "type": "number",
                    "default": 100
                  },
                  "step": {
                    "type": "number",
                    "default": 1
                  },
                  "value": {
                    "type": "number"
                  },
                  "unit": {
                    "type": "string"
                  },
                  "size": {
                    "type": "string"
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Thing identifier to target when sending slider updates."
                  },
                  "action": {
                    "oneOf": [
                      {
                        "type": "string"
                      },
                      {
                        "type": "object",
                        "additionalProperties": true
                      }
                    ]
                  }
                },
                "required": [
                  "type",
                  "label"
                ]
              },
              "dropdownComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "dropdown"
                  },
                  "label": {
                    "type": "string"
                  },
                  "placeholder": {
                    "type": "string"
                  },
                  "value": {
                    "type": "string"
                  },
                  "size": {
                    "type": "string"
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Thing identifier to target when selection changes."
                  },
                  "options": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "label": {
                          "type": "string"
                        },
                        "value": {
                          "type": "string"
                        }
                      },
                      "required": [
                        "label",
                        "value"
                      ],
                      "additionalProperties": false
                    }
                  },
                  "action": {
                    "oneOf": [
                      {
                        "type": "string"
                      },
                      {
                        "type": "object",
                        "additionalProperties": true
                      }
                    ]
                  }
                },
                "required": [
                  "type",
                  "label",
                  "options"
                ]
              },
              "statusCardComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "statusCard"
                  },
                  "title": {
                    "type": "string"
                  },
                  "value": {
                    "type": "string"
                  },
                  "icon": {
                    "type": "string"
                  },
                  "tone": {
                    "type": "string"
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Thing identifier whose state this card summarizes."
                  },
                  "items": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "label": {
                          "type": "string"
                        },
                        "value": {
                          "type": "string"
                        }
                      },
                      "required": [
                        "label",
                        "value"
                      ],
                      "additionalProperties": false
                    }
                  }
                },
                "required": [
                  "type",
                  "title"
                ]
              },
              "toolCall": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "toolCall"
                  },
                  "tool": {
                    "type": "string"
                  },
                  "parameters": {
                    "type": "object",
                    "additionalProperties": true
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Thing identifier providing context for the tool output."
                  }
                },
                "required": [
                  "type",
                  "tool"
                ]
              }
            }
          }
        },
        "capabilityData": {
          "sensorState": "hands-free",
          "requestedAction": "toggle living-room lighting",
          "device": "tablet"
        },
        "uiContext": {
          "scenarioId": "hands-free-tactile-controls",
          "tags": [
            "modality",
            "hands-free",
            "tactile"
          ],
          "inputs": {
            "sensorState": "hands-free",
            "requestedAction": "toggle living-room lighting",
            "device": "tablet"
          }
        },
        "deviceId": "device-tablet-eval",
        "device": {
          "id": "device-tablet-eval",
          "deviceId": "device-tablet-eval",
          "label": "Evaluation Tablet",
          "type": "tablet",
          "ergonomicsProfile": "cozy-desktop"
        }
      }
    },
    {
      "scenarioId": "theme-primary-preference",
      "name": "Apply preferred accent",
      "mode": "kb",
      "prompt": "You are a UI planning assistant for a tablet experience. Use the provided requirement documents to craft a response that explains what the tablet should render or say. Always cite the relevant document ids in parentheses when referencing a guideline.\n\nDocument user-preference-primary-color (source: user-profile):\nThe primary household preference for interface accents is the color \"#1E90FF\" (a blue). Whenever possible, set the UI theme primary color to this value so buttons, toggles, and other interactive highlights align with the user preference. Ensure sufficient contrast by using light text on dark backgrounds.\n\nScenario prompt: No theme metadata is provided in the UI definition. Derive the accent tokens the renderer should use based on household preferences.\n\nContext inputs:\n{\n  \"themeProvided\": false,\n  \"components\": [\n    \"buttons\",\n    \"toggles\",\n    \"status cards\"\n  ]\n}\n\nRequired behaviors:\n- Set theme.primaryColor to #808080 exactly\n- State that text or iconography on top of this accent must be light to maintain contrast\n- Mention that the choice comes from a stored user preference\n\nAvoid the following failure modes:\n- Suggests any color other than #808080\n- Does not mention contrast requirements\n\nRespond with two sections: (1) \"Plan\" — short paragraphs describing the approach, (2) \"Checks\" — bullet list referencing document ids.",
      "answer": "{\n  \"deviceId\": \"device-tablet-eval\",\n  \"generatedAt\": \"2023-10-01T12:00:00Z\",\n  \"context\": {\n    \"themeDerivedFrom\": \"household-preferences\"\n  },\n  \"theme\": {\n    \"primaryColor\": \"#1E90FF\"\n  },\n  \"components\": [\n    {\n      \"type\": \"statusCard\",\n      \"title\": \"Theme Applied\",\n      \"value\": \"Accent color derived from household preferences\",\n      \"icon\": \"palette\",\n      \"tone\": \"info\"\n    }\n  ]\n}",
      "durationMs": 13440.037791999996,
      "flaggedSignals": [],
      "rawResponse": {
        "deviceId": "device-tablet-eval",
        "generatedAt": "2023-10-01T12:00:00Z",
        "context": {
          "themeDerivedFrom": "household-preferences"
        },
        "theme": {
          "primaryColor": "#1E90FF"
        },
        "components": [
          {
            "type": "statusCard",
            "title": "Theme Applied",
            "value": "Accent color derived from household preferences",
            "icon": "palette",
            "tone": "info"
          }
        ]
      },
      "llmMeta": {
        "provider": "openrouter",
        "model": "x-ai/grok-code-fast-1",
        "durationMs": 13423,
        "usage": {
          "prompt_tokens": 2392,
          "completion_tokens": 652,
          "total_tokens": 3044,
          "cost": 0.00142184,
          "is_byok": false,
          "prompt_tokens_details": {
            "cached_tokens": 192,
            "audio_tokens": 0,
            "video_tokens": 0
          },
          "cost_details": {
            "upstream_inference_cost": null,
            "upstream_inference_prompt_cost": 0.00044384,
            "upstream_inference_completions_cost": 0.000978
          },
          "completion_tokens_details": {
            "reasoning_tokens": 529,
            "image_tokens": 0
          }
        }
      },
      "kbPayload": {
        "prompt": "No theme metadata is provided in the UI definition. Derive the accent tokens the renderer should use based on household preferences.",
        "schema": {
          "name": "tablet-dashboard-ui",
          "description": "Schema for the large-format tablet/laptop renderer. Supports explicit layout hints so the KB can describe a multi-column dashboard.",
          "components": {
            "text": {
              "props": {
                "text": "string",
                "variant": "string",
                "size": "string",
                "layout": "layoutInstruction"
              }
            },
            "button": {
              "props": {
                "label": "string",
                "style": "string",
                "size": "string",
                "layout": "layoutInstruction",
                "action": "object"
              }
            },
            "toggle": {
              "props": {
                "label": "string",
                "checked": "boolean",
                "size": "string",
                "layout": "layoutInstruction",
                "action": "object"
              }
            },
            "slider": {
              "props": {
                "label": "string",
                "min": "number",
                "max": "number",
                "step": "number",
                "value": "number",
                "unit": "string",
                "size": "string",
                "layout": "layoutInstruction",
                "action": "object"
              }
            },
            "dropdown": {
              "props": {
                "label": "string",
                "placeholder": "string",
                "options": "array",
                "value": "string",
                "size": "string",
                "layout": "layoutInstruction",
                "action": "object"
              }
            },
            "statusCard": {
              "props": {
                "title": "string",
                "value": "string",
                "icon": "string",
                "tone": "string",
                "items": "array",
                "layout": "layoutInstruction"
              }
            },
            "container": {
              "props": {
                "children": "array",
                "layout": "string",
                "placement": "layoutInstruction"
              }
            }
          },
          "theming": {
            "description": "Supports `theme.primaryColor` and `theme.surfaceTint` for accent styling across cards and controls.",
            "supportsPrimaryColor": true,
            "defaultPrimaryColor": "#2563eb"
          },
          "context": {
            "modalityPreference": "visual-large-format",
            "defaultErgonomicsProfile": "cozy-desktop",
            "supportedErgonomicsProfiles": [
              {
                "id": "cozy-desktop",
                "label": "Cozy desktop",
                "description": "Comfortable spacing for seated interaction on tablets or laptops."
              },
              {
                "id": "information-dense",
                "label": "Information dense",
                "description": "Tighter spacing for dashboards that prioritize data density."
              }
            ]
          },
          "responseSchema": {
            "$schema": "http://json-schema.org/draft-07/schema#",
            "title": "Tablet/Laptop UI Schema",
            "type": "object",
            "additionalProperties": false,
            "properties": {
              "deviceId": {
                "type": "string",
                "description": "Identifier of the target tablet device that should render this UI definition."
              },
              "generatedAt": {
                "type": "string",
                "format": "date-time",
                "description": "Timestamp indicating when the UI was generated."
              },
              "context": {
                "type": "object",
                "description": "Arbitrary context metadata (thing references, device info, etc.).",
                "additionalProperties": true
              },
              "theme": {
                "type": "object",
                "properties": {
                  "primaryColor": {
                    "type": "string",
                    "pattern": "^#([0-9a-fA-F]{3}|[0-9a-fA-F]{6})$",
                    "description": "Hexadecimal color value representing the preferred primary accent color."
                  },
                  "surfaceTint": {
                    "type": "string",
                    "pattern": "^#([0-9a-fA-F]{3}|[0-9a-fA-F]{6})$",
                    "description": "Optional translucent wash to apply to containers."
                  }
                },
                "additionalProperties": false
              },
              "components": {
                "type": "array",
                "minItems": 1,
                "items": {
                  "$ref": "#/definitions/component"
                }
              }
            },
            "required": [
              "components"
            ],
            "definitions": {
              "layoutInstruction": {
                "type": "object",
                "description": "Optional placement hint for the 12-column responsive grid rendered by the tablet device. Accepts keys such as region, column/row coordinates, spans, and alignment hints.",
                "additionalProperties": true
              },
              "component": {
                "oneOf": [
                  {
                    "$ref": "#/definitions/containerComponent"
                  },
                  {
                    "$ref": "#/definitions/textComponent"
                  },
                  {
                    "$ref": "#/definitions/buttonComponent"
                  },
                  {
                    "$ref": "#/definitions/toggleComponent"
                  },
                  {
                    "$ref": "#/definitions/sliderComponent"
                  },
                  {
                    "$ref": "#/definitions/dropdownComponent"
                  },
                  {
                    "$ref": "#/definitions/statusCardComponent"
                  },
                  {
                    "$ref": "#/definitions/toolCall"
                  }
                ]
              },
              "containerComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "container"
                  },
                  "title": {
                    "type": "string"
                  },
                  "layout": {
                    "description": "Layout strategy for child composition (grid, row, column).",
                    "oneOf": [
                      {
                        "type": "string"
                      },
                      {
                        "$ref": "#/definitions/layoutInstruction"
                      }
                    ]
                  },
                  "placement": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Optional thing identifier that all nested children primarily control."
                  },
                  "children": {
                    "type": "array",
                    "minItems": 1,
                    "items": {
                      "$ref": "#/definitions/component"
                    }
                  }
                },
                "required": [
                  "type",
                  "children"
                ]
              },
              "textComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "text"
                  },
                  "text": {
                    "type": "string"
                  },
                  "variant": {
                    "type": "string"
                  },
                  "size": {
                    "type": "string"
                  },
                  "tone": {
                    "type": "string"
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Optional thing identifier this text references when showing state or instructions."
                  }
                },
                "required": [
                  "type",
                  "text"
                ]
              },
              "buttonComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "button"
                  },
                  "label": {
                    "type": "string"
                  },
                  "icon": {
                    "type": "string"
                  },
                  "style": {
                    "type": "string"
                  },
                  "size": {
                    "type": "string"
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Thing identifier to target when executing the bound action."
                  },
                  "action": {
                    "description": "Action payload or identifier to execute when the button is pressed.",
                    "oneOf": [
                      {
                        "type": "string"
                      },
                      {
                        "type": "object",
                        "additionalProperties": true
                      }
                    ]
                  }
                },
                "required": [
                  "type",
                  "label"
                ]
              },
              "toggleComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "toggle"
                  },
                  "label": {
                    "type": "string"
                  },
                  "checked": {
                    "type": "boolean"
                  },
                  "size": {
                    "type": "string"
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Thing identifier to target when toggling."
                  },
                  "action": {
                    "oneOf": [
                      {
                        "type": "string"
                      },
                      {
                        "type": "object",
                        "additionalProperties": true
                      }
                    ]
                  }
                },
                "required": [
                  "type",
                  "label"
                ]
              },
              "sliderComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "slider"
                  },
                  "label": {
                    "type": "string"
                  },
                  "min": {
                    "type": "number",
                    "default": 0
                  },
                  "max": {
                    "type": "number",
                    "default": 100
                  },
                  "step": {
                    "type": "number",
                    "default": 1
                  },
                  "value": {
                    "type": "number"
                  },
                  "unit": {
                    "type": "string"
                  },
                  "size": {
                    "type": "string"
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Thing identifier to target when sending slider updates."
                  },
                  "action": {
                    "oneOf": [
                      {
                        "type": "string"
                      },
                      {
                        "type": "object",
                        "additionalProperties": true
                      }
                    ]
                  }
                },
                "required": [
                  "type",
                  "label"
                ]
              },
              "dropdownComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "dropdown"
                  },
                  "label": {
                    "type": "string"
                  },
                  "placeholder": {
                    "type": "string"
                  },
                  "value": {
                    "type": "string"
                  },
                  "size": {
                    "type": "string"
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Thing identifier to target when selection changes."
                  },
                  "options": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "label": {
                          "type": "string"
                        },
                        "value": {
                          "type": "string"
                        }
                      },
                      "required": [
                        "label",
                        "value"
                      ],
                      "additionalProperties": false
                    }
                  },
                  "action": {
                    "oneOf": [
                      {
                        "type": "string"
                      },
                      {
                        "type": "object",
                        "additionalProperties": true
                      }
                    ]
                  }
                },
                "required": [
                  "type",
                  "label",
                  "options"
                ]
              },
              "statusCardComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "statusCard"
                  },
                  "title": {
                    "type": "string"
                  },
                  "value": {
                    "type": "string"
                  },
                  "icon": {
                    "type": "string"
                  },
                  "tone": {
                    "type": "string"
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Thing identifier whose state this card summarizes."
                  },
                  "items": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "label": {
                          "type": "string"
                        },
                        "value": {
                          "type": "string"
                        }
                      },
                      "required": [
                        "label",
                        "value"
                      ],
                      "additionalProperties": false
                    }
                  }
                },
                "required": [
                  "type",
                  "title"
                ]
              },
              "toolCall": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "toolCall"
                  },
                  "tool": {
                    "type": "string"
                  },
                  "parameters": {
                    "type": "object",
                    "additionalProperties": true
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Thing identifier providing context for the tool output."
                  }
                },
                "required": [
                  "type",
                  "tool"
                ]
              }
            }
          }
        },
        "capabilityData": {
          "themeProvided": false,
          "components": [
            "buttons",
            "toggles",
            "status cards"
          ]
        },
        "uiContext": {
          "scenarioId": "theme-primary-preference",
          "tags": [
            "theme",
            "primary-color",
            "accessibility"
          ],
          "inputs": {
            "themeProvided": false,
            "components": [
              "buttons",
              "toggles",
              "status cards"
            ]
          }
        },
        "deviceId": "device-tablet-eval",
        "device": {
          "id": "device-tablet-eval",
          "deviceId": "device-tablet-eval",
          "label": "Evaluation Tablet",
          "type": "tablet",
          "ergonomicsProfile": "cozy-desktop"
        }
      }
    },
    {
      "scenarioId": "theme-conflict-remediation",
      "name": "Resolve conflicting theme",
      "mode": "kb",
      "prompt": "You are a UI planning assistant for a tablet experience. Use the provided requirement documents to craft a response that explains what the tablet should render or say. Always cite the relevant document ids in parentheses when referencing a guideline.\n\nDocument user-preference-primary-color (source: user-profile):\nThe primary household preference for interface accents is the color \"#1E90FF\" (a blue). Whenever possible, set the UI theme primary color to this value so buttons, toggles, and other interactive highlights align with the user preference. Ensure sufficient contrast by using light text on dark backgrounds.\n\nScenario prompt: The current UI preview shows royal-blue buttons even though the user profile specifies an accent preference. Explain what needs to change and why.\n\nContext inputs:\n{\n  \"currentAccent\": \"#2563eb\",\n  \"preferenceAccent\": \"#808080\",\n  \"issue\": \"mismatched accent\"\n}\n\nRequired behaviors:\n- Identify the mismatch between the live accent and the preference\n- Recommend overriding buttons/toggles/status cards to use #808080\n- Restate the contrast requirement (light text) when applying the new accent\n- Mention any user communication or logging step to capture the correction\n\nAvoid the following failure modes:\n- Accepts the blue accent with no remediation\n- Fails to mention the stored preference\n\nRespond with two sections: (1) \"Plan\" — short paragraphs describing the approach, (2) \"Checks\" — bullet list referencing document ids.",
      "answer": "{\n  \"deviceId\": \"device-tablet-eval\",\n  \"generatedAt\": \"2023-10-05T12:00:00Z\",\n  \"context\": {\n    \"currentAccent\": \"#2563eb\",\n    \"preferenceAccent\": \"#808080\",\n    \"issue\": \"mismatched accent\"\n  },\n  \"theme\": {\n    \"primaryColor\": \"#1E90FF\"\n  },\n  \"components\": [\n    {\n      \"type\": \"container\",\n      \"title\": \"Accent Color Issue Explanation\",\n      \"layout\": \"column\",\n      \"children\": [\n        {\n          \"type\": \"text\",\n          \"text\": \"The current UI preview displays buttons in royal-blue (#2563eb), but the user profile specifies a preference for gray (#808080) as the accent color. However, the household preference overrides this with dodger blue (#1E90FF) for better alignment and contrast.\",\n          \"variant\": \"body\",\n          \"size\": \"medium\",\n          \"tone\": \"neutral\"\n        },\n        {\n          \"type\": \"text\",\n          \"text\": \"What needs to change: Update the theme's primaryColor from the current #2563eb to #1E90FF to match the household preference. This ensures buttons, toggles, and interactive elements use the preferred blue accent with light text on dark backgrounds for sufficient contrast.\",\n          \"variant\": \"body\",\n          \"size\": \"medium\",\n          \"tone\": \"neutral\"\n        },\n        {\n          \"type\": \"text\",\n          \"text\": \"Why: The preferenceAccent (#808080) seems mismatched, but the documented household preference takes precedence. Applying #1E90FF personalizes the interface, improves usability, and maintains accessibility standards.\",\n          \"variant\": \"body\",\n          \"size\": \"medium\",\n          \"tone\": \"neutral\"\n        }\n      ]\n    }\n  ]\n}",
      "durationMs": 4985.652417000005,
      "flaggedSignals": [],
      "rawResponse": {
        "deviceId": "device-tablet-eval",
        "generatedAt": "2023-10-05T12:00:00Z",
        "context": {
          "currentAccent": "#2563eb",
          "preferenceAccent": "#808080",
          "issue": "mismatched accent"
        },
        "theme": {
          "primaryColor": "#1E90FF"
        },
        "components": [
          {
            "type": "container",
            "title": "Accent Color Issue Explanation",
            "layout": "column",
            "children": [
              {
                "type": "text",
                "text": "The current UI preview displays buttons in royal-blue (#2563eb), but the user profile specifies a preference for gray (#808080) as the accent color. However, the household preference overrides this with dodger blue (#1E90FF) for better alignment and contrast.",
                "variant": "body",
                "size": "medium",
                "tone": "neutral"
              },
              {
                "type": "text",
                "text": "What needs to change: Update the theme's primaryColor from the current #2563eb to #1E90FF to match the household preference. This ensures buttons, toggles, and interactive elements use the preferred blue accent with light text on dark backgrounds for sufficient contrast.",
                "variant": "body",
                "size": "medium",
                "tone": "neutral"
              },
              {
                "type": "text",
                "text": "Why: The preferenceAccent (#808080) seems mismatched, but the documented household preference takes precedence. Applying #1E90FF personalizes the interface, improves usability, and maintains accessibility standards.",
                "variant": "body",
                "size": "medium",
                "tone": "neutral"
              }
            ]
          }
        ]
      },
      "llmMeta": {
        "provider": "openrouter",
        "model": "x-ai/grok-code-fast-1",
        "durationMs": 4969,
        "usage": {
          "prompt_tokens": 2395,
          "completion_tokens": 732,
          "total_tokens": 3127,
          "cost": 0.00154244,
          "is_byok": false,
          "prompt_tokens_details": {
            "cached_tokens": 192,
            "audio_tokens": 0,
            "video_tokens": 0
          },
          "cost_details": {
            "upstream_inference_cost": null,
            "upstream_inference_prompt_cost": 0.00044444,
            "upstream_inference_completions_cost": 0.001098
          },
          "completion_tokens_details": {
            "reasoning_tokens": 344,
            "image_tokens": 0
          }
        }
      },
      "kbPayload": {
        "prompt": "The current UI preview shows royal-blue buttons even though the user profile specifies an accent preference. Explain what needs to change and why.",
        "schema": {
          "name": "tablet-dashboard-ui",
          "description": "Schema for the large-format tablet/laptop renderer. Supports explicit layout hints so the KB can describe a multi-column dashboard.",
          "components": {
            "text": {
              "props": {
                "text": "string",
                "variant": "string",
                "size": "string",
                "layout": "layoutInstruction"
              }
            },
            "button": {
              "props": {
                "label": "string",
                "style": "string",
                "size": "string",
                "layout": "layoutInstruction",
                "action": "object"
              }
            },
            "toggle": {
              "props": {
                "label": "string",
                "checked": "boolean",
                "size": "string",
                "layout": "layoutInstruction",
                "action": "object"
              }
            },
            "slider": {
              "props": {
                "label": "string",
                "min": "number",
                "max": "number",
                "step": "number",
                "value": "number",
                "unit": "string",
                "size": "string",
                "layout": "layoutInstruction",
                "action": "object"
              }
            },
            "dropdown": {
              "props": {
                "label": "string",
                "placeholder": "string",
                "options": "array",
                "value": "string",
                "size": "string",
                "layout": "layoutInstruction",
                "action": "object"
              }
            },
            "statusCard": {
              "props": {
                "title": "string",
                "value": "string",
                "icon": "string",
                "tone": "string",
                "items": "array",
                "layout": "layoutInstruction"
              }
            },
            "container": {
              "props": {
                "children": "array",
                "layout": "string",
                "placement": "layoutInstruction"
              }
            }
          },
          "theming": {
            "description": "Supports `theme.primaryColor` and `theme.surfaceTint` for accent styling across cards and controls.",
            "supportsPrimaryColor": true,
            "defaultPrimaryColor": "#2563eb"
          },
          "context": {
            "modalityPreference": "visual-large-format",
            "defaultErgonomicsProfile": "cozy-desktop",
            "supportedErgonomicsProfiles": [
              {
                "id": "cozy-desktop",
                "label": "Cozy desktop",
                "description": "Comfortable spacing for seated interaction on tablets or laptops."
              },
              {
                "id": "information-dense",
                "label": "Information dense",
                "description": "Tighter spacing for dashboards that prioritize data density."
              }
            ]
          },
          "responseSchema": {
            "$schema": "http://json-schema.org/draft-07/schema#",
            "title": "Tablet/Laptop UI Schema",
            "type": "object",
            "additionalProperties": false,
            "properties": {
              "deviceId": {
                "type": "string",
                "description": "Identifier of the target tablet device that should render this UI definition."
              },
              "generatedAt": {
                "type": "string",
                "format": "date-time",
                "description": "Timestamp indicating when the UI was generated."
              },
              "context": {
                "type": "object",
                "description": "Arbitrary context metadata (thing references, device info, etc.).",
                "additionalProperties": true
              },
              "theme": {
                "type": "object",
                "properties": {
                  "primaryColor": {
                    "type": "string",
                    "pattern": "^#([0-9a-fA-F]{3}|[0-9a-fA-F]{6})$",
                    "description": "Hexadecimal color value representing the preferred primary accent color."
                  },
                  "surfaceTint": {
                    "type": "string",
                    "pattern": "^#([0-9a-fA-F]{3}|[0-9a-fA-F]{6})$",
                    "description": "Optional translucent wash to apply to containers."
                  }
                },
                "additionalProperties": false
              },
              "components": {
                "type": "array",
                "minItems": 1,
                "items": {
                  "$ref": "#/definitions/component"
                }
              }
            },
            "required": [
              "components"
            ],
            "definitions": {
              "layoutInstruction": {
                "type": "object",
                "description": "Optional placement hint for the 12-column responsive grid rendered by the tablet device. Accepts keys such as region, column/row coordinates, spans, and alignment hints.",
                "additionalProperties": true
              },
              "component": {
                "oneOf": [
                  {
                    "$ref": "#/definitions/containerComponent"
                  },
                  {
                    "$ref": "#/definitions/textComponent"
                  },
                  {
                    "$ref": "#/definitions/buttonComponent"
                  },
                  {
                    "$ref": "#/definitions/toggleComponent"
                  },
                  {
                    "$ref": "#/definitions/sliderComponent"
                  },
                  {
                    "$ref": "#/definitions/dropdownComponent"
                  },
                  {
                    "$ref": "#/definitions/statusCardComponent"
                  },
                  {
                    "$ref": "#/definitions/toolCall"
                  }
                ]
              },
              "containerComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "container"
                  },
                  "title": {
                    "type": "string"
                  },
                  "layout": {
                    "description": "Layout strategy for child composition (grid, row, column).",
                    "oneOf": [
                      {
                        "type": "string"
                      },
                      {
                        "$ref": "#/definitions/layoutInstruction"
                      }
                    ]
                  },
                  "placement": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Optional thing identifier that all nested children primarily control."
                  },
                  "children": {
                    "type": "array",
                    "minItems": 1,
                    "items": {
                      "$ref": "#/definitions/component"
                    }
                  }
                },
                "required": [
                  "type",
                  "children"
                ]
              },
              "textComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "text"
                  },
                  "text": {
                    "type": "string"
                  },
                  "variant": {
                    "type": "string"
                  },
                  "size": {
                    "type": "string"
                  },
                  "tone": {
                    "type": "string"
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Optional thing identifier this text references when showing state or instructions."
                  }
                },
                "required": [
                  "type",
                  "text"
                ]
              },
              "buttonComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "button"
                  },
                  "label": {
                    "type": "string"
                  },
                  "icon": {
                    "type": "string"
                  },
                  "style": {
                    "type": "string"
                  },
                  "size": {
                    "type": "string"
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Thing identifier to target when executing the bound action."
                  },
                  "action": {
                    "description": "Action payload or identifier to execute when the button is pressed.",
                    "oneOf": [
                      {
                        "type": "string"
                      },
                      {
                        "type": "object",
                        "additionalProperties": true
                      }
                    ]
                  }
                },
                "required": [
                  "type",
                  "label"
                ]
              },
              "toggleComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "toggle"
                  },
                  "label": {
                    "type": "string"
                  },
                  "checked": {
                    "type": "boolean"
                  },
                  "size": {
                    "type": "string"
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Thing identifier to target when toggling."
                  },
                  "action": {
                    "oneOf": [
                      {
                        "type": "string"
                      },
                      {
                        "type": "object",
                        "additionalProperties": true
                      }
                    ]
                  }
                },
                "required": [
                  "type",
                  "label"
                ]
              },
              "sliderComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "slider"
                  },
                  "label": {
                    "type": "string"
                  },
                  "min": {
                    "type": "number",
                    "default": 0
                  },
                  "max": {
                    "type": "number",
                    "default": 100
                  },
                  "step": {
                    "type": "number",
                    "default": 1
                  },
                  "value": {
                    "type": "number"
                  },
                  "unit": {
                    "type": "string"
                  },
                  "size": {
                    "type": "string"
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Thing identifier to target when sending slider updates."
                  },
                  "action": {
                    "oneOf": [
                      {
                        "type": "string"
                      },
                      {
                        "type": "object",
                        "additionalProperties": true
                      }
                    ]
                  }
                },
                "required": [
                  "type",
                  "label"
                ]
              },
              "dropdownComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "dropdown"
                  },
                  "label": {
                    "type": "string"
                  },
                  "placeholder": {
                    "type": "string"
                  },
                  "value": {
                    "type": "string"
                  },
                  "size": {
                    "type": "string"
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Thing identifier to target when selection changes."
                  },
                  "options": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "label": {
                          "type": "string"
                        },
                        "value": {
                          "type": "string"
                        }
                      },
                      "required": [
                        "label",
                        "value"
                      ],
                      "additionalProperties": false
                    }
                  },
                  "action": {
                    "oneOf": [
                      {
                        "type": "string"
                      },
                      {
                        "type": "object",
                        "additionalProperties": true
                      }
                    ]
                  }
                },
                "required": [
                  "type",
                  "label",
                  "options"
                ]
              },
              "statusCardComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "statusCard"
                  },
                  "title": {
                    "type": "string"
                  },
                  "value": {
                    "type": "string"
                  },
                  "icon": {
                    "type": "string"
                  },
                  "tone": {
                    "type": "string"
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Thing identifier whose state this card summarizes."
                  },
                  "items": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "label": {
                          "type": "string"
                        },
                        "value": {
                          "type": "string"
                        }
                      },
                      "required": [
                        "label",
                        "value"
                      ],
                      "additionalProperties": false
                    }
                  }
                },
                "required": [
                  "type",
                  "title"
                ]
              },
              "toolCall": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "toolCall"
                  },
                  "tool": {
                    "type": "string"
                  },
                  "parameters": {
                    "type": "object",
                    "additionalProperties": true
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Thing identifier providing context for the tool output."
                  }
                },
                "required": [
                  "type",
                  "tool"
                ]
              }
            }
          }
        },
        "capabilityData": {
          "currentAccent": "#2563eb",
          "preferenceAccent": "#808080",
          "issue": "mismatched accent"
        },
        "uiContext": {
          "scenarioId": "theme-conflict-remediation",
          "tags": [
            "theme",
            "compliance",
            "audit"
          ],
          "inputs": {
            "currentAccent": "#2563eb",
            "preferenceAccent": "#808080",
            "issue": "mismatched accent"
          }
        },
        "deviceId": "device-tablet-eval",
        "device": {
          "id": "device-tablet-eval",
          "deviceId": "device-tablet-eval",
          "label": "Evaluation Tablet",
          "type": "tablet",
          "ergonomicsProfile": "cozy-desktop"
        }
      }
    },
    {
      "scenarioId": "state-transition-guidance",
      "name": "Hands state transition",
      "mode": "kb",
      "prompt": "You are a UI planning assistant for a tablet experience. Use the provided requirement documents to craft a response that explains what the tablet should render or say. Always cite the relevant document ids in parentheses when referencing a guideline.\n\nDocument modality-guideline-hands-occupied (source: safety-guidelines):\nWhen the user activity sensor reports the state \"hands-occupied\", prefer audio-first guidance. Provide spoken prompts and minimize the need for direct touch input. When the sensor reports \"hands-free\", present tactile controls such as buttons or toggles for the light switch.\n\nScenario prompt: The activity recognizer flips from \"hands-occupied\" to \"hands-free\" mid-task while the resident is adjusting lighting scenes. Describe how the UI should adapt.\n\nContext inputs:\n{\n  \"initialState\": \"hands-occupied\",\n  \"newState\": \"hands-free\",\n  \"task\": \"lighting scenes\"\n}\n\nRequired behaviors:\n- Start with audio-first instructions while the state is hands-occupied\n- Detect the transition and introduce tactile controls once hands-free is confirmed\n- Explain the transition to the user (e.g., toast or subtle banner)\n- Ensure theme accents still honor #808080\n\nAvoid the following failure modes:\n- Keeps only audio guidance even after hands-free\n- Changes theme colors during the transition\n\nRespond with two sections: (1) \"Plan\" — short paragraphs describing the approach, (2) \"Checks\" — bullet list referencing document ids.",
      "answer": "{\n  \"deviceId\": \"device-tablet-eval\",\n  \"generatedAt\": \"2023-10-01T12:00:00Z\",\n  \"context\": {\n    \"task\": \"lighting scenes\",\n    \"oldState\": \"hands-occupied\",\n    \"newState\": \"hands-free\",\n    \"adaptationDescription\": \"Upon detecting hands-free state, the UI adapts from audio-first guidance to tactile controls, presenting buttons and toggles for adjusting lighting scenes to allow direct interaction.\"\n  },\n  \"theme\": {\n    \"primaryColor\": \"#1E90FF\"\n  },\n  \"components\": [\n    {\n      \"type\": \"container\",\n      \"title\": \"Lighting Scene Controls\",\n      \"layout\": \"column\",\n      \"children\": [\n        {\n          \"type\": \"text\",\n          \"text\": \"Activity sensor now reports 'hands-free'. Switching to tactile controls for lighting adjustments.\",\n          \"variant\": \"body\",\n          \"size\": \"medium\"\n        },\n        {\n          \"type\": \"button\",\n          \"label\": \"Apply Bright Scene\",\n          \"style\": \"primary\",\n          \"size\": \"large\"\n        },\n        {\n          \"type\": \"button\",\n          \"label\": \"Apply Dim Scene\",\n          \"style\": \"secondary\",\n          \"size\": \"large\"\n        },\n        {\n          \"type\": \"button\",\n          \"label\": \"Apply Cozy Scene\",\n          \"style\": \"secondary\",\n          \"size\": \"large\"\n        },\n        {\n          \"type\": \"toggle\",\n          \"label\": \"Enable Night Mode\",\n          \"checked\": false,\n          \"size\": \"large\"\n        }\n      ]\n    }\n  ]\n}",
      "durationMs": 31640.609540999998,
      "flaggedSignals": [],
      "rawResponse": {
        "deviceId": "device-tablet-eval",
        "generatedAt": "2023-10-01T12:00:00Z",
        "context": {
          "task": "lighting scenes",
          "oldState": "hands-occupied",
          "newState": "hands-free",
          "adaptationDescription": "Upon detecting hands-free state, the UI adapts from audio-first guidance to tactile controls, presenting buttons and toggles for adjusting lighting scenes to allow direct interaction."
        },
        "theme": {
          "primaryColor": "#1E90FF"
        },
        "components": [
          {
            "type": "container",
            "title": "Lighting Scene Controls",
            "layout": "column",
            "children": [
              {
                "type": "text",
                "text": "Activity sensor now reports 'hands-free'. Switching to tactile controls for lighting adjustments.",
                "variant": "body",
                "size": "medium"
              },
              {
                "type": "button",
                "label": "Apply Bright Scene",
                "style": "primary",
                "size": "large"
              },
              {
                "type": "button",
                "label": "Apply Dim Scene",
                "style": "secondary",
                "size": "large"
              },
              {
                "type": "button",
                "label": "Apply Cozy Scene",
                "style": "secondary",
                "size": "large"
              },
              {
                "type": "toggle",
                "label": "Enable Night Mode",
                "checked": false,
                "size": "large"
              }
            ]
          }
        ]
      },
      "llmMeta": {
        "provider": "openrouter",
        "model": "x-ai/grok-code-fast-1",
        "durationMs": 31625,
        "usage": {
          "prompt_tokens": 2399,
          "completion_tokens": 1061,
          "total_tokens": 3460,
          "cost": 0.00203674,
          "is_byok": false,
          "prompt_tokens_details": {
            "cached_tokens": 192,
            "audio_tokens": 0,
            "video_tokens": 0
          },
          "cost_details": {
            "upstream_inference_cost": null,
            "upstream_inference_prompt_cost": 0.00044524,
            "upstream_inference_completions_cost": 0.0015915
          },
          "completion_tokens_details": {
            "reasoning_tokens": 717,
            "image_tokens": 0
          }
        }
      },
      "kbPayload": {
        "prompt": "The activity recognizer flips from \"hands-occupied\" to \"hands-free\" mid-task while the resident is adjusting lighting scenes. Describe how the UI should adapt.",
        "schema": {
          "name": "tablet-dashboard-ui",
          "description": "Schema for the large-format tablet/laptop renderer. Supports explicit layout hints so the KB can describe a multi-column dashboard.",
          "components": {
            "text": {
              "props": {
                "text": "string",
                "variant": "string",
                "size": "string",
                "layout": "layoutInstruction"
              }
            },
            "button": {
              "props": {
                "label": "string",
                "style": "string",
                "size": "string",
                "layout": "layoutInstruction",
                "action": "object"
              }
            },
            "toggle": {
              "props": {
                "label": "string",
                "checked": "boolean",
                "size": "string",
                "layout": "layoutInstruction",
                "action": "object"
              }
            },
            "slider": {
              "props": {
                "label": "string",
                "min": "number",
                "max": "number",
                "step": "number",
                "value": "number",
                "unit": "string",
                "size": "string",
                "layout": "layoutInstruction",
                "action": "object"
              }
            },
            "dropdown": {
              "props": {
                "label": "string",
                "placeholder": "string",
                "options": "array",
                "value": "string",
                "size": "string",
                "layout": "layoutInstruction",
                "action": "object"
              }
            },
            "statusCard": {
              "props": {
                "title": "string",
                "value": "string",
                "icon": "string",
                "tone": "string",
                "items": "array",
                "layout": "layoutInstruction"
              }
            },
            "container": {
              "props": {
                "children": "array",
                "layout": "string",
                "placement": "layoutInstruction"
              }
            }
          },
          "theming": {
            "description": "Supports `theme.primaryColor` and `theme.surfaceTint` for accent styling across cards and controls.",
            "supportsPrimaryColor": true,
            "defaultPrimaryColor": "#2563eb"
          },
          "context": {
            "modalityPreference": "visual-large-format",
            "defaultErgonomicsProfile": "cozy-desktop",
            "supportedErgonomicsProfiles": [
              {
                "id": "cozy-desktop",
                "label": "Cozy desktop",
                "description": "Comfortable spacing for seated interaction on tablets or laptops."
              },
              {
                "id": "information-dense",
                "label": "Information dense",
                "description": "Tighter spacing for dashboards that prioritize data density."
              }
            ]
          },
          "responseSchema": {
            "$schema": "http://json-schema.org/draft-07/schema#",
            "title": "Tablet/Laptop UI Schema",
            "type": "object",
            "additionalProperties": false,
            "properties": {
              "deviceId": {
                "type": "string",
                "description": "Identifier of the target tablet device that should render this UI definition."
              },
              "generatedAt": {
                "type": "string",
                "format": "date-time",
                "description": "Timestamp indicating when the UI was generated."
              },
              "context": {
                "type": "object",
                "description": "Arbitrary context metadata (thing references, device info, etc.).",
                "additionalProperties": true
              },
              "theme": {
                "type": "object",
                "properties": {
                  "primaryColor": {
                    "type": "string",
                    "pattern": "^#([0-9a-fA-F]{3}|[0-9a-fA-F]{6})$",
                    "description": "Hexadecimal color value representing the preferred primary accent color."
                  },
                  "surfaceTint": {
                    "type": "string",
                    "pattern": "^#([0-9a-fA-F]{3}|[0-9a-fA-F]{6})$",
                    "description": "Optional translucent wash to apply to containers."
                  }
                },
                "additionalProperties": false
              },
              "components": {
                "type": "array",
                "minItems": 1,
                "items": {
                  "$ref": "#/definitions/component"
                }
              }
            },
            "required": [
              "components"
            ],
            "definitions": {
              "layoutInstruction": {
                "type": "object",
                "description": "Optional placement hint for the 12-column responsive grid rendered by the tablet device. Accepts keys such as region, column/row coordinates, spans, and alignment hints.",
                "additionalProperties": true
              },
              "component": {
                "oneOf": [
                  {
                    "$ref": "#/definitions/containerComponent"
                  },
                  {
                    "$ref": "#/definitions/textComponent"
                  },
                  {
                    "$ref": "#/definitions/buttonComponent"
                  },
                  {
                    "$ref": "#/definitions/toggleComponent"
                  },
                  {
                    "$ref": "#/definitions/sliderComponent"
                  },
                  {
                    "$ref": "#/definitions/dropdownComponent"
                  },
                  {
                    "$ref": "#/definitions/statusCardComponent"
                  },
                  {
                    "$ref": "#/definitions/toolCall"
                  }
                ]
              },
              "containerComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "container"
                  },
                  "title": {
                    "type": "string"
                  },
                  "layout": {
                    "description": "Layout strategy for child composition (grid, row, column).",
                    "oneOf": [
                      {
                        "type": "string"
                      },
                      {
                        "$ref": "#/definitions/layoutInstruction"
                      }
                    ]
                  },
                  "placement": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Optional thing identifier that all nested children primarily control."
                  },
                  "children": {
                    "type": "array",
                    "minItems": 1,
                    "items": {
                      "$ref": "#/definitions/component"
                    }
                  }
                },
                "required": [
                  "type",
                  "children"
                ]
              },
              "textComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "text"
                  },
                  "text": {
                    "type": "string"
                  },
                  "variant": {
                    "type": "string"
                  },
                  "size": {
                    "type": "string"
                  },
                  "tone": {
                    "type": "string"
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Optional thing identifier this text references when showing state or instructions."
                  }
                },
                "required": [
                  "type",
                  "text"
                ]
              },
              "buttonComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "button"
                  },
                  "label": {
                    "type": "string"
                  },
                  "icon": {
                    "type": "string"
                  },
                  "style": {
                    "type": "string"
                  },
                  "size": {
                    "type": "string"
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Thing identifier to target when executing the bound action."
                  },
                  "action": {
                    "description": "Action payload or identifier to execute when the button is pressed.",
                    "oneOf": [
                      {
                        "type": "string"
                      },
                      {
                        "type": "object",
                        "additionalProperties": true
                      }
                    ]
                  }
                },
                "required": [
                  "type",
                  "label"
                ]
              },
              "toggleComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "toggle"
                  },
                  "label": {
                    "type": "string"
                  },
                  "checked": {
                    "type": "boolean"
                  },
                  "size": {
                    "type": "string"
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Thing identifier to target when toggling."
                  },
                  "action": {
                    "oneOf": [
                      {
                        "type": "string"
                      },
                      {
                        "type": "object",
                        "additionalProperties": true
                      }
                    ]
                  }
                },
                "required": [
                  "type",
                  "label"
                ]
              },
              "sliderComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "slider"
                  },
                  "label": {
                    "type": "string"
                  },
                  "min": {
                    "type": "number",
                    "default": 0
                  },
                  "max": {
                    "type": "number",
                    "default": 100
                  },
                  "step": {
                    "type": "number",
                    "default": 1
                  },
                  "value": {
                    "type": "number"
                  },
                  "unit": {
                    "type": "string"
                  },
                  "size": {
                    "type": "string"
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Thing identifier to target when sending slider updates."
                  },
                  "action": {
                    "oneOf": [
                      {
                        "type": "string"
                      },
                      {
                        "type": "object",
                        "additionalProperties": true
                      }
                    ]
                  }
                },
                "required": [
                  "type",
                  "label"
                ]
              },
              "dropdownComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "dropdown"
                  },
                  "label": {
                    "type": "string"
                  },
                  "placeholder": {
                    "type": "string"
                  },
                  "value": {
                    "type": "string"
                  },
                  "size": {
                    "type": "string"
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Thing identifier to target when selection changes."
                  },
                  "options": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "label": {
                          "type": "string"
                        },
                        "value": {
                          "type": "string"
                        }
                      },
                      "required": [
                        "label",
                        "value"
                      ],
                      "additionalProperties": false
                    }
                  },
                  "action": {
                    "oneOf": [
                      {
                        "type": "string"
                      },
                      {
                        "type": "object",
                        "additionalProperties": true
                      }
                    ]
                  }
                },
                "required": [
                  "type",
                  "label",
                  "options"
                ]
              },
              "statusCardComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "statusCard"
                  },
                  "title": {
                    "type": "string"
                  },
                  "value": {
                    "type": "string"
                  },
                  "icon": {
                    "type": "string"
                  },
                  "tone": {
                    "type": "string"
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Thing identifier whose state this card summarizes."
                  },
                  "items": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "label": {
                          "type": "string"
                        },
                        "value": {
                          "type": "string"
                        }
                      },
                      "required": [
                        "label",
                        "value"
                      ],
                      "additionalProperties": false
                    }
                  }
                },
                "required": [
                  "type",
                  "title"
                ]
              },
              "toolCall": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "toolCall"
                  },
                  "tool": {
                    "type": "string"
                  },
                  "parameters": {
                    "type": "object",
                    "additionalProperties": true
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Thing identifier providing context for the tool output."
                  }
                },
                "required": [
                  "type",
                  "tool"
                ]
              }
            }
          }
        },
        "capabilityData": {
          "initialState": "hands-occupied",
          "newState": "hands-free",
          "task": "lighting scenes"
        },
        "uiContext": {
          "scenarioId": "state-transition-guidance",
          "tags": [
            "modality",
            "state-change",
            "fallthrough"
          ],
          "inputs": {
            "initialState": "hands-occupied",
            "newState": "hands-free",
            "task": "lighting scenes"
          }
        },
        "deviceId": "device-tablet-eval",
        "device": {
          "id": "device-tablet-eval",
          "deviceId": "device-tablet-eval",
          "label": "Evaluation Tablet",
          "type": "tablet",
          "ergonomicsProfile": "cozy-desktop"
        }
      }
    },
    {
      "scenarioId": "audit-checklist",
      "name": "KB compliance audit",
      "mode": "kb",
      "prompt": "You are a UI planning assistant for a tablet experience. Use the provided requirement documents to craft a response that explains what the tablet should render or say. Always cite the relevant document ids in parentheses when referencing a guideline.\n\nDocument modality-guideline-hands-occupied (source: safety-guidelines):\nWhen the user activity sensor reports the state \"hands-occupied\", prefer audio-first guidance. Provide spoken prompts and minimize the need for direct touch input. When the sensor reports \"hands-free\", present tactile controls such as buttons or toggles for the light switch.\n\nDocument user-preference-primary-color (source: user-profile):\nThe primary household preference for interface accents is the color \"#1E90FF\" (a blue). Whenever possible, set the UI theme primary color to this value so buttons, toggles, and other interactive highlights align with the user preference. Ensure sufficient contrast by using light text on dark backgrounds.\n\nScenario prompt: Produce a checklist the QA team can use to verify that a generated tablet layout respects both the modality guideline and the accent preference.\n\nContext inputs:\n{\n  \"artifact\": \"tablet layout spec\",\n  \"checks\": [\n    \"modality\",\n    \"theme\"\n  ]\n}\n\nRequired behaviors:\n- List at least three modality checks (hands-occupied audio, hands-free tactile, transitions)\n- List at least two theme checks (accent equals #808080, light text over accent)\n- Tie every checklist item to the relevant document id\n\nAvoid the following failure modes:\n- Checklist omits either modality or theme\n- No references back to KB documents\n\nRespond with two sections: (1) \"Plan\" — short paragraphs describing the approach, (2) \"Checks\" — bullet list referencing document ids.",
      "answer": "{\n  \"deviceId\": \"device-tablet-eval\",\n  \"generatedAt\": \"2023-10-01T12:00:00Z\",\n  \"context\": {\n    \"device\": {\n      \"id\": \"device-tablet-eval\",\n      \"deviceId\": \"device-tablet-eval\",\n      \"label\": \"Evaluation Tablet\",\n      \"type\": \"tablet\",\n      \"ergonomicsProfile\": \"cozy-desktop\"\n    },\n    \"capabilityData\": {\n      \"artifact\": \"tablet layout spec\",\n      \"checks\": [\n        \"modality\",\n        \"theme\"\n      ]\n    },\n    \"thingActions\": [],\n    \"availableThings\": []\n  },\n  \"theme\": {\n    \"primaryColor\": \"#1E90FF\"\n  },\n  \"components\": [\n    {\n      \"type\": \"container\",\n      \"title\": \"QA Checklist for Tablet Layout Verification\",\n      \"layout\": \"column\",\n      \"children\": [\n        {\n          \"type\": \"text\",\n          \"text\": \"Checklist to verify that the generated tablet layout respects the modality guideline and the accent preference:\",\n          \"variant\": \"body1\",\n          \"size\": \"medium\"\n        },\n        {\n          \"type\": \"text\",\n          \"text\": \"Modality Guideline Checks:\",\n          \"variant\": \"h6\",\n          \"size\": \"large\"\n        },\n        {\n          \"type\": \"text\",\n          \"text\": \"1. When user activity sensor reports 'hands-occupied', does the layout prefer audio-first guidance with spoken prompts and minimize touch input?\",\n          \"variant\": \"body2\",\n          \"size\": \"medium\"\n        },\n        {\n          \"type\": \"text\",\n          \"text\": \"2. When user activity sensor reports 'hands-free', does the layout present tactile controls such as buttons or toggles for applicable functions?\",\n          \"variant\": \"body2\",\n          \"size\": \"medium\"\n        },\n        {\n          \"type\": \"text\",\n          \"text\": \"Accent Preference Checks:\",\n          \"variant\": \"h6\",\n          \"size\": \"large\"\n        },\n        {\n          \"type\": \"text\",\n          \"text\": \"3. Is the UI theme's primaryColor set to '#1E90FF' (blue) for buttons, toggles, and other interactive highlights?\",\n          \"variant\": \"body2\",\n          \"size\": \"medium\"\n        },\n        {\n          \"type\": \"text\",\n          \"text\": \"4. Does the layout ensure sufficient contrast, such as using light text on dark backgrounds for readability?\",\n          \"variant\": \"body2\",\n          \"size\": \"medium\"\n        }\n      ]\n    }\n  ]\n}",
      "durationMs": 11854.101792000001,
      "flaggedSignals": [],
      "rawResponse": {
        "deviceId": "device-tablet-eval",
        "generatedAt": "2023-10-01T12:00:00Z",
        "context": {
          "device": {
            "id": "device-tablet-eval",
            "deviceId": "device-tablet-eval",
            "label": "Evaluation Tablet",
            "type": "tablet",
            "ergonomicsProfile": "cozy-desktop"
          },
          "capabilityData": {
            "artifact": "tablet layout spec",
            "checks": [
              "modality",
              "theme"
            ]
          },
          "thingActions": [],
          "availableThings": []
        },
        "theme": {
          "primaryColor": "#1E90FF"
        },
        "components": [
          {
            "type": "container",
            "title": "QA Checklist for Tablet Layout Verification",
            "layout": "column",
            "children": [
              {
                "type": "text",
                "text": "Checklist to verify that the generated tablet layout respects the modality guideline and the accent preference:",
                "variant": "body1",
                "size": "medium"
              },
              {
                "type": "text",
                "text": "Modality Guideline Checks:",
                "variant": "h6",
                "size": "large"
              },
              {
                "type": "text",
                "text": "1. When user activity sensor reports 'hands-occupied', does the layout prefer audio-first guidance with spoken prompts and minimize touch input?",
                "variant": "body2",
                "size": "medium"
              },
              {
                "type": "text",
                "text": "2. When user activity sensor reports 'hands-free', does the layout present tactile controls such as buttons or toggles for applicable functions?",
                "variant": "body2",
                "size": "medium"
              },
              {
                "type": "text",
                "text": "Accent Preference Checks:",
                "variant": "h6",
                "size": "large"
              },
              {
                "type": "text",
                "text": "3. Is the UI theme's primaryColor set to '#1E90FF' (blue) for buttons, toggles, and other interactive highlights?",
                "variant": "body2",
                "size": "medium"
              },
              {
                "type": "text",
                "text": "4. Does the layout ensure sufficient contrast, such as using light text on dark backgrounds for readability?",
                "variant": "body2",
                "size": "medium"
              }
            ]
          }
        ]
      },
      "llmMeta": {
        "provider": "openrouter",
        "model": "x-ai/grok-code-fast-1",
        "durationMs": 11830,
        "usage": {
          "prompt_tokens": 2391,
          "completion_tokens": 831,
          "total_tokens": 3222,
          "cost": 0.00169014,
          "is_byok": false,
          "prompt_tokens_details": {
            "cached_tokens": 192,
            "audio_tokens": 0,
            "video_tokens": 0
          },
          "cost_details": {
            "upstream_inference_cost": null,
            "upstream_inference_prompt_cost": 0.00044364,
            "upstream_inference_completions_cost": 0.0012465
          },
          "completion_tokens_details": {
            "reasoning_tokens": 283,
            "image_tokens": 0
          }
        }
      },
      "kbPayload": {
        "prompt": "Produce a checklist the QA team can use to verify that a generated tablet layout respects both the modality guideline and the accent preference.",
        "schema": {
          "name": "tablet-dashboard-ui",
          "description": "Schema for the large-format tablet/laptop renderer. Supports explicit layout hints so the KB can describe a multi-column dashboard.",
          "components": {
            "text": {
              "props": {
                "text": "string",
                "variant": "string",
                "size": "string",
                "layout": "layoutInstruction"
              }
            },
            "button": {
              "props": {
                "label": "string",
                "style": "string",
                "size": "string",
                "layout": "layoutInstruction",
                "action": "object"
              }
            },
            "toggle": {
              "props": {
                "label": "string",
                "checked": "boolean",
                "size": "string",
                "layout": "layoutInstruction",
                "action": "object"
              }
            },
            "slider": {
              "props": {
                "label": "string",
                "min": "number",
                "max": "number",
                "step": "number",
                "value": "number",
                "unit": "string",
                "size": "string",
                "layout": "layoutInstruction",
                "action": "object"
              }
            },
            "dropdown": {
              "props": {
                "label": "string",
                "placeholder": "string",
                "options": "array",
                "value": "string",
                "size": "string",
                "layout": "layoutInstruction",
                "action": "object"
              }
            },
            "statusCard": {
              "props": {
                "title": "string",
                "value": "string",
                "icon": "string",
                "tone": "string",
                "items": "array",
                "layout": "layoutInstruction"
              }
            },
            "container": {
              "props": {
                "children": "array",
                "layout": "string",
                "placement": "layoutInstruction"
              }
            }
          },
          "theming": {
            "description": "Supports `theme.primaryColor` and `theme.surfaceTint` for accent styling across cards and controls.",
            "supportsPrimaryColor": true,
            "defaultPrimaryColor": "#2563eb"
          },
          "context": {
            "modalityPreference": "visual-large-format",
            "defaultErgonomicsProfile": "cozy-desktop",
            "supportedErgonomicsProfiles": [
              {
                "id": "cozy-desktop",
                "label": "Cozy desktop",
                "description": "Comfortable spacing for seated interaction on tablets or laptops."
              },
              {
                "id": "information-dense",
                "label": "Information dense",
                "description": "Tighter spacing for dashboards that prioritize data density."
              }
            ]
          },
          "responseSchema": {
            "$schema": "http://json-schema.org/draft-07/schema#",
            "title": "Tablet/Laptop UI Schema",
            "type": "object",
            "additionalProperties": false,
            "properties": {
              "deviceId": {
                "type": "string",
                "description": "Identifier of the target tablet device that should render this UI definition."
              },
              "generatedAt": {
                "type": "string",
                "format": "date-time",
                "description": "Timestamp indicating when the UI was generated."
              },
              "context": {
                "type": "object",
                "description": "Arbitrary context metadata (thing references, device info, etc.).",
                "additionalProperties": true
              },
              "theme": {
                "type": "object",
                "properties": {
                  "primaryColor": {
                    "type": "string",
                    "pattern": "^#([0-9a-fA-F]{3}|[0-9a-fA-F]{6})$",
                    "description": "Hexadecimal color value representing the preferred primary accent color."
                  },
                  "surfaceTint": {
                    "type": "string",
                    "pattern": "^#([0-9a-fA-F]{3}|[0-9a-fA-F]{6})$",
                    "description": "Optional translucent wash to apply to containers."
                  }
                },
                "additionalProperties": false
              },
              "components": {
                "type": "array",
                "minItems": 1,
                "items": {
                  "$ref": "#/definitions/component"
                }
              }
            },
            "required": [
              "components"
            ],
            "definitions": {
              "layoutInstruction": {
                "type": "object",
                "description": "Optional placement hint for the 12-column responsive grid rendered by the tablet device. Accepts keys such as region, column/row coordinates, spans, and alignment hints.",
                "additionalProperties": true
              },
              "component": {
                "oneOf": [
                  {
                    "$ref": "#/definitions/containerComponent"
                  },
                  {
                    "$ref": "#/definitions/textComponent"
                  },
                  {
                    "$ref": "#/definitions/buttonComponent"
                  },
                  {
                    "$ref": "#/definitions/toggleComponent"
                  },
                  {
                    "$ref": "#/definitions/sliderComponent"
                  },
                  {
                    "$ref": "#/definitions/dropdownComponent"
                  },
                  {
                    "$ref": "#/definitions/statusCardComponent"
                  },
                  {
                    "$ref": "#/definitions/toolCall"
                  }
                ]
              },
              "containerComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "container"
                  },
                  "title": {
                    "type": "string"
                  },
                  "layout": {
                    "description": "Layout strategy for child composition (grid, row, column).",
                    "oneOf": [
                      {
                        "type": "string"
                      },
                      {
                        "$ref": "#/definitions/layoutInstruction"
                      }
                    ]
                  },
                  "placement": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Optional thing identifier that all nested children primarily control."
                  },
                  "children": {
                    "type": "array",
                    "minItems": 1,
                    "items": {
                      "$ref": "#/definitions/component"
                    }
                  }
                },
                "required": [
                  "type",
                  "children"
                ]
              },
              "textComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "text"
                  },
                  "text": {
                    "type": "string"
                  },
                  "variant": {
                    "type": "string"
                  },
                  "size": {
                    "type": "string"
                  },
                  "tone": {
                    "type": "string"
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Optional thing identifier this text references when showing state or instructions."
                  }
                },
                "required": [
                  "type",
                  "text"
                ]
              },
              "buttonComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "button"
                  },
                  "label": {
                    "type": "string"
                  },
                  "icon": {
                    "type": "string"
                  },
                  "style": {
                    "type": "string"
                  },
                  "size": {
                    "type": "string"
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Thing identifier to target when executing the bound action."
                  },
                  "action": {
                    "description": "Action payload or identifier to execute when the button is pressed.",
                    "oneOf": [
                      {
                        "type": "string"
                      },
                      {
                        "type": "object",
                        "additionalProperties": true
                      }
                    ]
                  }
                },
                "required": [
                  "type",
                  "label"
                ]
              },
              "toggleComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "toggle"
                  },
                  "label": {
                    "type": "string"
                  },
                  "checked": {
                    "type": "boolean"
                  },
                  "size": {
                    "type": "string"
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Thing identifier to target when toggling."
                  },
                  "action": {
                    "oneOf": [
                      {
                        "type": "string"
                      },
                      {
                        "type": "object",
                        "additionalProperties": true
                      }
                    ]
                  }
                },
                "required": [
                  "type",
                  "label"
                ]
              },
              "sliderComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "slider"
                  },
                  "label": {
                    "type": "string"
                  },
                  "min": {
                    "type": "number",
                    "default": 0
                  },
                  "max": {
                    "type": "number",
                    "default": 100
                  },
                  "step": {
                    "type": "number",
                    "default": 1
                  },
                  "value": {
                    "type": "number"
                  },
                  "unit": {
                    "type": "string"
                  },
                  "size": {
                    "type": "string"
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Thing identifier to target when sending slider updates."
                  },
                  "action": {
                    "oneOf": [
                      {
                        "type": "string"
                      },
                      {
                        "type": "object",
                        "additionalProperties": true
                      }
                    ]
                  }
                },
                "required": [
                  "type",
                  "label"
                ]
              },
              "dropdownComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "dropdown"
                  },
                  "label": {
                    "type": "string"
                  },
                  "placeholder": {
                    "type": "string"
                  },
                  "value": {
                    "type": "string"
                  },
                  "size": {
                    "type": "string"
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Thing identifier to target when selection changes."
                  },
                  "options": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "label": {
                          "type": "string"
                        },
                        "value": {
                          "type": "string"
                        }
                      },
                      "required": [
                        "label",
                        "value"
                      ],
                      "additionalProperties": false
                    }
                  },
                  "action": {
                    "oneOf": [
                      {
                        "type": "string"
                      },
                      {
                        "type": "object",
                        "additionalProperties": true
                      }
                    ]
                  }
                },
                "required": [
                  "type",
                  "label",
                  "options"
                ]
              },
              "statusCardComponent": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "statusCard"
                  },
                  "title": {
                    "type": "string"
                  },
                  "value": {
                    "type": "string"
                  },
                  "icon": {
                    "type": "string"
                  },
                  "tone": {
                    "type": "string"
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Thing identifier whose state this card summarizes."
                  },
                  "items": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "label": {
                          "type": "string"
                        },
                        "value": {
                          "type": "string"
                        }
                      },
                      "required": [
                        "label",
                        "value"
                      ],
                      "additionalProperties": false
                    }
                  }
                },
                "required": [
                  "type",
                  "title"
                ]
              },
              "toolCall": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "type": {
                    "const": "toolCall"
                  },
                  "tool": {
                    "type": "string"
                  },
                  "parameters": {
                    "type": "object",
                    "additionalProperties": true
                  },
                  "layout": {
                    "$ref": "#/definitions/layoutInstruction"
                  },
                  "thingId": {
                    "type": "string",
                    "description": "Thing identifier providing context for the tool output."
                  }
                },
                "required": [
                  "type",
                  "tool"
                ]
              }
            }
          }
        },
        "capabilityData": {
          "artifact": "tablet layout spec",
          "checks": [
            "modality",
            "theme"
          ]
        },
        "uiContext": {
          "scenarioId": "audit-checklist",
          "tags": [
            "audit",
            "theme",
            "modality"
          ],
          "inputs": {
            "artifact": "tablet layout spec",
            "checks": [
              "modality",
              "theme"
            ]
          }
        },
        "deviceId": "device-tablet-eval",
        "device": {
          "id": "device-tablet-eval",
          "deviceId": "device-tablet-eval",
          "label": "Evaluation Tablet",
          "type": "tablet",
          "ergonomicsProfile": "cozy-desktop"
        }
      }
    }
  ],
  "summary": {
    "mode": "kb",
    "total": 6,
    "successes": 6,
    "warnings": 0,
    "errors": 0,
    "avgDurationMs": 13821.3,
    "llmStats": {
      "calls": 6,
      "totalPromptTokens": 14371,
      "totalCompletionTokens": 4923,
      "totalTokens": 19294,
      "totalReasoningTokens": 3167,
      "avgTokensPerCall": 3215.7,
      "totalLlmDurationMs": 82802,
      "avgLlmDurationMs": 13800.3,
      "providers": {
        "openrouter": 6
      },
      "models": {
        "x-ai/grok-code-fast-1": 6
      }
    }
  }
}